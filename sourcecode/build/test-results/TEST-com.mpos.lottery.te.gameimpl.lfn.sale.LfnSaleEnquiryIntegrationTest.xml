<?xml version="1.0" encoding="UTF-8"?>
<testsuite name="com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleEnquiryIntegrationTest" tests="2" skipped="0" failures="0" errors="0" timestamp="2015-05-29T09:13:18" hostname="Ramon-PC" time="1.017">
  <properties/>
  <testcase name="testEnquirySaleTransaction_OK" classname="com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleEnquiryIntegrationTest" time="0.538"/>
  <testcase name="testEnquiryTicket_OK" classname="com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleEnquiryIntegrationTest" time="0.479"/>
  <system-out><![CDATA[[2015-05-29 17:13:18,155][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:18,155][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:18,155][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@595545b6) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:18,156][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:18,156][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:18,156][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnSaleEnquiryIntegrationTest.testEnquirySaleTransaction_OK                                                            |
[2015-05-29 17:13:18,156][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:18,156][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:18,157][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:18,158][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890798156|Timestamp:20150529171318|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=1355507448), get digest:0c3fca911d9f3db0398d934af5a11319
[2015-05-29 17:13:18,158][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:18,158][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:18,158][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171318).
[2015-05-29 17:13:18,158][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:18,158][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890798156).
[2015-05-29 17:13:18,158][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:18,158][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:18,158][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=0c3fca911d9f3db0398d934af5a11319).
[2015-05-29 17:13:18,158][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:18,158][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:18,158][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:18,160][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9L2k05jXFbPjS1FsBBTLuWj4a8kJVsM72/YMzruGEM7DWPI5uQU+kvE7y74H12t4zbaRoUQTDb7n/h8zAxrh6Hn2mtyfU/CYtxKe3z/Py5RlIQZDC6AG8TrAvhb3G3SNDjlu4Vxm32uHjs7iClqnt2hDh9rhQSOHhB9K5LUL3NVo8dKwh6SCwM56BaXiK557zz5HaYz2004U1raT6OlReAP7pgHuknsbfxdYkwSI2v0wkzsQ/uHRPv01BVY1tFvgu1/1csAMYBq+O2tRLIhXeAoIJOVLJJPvPHAkozf5FsxcYBza1aivogG1+z8aPrO9uA0h0ScFgQ8LmCP5AX0mf6ruPkYWDcmUtW5ansd9eHP+N72iCfLshuhdBbTWGleRy.
[2015-05-29 17:13:18,160][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890798156|Timestamp:20150529171318|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:18,160][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>
[2015-05-29 17:13:18,160][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890798156|Timestamp:20150529171318|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=1355507448), get digest:0c3fca911d9f3db0398d934af5a11319
[2015-05-29 17:13:18,160][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:18,160][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:18,160][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:18,177][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_1.5.0).
[2015-05-29 17:13:18,177][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_).
[2015-05-29 17:13:18,177][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_200_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:18,185][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance) by(number=11002,gameId=LFN-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:18,191][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:18,191][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01111745519300006396
[2015-05-29 17:13:18,197][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:18,199][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMlRtFP9EoUAV) as 80000
[2015-05-29 17:13:18,203][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMlRtFP9EoUAV, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:18,203][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:18,203][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:18,210][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMlRtFP9EoUAV) as 80000
[2015-05-29 17:13:18,212][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMlRtFP9EoUAV, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:18,212][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:18,212][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:18,220][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:18,220][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:18,226][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:18,226][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:18,233][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:18,233][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:18,240][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:18,240][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:18,247][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:18,247][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:18,254][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:18,254][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:18,260][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:18,260][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:18,267][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:18,267][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:18,275][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:18,275][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:18,282][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:18,282][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:18,291][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:18,291][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:18,297][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:18,298][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:18,304][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:18,304][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:18,311][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:18,311][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:18,317][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:18,317][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:18,324][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:18,324][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:18,330][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:18,330][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:18,336][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:18,336][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:18,343][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:18,343][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:18,349][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMlRtFP9EoUAV) as 80000
[2015-05-29 17:13:18,351][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMlRtFP9EoUAV, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:18,351][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:18,351][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:18,359][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMlRtFP9EoUAV) as 80000
[2015-05-29 17:13:18,361][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMlRtFP9EoUAV, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:18,361][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:18,361][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:18,372][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:18,372][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:18,380][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:18,380][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:18,387][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:18,387][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:18,394][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:18,394][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:18,401][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:18,401][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:18,409][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:18,409][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:18,416][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:18,416][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:18,423][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:18,423][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:18,430][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:18,430][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:18,436][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:18,437][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:18,443][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:18,443][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:18,450][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:18,450][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:18,457][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:18,457][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:18,463][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:18,464][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:18,470][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:18,470][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:18,476][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:18,476][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:18,483][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:18,483][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:18,489][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:18,489][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:18,496][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:18,496][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:18,513][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:18,513][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:18,514][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199997400.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:18,527][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.15]: transaction {
  id: "0115052900000000000847"
  dev_id: "111"
  operator_id: "OPERATOR-111"
  merchant_id: "111"
  create_time: 1432890798000
  trans_type: 200
  game_id: "LFN-1"
  game_type: 15
  total_amount: "2600.0"
}
multi_draw: 2
total_amount: "2600.0"
serial_no: "y013eOifYgLRjcmw7N8vMlRtFP9EoUAV"
game_instance {
  id: "GII-112"
}
entries {
  selected_number: "2,7,13,24,25,36"
  bet_option: 53
  total_bets: 20
  entry_amount: "1200.0"
  input_channel: "2"
}
entries {
  selected_number: "5"
  bet_option: 1
  total_bets: 1
  entry_amount: "100.0"
  input_channel: "2"
}

[2015-05-29 17:13:18,528][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:18,528][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:18,528][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket),mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml
[2015-05-29 17:13:18,528][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:18,529][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml).
[2015-05-29 17:13:18,529][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890798156|Timestamp:20150529171318|Transaction-Type:4200|Transaction-Id:0115052900000000000847|Response-Code:200|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300006396" type="1" lastDrawNo="11003" barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqqvZVwatc2iA=" validationCode="694635" multipleDraws="2" totalBets="42" totalAmount="2600.0"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0"/></Ticket>):f67e6ab61ed1fe121b216a414f895818
[2015-05-29 17:13:18,529][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=672) succesfully.
[2015-05-29 17:13:18,530][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=672): <?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300006396" type="1" lastDrawNo="11003" barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqqvZVwatc2iA=" validationCode="694635" multipleDraws="2" totalBets="42" totalAmount="2600.0"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0"/></Ticket>
[2015-05-29 17:13:18,530][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:18,534][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.310).
[2015-05-29 17:13:18,535][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.trans.domain.Transaction, mappingFile=xml-mapping/TransactionEnquiry_Req.xml).
[2015-05-29 17:13:18,535][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890798534|Timestamp:20150529171318|Transaction-Type:310|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Transaction terminalId="111" traceMessageId="1432890798156"/>,hash=134919961), get digest:74ce0e28f8f6921e3c37dc00279f685a
[2015-05-29 17:13:18,535][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=310).
[2015-05-29 17:13:18,535][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:18,535][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171318).
[2015-05-29 17:13:18,535][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:18,535][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890798534).
[2015-05-29 17:13:18,535][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:18,535][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:18,536][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=74ce0e28f8f6921e3c37dc00279f685a).
[2015-05-29 17:13:18,536][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=-1).
[2015-05-29 17:13:18,536][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:18,536][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:18,537][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6jcIE4b0pl+ogrA4SMNVUFtCb0VnctvqFZ4g+Dv1D5Fz4ERoX4gVmzFJ1yZK27DdHzjsRFyQd8KVMWRCHWN7lPA=.
[2015-05-29 17:13:18,537][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890798534|Timestamp:20150529171318|Transaction-Type:310|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:18,538][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Transaction terminalId="111" traceMessageId="1432890798156"/>
[2015-05-29 17:13:18,538][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890798534|Timestamp:20150529171318|Transaction-Type:310|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Transaction terminalId="111" traceMessageId="1432890798156"/>,hash=134919961), get digest:74ce0e28f8f6921e3c37dc00279f685a
[2015-05-29 17:13:18,538][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.310).
[2015-05-29 17:13:18,538][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/TransactionEnquiry_Req.xml
[2015-05-29 17:13:18,538][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.310).
[2015-05-29 17:13:18,553][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_310_1.5.0).
[2015-05-29 17:13:18,553][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_310_).
[2015-05-29 17:13:18,553][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(-1_310_), found controller(com.mpos.lottery.te.trans.TransactionController@53ddecd8) and method(public void com.mpos.lottery.te.trans.TransactionController.enquiry(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:18,558][Test worker][DEBUG][TransactionServiceImpl] Found TicketEnquiryService[com.mpos.lottery.te.gameimpl.lfn.sale.service.LfnSaleService@23ce68fc] for ticket enquiry.
[2015-05-29 17:13:18,577][Test worker][DEBUG][CommonFacadeService] No need to publish AMQP message of transaction(TRANSACTION_ENQUIRY)
[2015-05-29 17:13:18,578][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/TransactionEnquiry_Res.xml) by key(15.transtype.4310).
[2015-05-29 17:13:18,578][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.trans.domain.Transaction),mappingFile=xml-mapping/game/lfn/TransactionEnquiry_Res.xml
[2015-05-29 17:13:18,578][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/TransactionEnquiry_Res.xml) by key(15.transtype.4310).
[2015-05-29 17:13:18,649][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.trans.domain.Transaction, mappingFile=xml-mapping/game/lfn/TransactionEnquiry_Res.xml).
[2015-05-29 17:13:18,650][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890798534|Timestamp:20150529171318|Transaction-Type:4310|Transaction-Id:0115052900000000000894|Response-Code:200|<?xml version="1.0" encoding="UTF-8"?>
<Transaction id="0115052900000000000847" type="200" createTime="20150529171318" responseCode="200"><Ticket barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqqvZVwatc2iA=" validationCode="694635" multipleDraws="2" totalBets="42" totalAmount="2600" serialNo="01111745519300006396" type="1" lastDrawNo="11003" PIN="98abe3a28383501f4bfd2d9077820f11"><GameDraw xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:java="http://java.sun.com" sale-suspended="false" version="0" state="2" payout-blocked="false" max-claim-days="3650" suspend-manual-cancel="false" risk-control-method="1" xsi:type="java:com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance"><prize-logic-id>PL-LFN-111</prize-logic-id><number>11002</number><end-time>2015-05-30T17:12:14.000+08:00</end-time><max-loss-amount>80000</max-loss-amount><game-id>LFN-1</game-id><freeze-time>2015-05-30T17:42:14.000+08:00</freeze-time><percentage-of-turnover>0.4</percentage-of-turnover><id>GII-112</id><begin-time>2015-05-28T17:12:14.000+08:00</begin-time><game state="1" type="15" need-auto-payout="true"><tax-policy-id>TP-1</tax-policy-id><operator-parameter-id>LFN-OP-1</operator-parameter-id><name>LFN-1</name><id>LFN-1</id><tax-method-base>1</tax-method-base><fun-type-id>FUN-1</fun-type-id><tax-method>1</tax-method></game><draw-date>2015-05-30T17:12:14.000+08:00</draw-date><key>11002-LFN-1</key><name>active game instance</name></GameDraw><Entry selectedNumber="5" betOption="1" inputChannel="2" amount="100"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" amount="1200"/></Ticket></Transaction>):136c309f1962c46a73945b33132a2b31
[2015-05-29 17:13:18,662][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=2208) succesfully.
[2015-05-29 17:13:18,665][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=2208): <?xml version="1.0" encoding="UTF-8"?>
<Transaction id="0115052900000000000847" type="200" createTime="20150529171318" responseCode="200"><Ticket barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqqvZVwatc2iA=" validationCode="694635" multipleDraws="2" totalBets="42" totalAmount="2600" serialNo="01111745519300006396" type="1" lastDrawNo="11003" PIN="98abe3a28383501f4bfd2d9077820f11"><GameDraw xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:java="http://java.sun.com" sale-suspended="false" version="0" state="2" payout-blocked="false" max-claim-days="3650" suspend-manual-cancel="false" risk-control-method="1" xsi:type="java:com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance"><prize-logic-id>PL-LFN-111</prize-logic-id><number>11002</number><end-time>2015-05-30T17:12:14.000+08:00</end-time><max-loss-amount>80000</max-loss-amount><game-id>LFN-1</game-id><freeze-time>2015-05-30T17:42:14.000+08:00</freeze-time><percentage-of-turnover>0.4</percentage-of-turnover><id>GII-112</id><begin-time>2015-05-28T17:12:14.000+08:00</begin-time><game state="1" type="15" need-auto-payout="true"><tax-policy-id>TP-1</tax-policy-id><operator-parameter-id>LFN-OP-1</operator-parameter-id><name>LFN-1</name><id>LFN-1</id><tax-method-base>1</tax-method-base><fun-type-id>FUN-1</fun-type-id><tax-method>1</tax-method></game><draw-date>2015-05-30T17:12:14.000+08:00</draw-date><key>11002-LFN-1</key><name>active game instance</name></GameDraw><Entry selectedNumber="5" betOption="1" inputChannel="2" amount="100"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" amount="1200"/></Ticket></Transaction>
[2015-05-29 17:13:18,666][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/TransactionEnquiry_Res.xml) by key(15.transtype.4310).
[2015-05-29 17:13:18,689][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:18,689][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:18,690][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@354dff7e) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:18,690][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:18,690][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:18,690][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnSaleEnquiryIntegrationTest.testEnquiryTicket_OK                                                                     |
[2015-05-29 17:13:18,690][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:18,691][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:18,691][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:18,692][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890798691|Timestamp:20150529171318|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=-320200388), get digest:a5f4428c71b46408d9267c5c9c11c5f4
[2015-05-29 17:13:18,692][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:18,692][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:18,692][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171318).
[2015-05-29 17:13:18,692][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:18,692][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890798691).
[2015-05-29 17:13:18,692][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:18,692][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:18,692][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=a5f4428c71b46408d9267c5c9c11c5f4).
[2015-05-29 17:13:18,692][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:18,692][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:18,692][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:18,694][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9L2k05jXFbPjS1FsBBTLuWj4a8kJVsM72/YMzruGEM7DWPI5uQU+kvE7y74H12t4zbaRoUQTDb7n/h8zAxrh6Hn2mtyfU/CYtxKe3z/Py5RlIQZDC6AG8TrAvhb3G3SNDjlu4Vxm32uHjs7iClqnt2hDh9rhQSOHhB9K5LUL3NVo8dKwh6SCwM56BaXiK557zz5HaYz2004U1raT6OlReAP7pgHuknsbfxdYkwSI2v0wkzsQ/uHRPv01BVY1tFvgu1/1csAMYBq+O2tRLIhXeAoIJOVLJJPvPHAkozf5FsxcYBza1aivogG1+z8aPrO9uA0h0ScFgQ8LmCP5AX0mf6ruPkYWDcmUtW5ansd9eHP+N72iCfLshuhdBbTWGleRy.
[2015-05-29 17:13:18,694][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890798691|Timestamp:20150529171318|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:18,694][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>
[2015-05-29 17:13:18,695][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890798691|Timestamp:20150529171318|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=-320200388), get digest:a5f4428c71b46408d9267c5c9c11c5f4
[2015-05-29 17:13:18,695][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:18,695][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:18,695][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:18,710][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_1.5.0).
[2015-05-29 17:13:18,710][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_).
[2015-05-29 17:13:18,710][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_200_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:18,717][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance) by(number=11002,gameId=LFN-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:18,722][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:18,722][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01111745519300006424
[2015-05-29 17:13:18,728][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:18,731][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMgjFwMkdg8tM) as 80000
[2015-05-29 17:13:18,735][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMgjFwMkdg8tM, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:18,735][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:18,735][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:18,743][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMgjFwMkdg8tM) as 80000
[2015-05-29 17:13:18,745][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMgjFwMkdg8tM, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:18,745][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:18,745][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:18,752][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:18,752][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:18,759][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:18,759][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:18,766][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:18,766][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:18,773][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:18,773][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:18,780][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:18,780][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:18,786][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:18,787][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:18,793][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:18,793][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:18,800][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:18,800][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:18,806][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:18,806][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:18,813][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:18,813][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:18,819][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:18,820][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:18,826][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:18,826][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:18,833][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:18,833][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:18,840][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:18,840][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:18,847][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:18,847][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:18,854][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:18,854][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:18,860][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:18,860][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:18,867][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:18,867][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:18,874][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:18,874][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:18,880][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMgjFwMkdg8tM) as 80000
[2015-05-29 17:13:18,883][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMgjFwMkdg8tM, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:18,883][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:18,883][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:18,891][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMgjFwMkdg8tM) as 80000
[2015-05-29 17:13:18,893][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMgjFwMkdg8tM, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:18,893][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:18,893][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:18,900][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:18,900][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:18,907][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:18,907][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:18,914][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:18,914][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:18,921][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:18,921][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:18,927][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:18,927][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:18,934][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:18,934][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:18,940][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:18,940][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:18,947][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:18,947][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:18,954][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:18,954][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:18,961][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:18,961][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:18,968][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:18,968][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:18,974][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:18,975][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:18,981][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:18,981][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:18,989][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:18,989][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:18,997][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:18,997][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:19,003][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:19,004][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:19,011][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:19,011][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:19,017][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:19,017][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:19,024][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:19,024][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:19,043][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:19,043][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:19,043][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199997400.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:19,056][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.15]: transaction {
  id: "0115052900000000000895"
  dev_id: "111"
  operator_id: "OPERATOR-111"
  merchant_id: "111"
  create_time: 1432890798000
  trans_type: 200
  game_id: "LFN-1"
  game_type: 15
  total_amount: "2600.0"
}
multi_draw: 2
total_amount: "2600.0"
serial_no: "y013eOifYgLRjcmw7N8vMgjFwMkdg8tM"
game_instance {
  id: "GII-112"
}
entries {
  selected_number: "2,7,13,24,25,36"
  bet_option: 53
  total_bets: 20
  entry_amount: "1200.0"
  input_channel: "2"
}
entries {
  selected_number: "5"
  bet_option: 1
  total_bets: 1
  entry_amount: "100.0"
  input_channel: "2"
}

[2015-05-29 17:13:19,057][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:19,057][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:19,057][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket),mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml
[2015-05-29 17:13:19,057][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:19,058][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml).
[2015-05-29 17:13:19,058][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890798691|Timestamp:20150529171318|Transaction-Type:4200|Transaction-Id:0115052900000000000895|Response-Code:200|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300006424" type="1" lastDrawNo="11003" barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqtM5W/0TUti8=" validationCode="647028" multipleDraws="2" totalBets="42" totalAmount="2600.0"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0"/></Ticket>):fed243477bcee05e7d8f0157110a4d89
[2015-05-29 17:13:19,058][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=672) succesfully.
[2015-05-29 17:13:19,059][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=672): <?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300006424" type="1" lastDrawNo="11003" barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqtM5W/0TUti8=" validationCode="647028" multipleDraws="2" totalBets="42" totalAmount="2600.0"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0"/></Ticket>
[2015-05-29 17:13:19,059][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:19,066][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.202).
[2015-05-29 17:13:19,066][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/CancelTicket_Req.xml).
[2015-05-29 17:13:19,067][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799066|Timestamp:20150529171319|Transaction-Type:202|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300006424" isMannul="0"/>,hash=-1142786711), get digest:c7191ba96d0df36f4685e916445994dc
[2015-05-29 17:13:19,067][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=202).
[2015-05-29 17:13:19,067][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:19,067][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171319).
[2015-05-29 17:13:19,067][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:19,067][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890799066).
[2015-05-29 17:13:19,067][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:19,067][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:19,067][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=c7191ba96d0df36f4685e916445994dc).
[2015-05-29 17:13:19,067][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:19,067][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:19,067][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:19,069][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6ttFDFcpmi1MamgAomcAmY77ZmH0pucSJt0uEHFSyYt5HCJeldd6vCWfvV1rHrRdBtvJj5ZVjfyx.
[2015-05-29 17:13:19,069][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799066|Timestamp:20150529171319|Transaction-Type:202|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:19,069][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300006424" isMannul="0"/>
[2015-05-29 17:13:19,069][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799066|Timestamp:20150529171319|Transaction-Type:202|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300006424" isMannul="0"/>,hash=-1142786711), get digest:c7191ba96d0df36f4685e916445994dc
[2015-05-29 17:13:19,069][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.202).
[2015-05-29 17:13:19,070][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/CancelTicket_Req.xml
[2015-05-29 17:13:19,070][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.202).
[2015-05-29 17:13:19,086][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_202_1.5.0).
[2015-05-29 17:13:19,087][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_202_).
[2015-05-29 17:13:19,087][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_202_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.enquiry(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:19,104][Test worker][DEBUG][CommonFacadeService] No need to publish AMQP message of transaction(TICKET_ENQUIRY)
[2015-05-29 17:13:19,104][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/EnquiryTicket_Resp.xml) by key(15.transtype.4202).
[2015-05-29 17:13:19,104][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket),mappingFile=xml-mapping/game/lfn/EnquiryTicket_Resp.xml
[2015-05-29 17:13:19,104][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/EnquiryTicket_Resp.xml) by key(15.transtype.4202).
[2015-05-29 17:13:19,135][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/EnquiryTicket_Resp.xml).
[2015-05-29 17:13:19,135][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799066|Timestamp:20150529171319|Transaction-Type:4202|Transaction-Id:0115052900000000000942|Response-Code:200|<?xml version="1.0" encoding="UTF-8"?>
<Ticket barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqtM5W/0TUti8=" validationCode="647028" multipleDraws="2" totalBets="42" totalAmount="2600" serialNo="01111745519300006424" type="1" lastDrawNo="11003" PIN="98abe3a28383501f4bfd2d9077820f11"><GameDraw xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:java="http://java.sun.com" sale-suspended="false" version="0" state="2" payout-blocked="false" max-claim-days="3650" suspend-manual-cancel="false" risk-control-method="1" xsi:type="java:com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance"><prize-logic-id>PL-LFN-111</prize-logic-id><number>11002</number><end-time>2015-05-30T17:12:14.000+08:00</end-time><max-loss-amount>80000</max-loss-amount><game-id>LFN-1</game-id><freeze-time>2015-05-30T17:42:14.000+08:00</freeze-time><percentage-of-turnover>0.4</percentage-of-turnover><id>GII-112</id><begin-time>2015-05-28T17:12:14.000+08:00</begin-time><game state="1" type="15" need-auto-payout="true"><tax-policy-id>TP-1</tax-policy-id><operator-parameter-id>LFN-OP-1</operator-parameter-id><name>LFN-1</name><id>LFN-1</id><tax-method-base>1</tax-method-base><fun-type-id>FUN-1</fun-type-id><tax-method>1</tax-method></game><draw-date>2015-05-30T17:12:14.000+08:00</draw-date><key>11002-LFN-1</key><name>active game instance</name></GameDraw><Entry selectedNumber="5" betOption="1" inputChannel="2" amount="100"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" amount="1200"/></Ticket>):775221d78b0157057a202335ddd22043
[2015-05-29 17:13:19,136][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=2060) succesfully.
[2015-05-29 17:13:19,136][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=2060): <?xml version="1.0" encoding="UTF-8"?>
<Ticket barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqtM5W/0TUti8=" validationCode="647028" multipleDraws="2" totalBets="42" totalAmount="2600" serialNo="01111745519300006424" type="1" lastDrawNo="11003" PIN="98abe3a28383501f4bfd2d9077820f11"><GameDraw xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:java="http://java.sun.com" sale-suspended="false" version="0" state="2" payout-blocked="false" max-claim-days="3650" suspend-manual-cancel="false" risk-control-method="1" xsi:type="java:com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance"><prize-logic-id>PL-LFN-111</prize-logic-id><number>11002</number><end-time>2015-05-30T17:12:14.000+08:00</end-time><max-loss-amount>80000</max-loss-amount><game-id>LFN-1</game-id><freeze-time>2015-05-30T17:42:14.000+08:00</freeze-time><percentage-of-turnover>0.4</percentage-of-turnover><id>GII-112</id><begin-time>2015-05-28T17:12:14.000+08:00</begin-time><game state="1" type="15" need-auto-payout="true"><tax-policy-id>TP-1</tax-policy-id><operator-parameter-id>LFN-OP-1</operator-parameter-id><name>LFN-1</name><id>LFN-1</id><tax-method-base>1</tax-method-base><fun-type-id>FUN-1</fun-type-id><tax-method>1</tax-method></game><draw-date>2015-05-30T17:12:14.000+08:00</draw-date><key>11002-LFN-1</key><name>active game instance</name></GameDraw><Entry selectedNumber="5" betOption="1" inputChannel="2" amount="100"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" amount="1200"/></Ticket>
[2015-05-29 17:13:19,136][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/EnquiryTicket_Resp.xml) by key(15.transtype.4202).
]]></system-out>
  <system-err><![CDATA[]]></system-err>
</testsuite>

<?xml version="1.0" encoding="UTF-8"?>
<testsuite name="com.mpos.lottery.te.thirdpartyservice.playeraccount.PlayerTopupIntegrationTest" tests="2" skipped="0" failures="0" errors="0" timestamp="2015-05-29T09:14:05" hostname="Ramon-PC" time="0.164">
  <properties/>
  <testcase name="test_Cancellation" classname="com.mpos.lottery.te.thirdpartyservice.playeraccount.PlayerTopupIntegrationTest" time="0.12"/>
  <testcase name="test_Sell_OK" classname="com.mpos.lottery.te.thirdpartyservice.playeraccount.PlayerTopupIntegrationTest" time="0.043"/>
  <system-out><![CDATA[[2015-05-29 17:14:05,650][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:14:05,650][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:14:05,650][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@21b4c184) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:14:05,651][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:14:05,651][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:14:05,651][Test worker][INFO ][BaseTransactionalIntegrationTest] | PlayerTopupIntegrationTest.test_Cancellation                                                                           |
[2015-05-29 17:14:05,651][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:14:05,656][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/payment/VoucherTopup_Player_Req.xml) by key(transtype.446).
[2015-05-29 17:14:05,665][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.thirdpartyservice.playeraccount.web.PlayerTopupDto, mappingFile=xml-mapping/payment/VoucherTopup_Player_Req.xml).
[2015-05-29 17:14:05,665][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890845656|Timestamp:20150529171405|Transaction-Type:446|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Topup accountId="13800138000" voucherSN="PLAYER-VOUCHER" amount="60.0"/>,hash=-1893408512), get digest:1b4d0cb29b876d1f4f4b66c75f052afd
[2015-05-29 17:14:05,665][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=446).
[2015-05-29 17:14:05,665][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:14:05,665][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171405).
[2015-05-29 17:14:05,665][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:14:05,665][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890845656).
[2015-05-29 17:14:05,665][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:14:05,665][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:14:05,665][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=1b4d0cb29b876d1f4f4b66c75f052afd).
[2015-05-29 17:14:05,665][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=-1).
[2015-05-29 17:14:05,665][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:14:05,665][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:14:05,676][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6iKazMunZMEciAsDsI1z4SBLnNNkBZpURUFZvgw8Zb9fnA5wFscThnRy96JwuwObF4ycTrzNOjilm2K0GRv55yASaPq7w9iXjmFBBTP48yhF.
[2015-05-29 17:14:05,677][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890845656|Timestamp:20150529171405|Transaction-Type:446|Transaction-Id:|Response-Code:|).
[2015-05-29 17:14:05,677][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Topup accountId="13800138000" voucherSN="PLAYER-VOUCHER" amount="60.0"/>
[2015-05-29 17:14:05,677][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890845656|Timestamp:20150529171405|Transaction-Type:446|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Topup accountId="13800138000" voucherSN="PLAYER-VOUCHER" amount="60.0"/>,hash=-1893408512), get digest:1b4d0cb29b876d1f4f4b66c75f052afd
[2015-05-29 17:14:05,677][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/payment/VoucherTopup_Player_Req.xml) by key(transtype.446).
[2015-05-29 17:14:05,677][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/payment/VoucherTopup_Player_Req.xml
[2015-05-29 17:14:05,677][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/payment/VoucherTopup_Player_Req.xml) by key(transtype.446).
[2015-05-29 17:14:05,687][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_446_1.5.0).
[2015-05-29 17:14:05,687][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_446_).
[2015-05-29 17:14:05,687][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(-1_446_), found controller(com.mpos.lottery.te.thirdpartyservice.playeraccount.PlayerController@e86c122) and method(public void com.mpos.lottery.te.thirdpartyservice.playeraccount.PlayerController.topup(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:14:05,693][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:14:05,693][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:14:05,693][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199999940.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:14:05,702][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.446] with routing key[TE.446.-1]: id: "0115052900000000002355"
dev_id: "111"
operator_id: "OPERATOR-111"
merchant_id: "111"
create_time: 1432890845000
trans_type: 446
game_type: -1
total_amount: "60.0"

[2015-05-29 17:14:05,703][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:14:05,703][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890845656|Timestamp:20150529171405|Transaction-Type:4446|Transaction-Id:0115052900000000002355|Response-Code:200|):a03ae6b2ca5a0d666ddbabebf09cf37f
[2015-05-29 17:14:05,703][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=0): 
[2015-05-29 17:14:05,704][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:14:05,704][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.trans.domain.Transaction, mappingFile=xml-mapping/TransactionEnquiry_Req.xml).
[2015-05-29 17:14:05,705][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890845704|Timestamp:20150529171405|Transaction-Type:206|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Transaction terminalId="111" traceMessageId="1432890845656"/>,hash=2052458798), get digest:bade444a8b66a837ffc100a4e69e2a96
[2015-05-29 17:14:05,705][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=206).
[2015-05-29 17:14:05,705][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:14:05,705][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171405).
[2015-05-29 17:14:05,705][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:14:05,705][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890845704).
[2015-05-29 17:14:05,705][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:14:05,705][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:14:05,705][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=bade444a8b66a837ffc100a4e69e2a96).
[2015-05-29 17:14:05,705][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=-1).
[2015-05-29 17:14:05,705][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:14:05,705][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:14:05,706][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6jcIE4b0pl+ogrA4SMNVUFtCb0VnctvqFZ4g+Dv1D5Fz4ERoX4gVmzFJ1yZK27DdH3DDLgbu+HNdkUsqpfgwm/E=.
[2015-05-29 17:14:05,707][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890845704|Timestamp:20150529171405|Transaction-Type:206|Transaction-Id:|Response-Code:|).
[2015-05-29 17:14:05,707][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Transaction terminalId="111" traceMessageId="1432890845656"/>
[2015-05-29 17:14:05,707][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890845704|Timestamp:20150529171405|Transaction-Type:206|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Transaction terminalId="111" traceMessageId="1432890845656"/>,hash=2052458798), get digest:bade444a8b66a837ffc100a4e69e2a96
[2015-05-29 17:14:05,707][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:14:05,707][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/TransactionEnquiry_Req.xml
[2015-05-29 17:14:05,707][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:14:05,718][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_206_1.5.0).
[2015-05-29 17:14:05,718][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_206_).
[2015-05-29 17:14:05,718][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(-1_206_), found controller(com.mpos.lottery.te.trans.TransactionController@53ddecd8) and method(public void com.mpos.lottery.te.trans.TransactionController.cancelByTrans(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:14:05,722][Test worker][DEBUG][ReversalOrCancelStrategyFactory] Found ReversalStrategy(class com.mpos.lottery.te.thirdpartyservice.playeraccount.service.DefaultPlayerTopupService) to cancel transaction(gameType=-1,terminalId=111,transType=446,protocolVersion=1.5.0).
[2015-05-29 17:14:05,726][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199999940, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=6]
[2015-05-29 17:14:05,726][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:14:05,726][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=6]
[2015-05-29 17:14:05,736][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.446] with routing key[TE.CANCEL.446.-1]: origTrans {
  id: "0115052900000000002355"
  dev_id: "111"
  operator_id: "OPERATOR-111"
  merchant_id: "111"
  create_time: 1432890845000
  trans_type: 446
  game_type: -1
  total_amount: "60"
}
cancelTrans {
  id: "0115052900000000002356"
  dev_id: "111"
  operator_id: "OPERATOR-111"
  merchant_id: "111"
  create_time: 1432890845000
  trans_type: 206
  game_type: -1
  total_amount: "60"
}

[2015-05-29 17:14:05,736][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:14:05,737][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890845704|Timestamp:20150529171405|Transaction-Type:4206|Transaction-Id:0115052900000000002356|Response-Code:200|):e2b2f0356f4eded800c64a67cf1b1bc1
[2015-05-29 17:14:05,737][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=0): 
[2015-05-29 17:14:05,764][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:14:05,764][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:14:05,764][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@2b5878b6) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:14:05,765][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:14:05,765][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:14:05,765][Test worker][INFO ][BaseTransactionalIntegrationTest] | PlayerTopupIntegrationTest.test_Sell_OK                                                                                |
[2015-05-29 17:14:05,765][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:14:05,768][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/payment/VoucherTopup_Player_Req.xml) by key(transtype.446).
[2015-05-29 17:14:05,768][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.thirdpartyservice.playeraccount.web.PlayerTopupDto, mappingFile=xml-mapping/payment/VoucherTopup_Player_Req.xml).
[2015-05-29 17:14:05,769][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890845768|Timestamp:20150529171405|Transaction-Type:446|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Topup accountId="13800138000" voucherSN="PLAYER-VOUCHER" amount="60.0"/>,hash=-180599454), get digest:ee23d2b8d08ce77a3354df7b86a6f907
[2015-05-29 17:14:05,769][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=446).
[2015-05-29 17:14:05,769][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:14:05,769][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171405).
[2015-05-29 17:14:05,769][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:14:05,769][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890845768).
[2015-05-29 17:14:05,769][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:14:05,769][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:14:05,769][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=ee23d2b8d08ce77a3354df7b86a6f907).
[2015-05-29 17:14:05,769][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=-1).
[2015-05-29 17:14:05,769][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:14:05,769][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:14:05,770][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6iKazMunZMEciAsDsI1z4SBLnNNkBZpURUFZvgw8Zb9fnA5wFscThnRy96JwuwObF4ycTrzNOjilm2K0GRv55yASaPq7w9iXjmFBBTP48yhF.
[2015-05-29 17:14:05,770][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890845768|Timestamp:20150529171405|Transaction-Type:446|Transaction-Id:|Response-Code:|).
[2015-05-29 17:14:05,771][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Topup accountId="13800138000" voucherSN="PLAYER-VOUCHER" amount="60.0"/>
[2015-05-29 17:14:05,771][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890845768|Timestamp:20150529171405|Transaction-Type:446|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Topup accountId="13800138000" voucherSN="PLAYER-VOUCHER" amount="60.0"/>,hash=-180599454), get digest:ee23d2b8d08ce77a3354df7b86a6f907
[2015-05-29 17:14:05,771][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/payment/VoucherTopup_Player_Req.xml) by key(transtype.446).
[2015-05-29 17:14:05,771][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/payment/VoucherTopup_Player_Req.xml
[2015-05-29 17:14:05,771][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/payment/VoucherTopup_Player_Req.xml) by key(transtype.446).
[2015-05-29 17:14:05,780][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_446_1.5.0).
[2015-05-29 17:14:05,780][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_446_).
[2015-05-29 17:14:05,780][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(-1_446_), found controller(com.mpos.lottery.te.thirdpartyservice.playeraccount.PlayerController@e86c122) and method(public void com.mpos.lottery.te.thirdpartyservice.playeraccount.PlayerController.topup(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:14:05,786][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:14:05,786][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:14:05,786][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199999940.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:14:05,795][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.446] with routing key[TE.446.-1]: id: "0115052900000000002357"
dev_id: "111"
operator_id: "OPERATOR-111"
merchant_id: "111"
create_time: 1432890845000
trans_type: 446
game_type: -1
total_amount: "60.0"

[2015-05-29 17:14:05,795][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:14:05,795][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890845768|Timestamp:20150529171405|Transaction-Type:4446|Transaction-Id:0115052900000000002357|Response-Code:200|):e4cb92292139f5f78a23e8781056b93b
[2015-05-29 17:14:05,795][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=0): 
]]></system-out>
  <system-err><![CDATA[]]></system-err>
</testsuite>

<?xml version="1.0" encoding="UTF-8"?>
<testsuite name="com.mpos.lottery.te.valueaddservice.vat.sale.OfflineVatUploadIntegrationTest" tests="2" skipped="0" failures="0" errors="0" timestamp="2015-05-29T09:14:43" hostname="Ramon-PC" time="0.486">
  <properties/>
  <testcase name="testUpload_AllSuccess" classname="com.mpos.lottery.te.valueaddservice.vat.sale.OfflineVatUploadIntegrationTest" time="0.307"/>
  <testcase name="testUpload_PartialSuccess" classname="com.mpos.lottery.te.valueaddservice.vat.sale.OfflineVatUploadIntegrationTest" time="0.178"/>
  <system-out><![CDATA[[2015-05-29 17:14:43,171][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:14:43,172][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:14:43,172][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@d97efde) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:14:43,172][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:14:43,173][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:14:43,173][Test worker][INFO ][BaseTransactionalIntegrationTest] | OfflineVatUploadIntegrationTest.testUpload_AllSuccess                                                                  |
[2015-05-29 17:14:43,173][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:14:43,182][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/vat/OfflineVatUpload_Req.xml) by key(transtype.451).
[2015-05-29 17:14:43,200][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.valueaddservice.vat.web.VatOfflineSaleUploadDto, mappingFile=xml-mapping/vat/OfflineVatUpload_Req.xml).
[2015-05-29 17:14:43,201][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890883182|Timestamp:20150529171443|Transaction-Type:451|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<OfflineVatSale totalCount="4"><VAT totalAmount="1000.0" code="foodA" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805001" transTimestamp="20150529171443"><Ticket serialNo="20140805001" barcode="14cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt/KasGYFkVHOyhvon3oFa5u" validationCode="371842" multipleDraws="1" totalBets="1" totalAmount="100.0"><GameDraw number="11001" gameId="RA-1"/></Ticket></VAT><VAT totalAmount="1000.0" code="foodA" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805002" transTimestamp="20150529171443"><Ticket serialNo="20140805002" barcode="14cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt/KasGYFkVHOyyOxNj73VQT" validationCode="371842" multipleDraws="1" totalBets="1" totalAmount="100.0"><GameDraw number="11002" gameId="RA-1"/></Ticket></VAT><VAT totalAmount="1000.0" code="foodB" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805003" transTimestamp="20150529171443"><Ticket serialNo="20140805003" barcode="18cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt/KasGYFkVHO7Q9AlJkdWsN" validationCode="371842" multipleDraws="1" totalBets="2" totalAmount="200.0"><GameDraw number="001" gameId="LK-1"/><Entry selectedNumber="59" betOption="1" inputChannel="0" totalBets="1" entryAmount="100.0"/><Entry selectedNumber="60" betOption="1" inputChannel="0" totalBets="1" entryAmount="100.0"/></Ticket></VAT><VAT totalAmount="1000.0" code="foodB" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805004" transTimestamp="20150529171443"/></OfflineVatSale>,hash=221888391), get digest:01b600bd1a87cc6c4c8844a8a0612ac4
[2015-05-29 17:14:43,201][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=451).
[2015-05-29 17:14:43,201][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:14:43,201][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171443).
[2015-05-29 17:14:43,201][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:14:43,201][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890883182).
[2015-05-29 17:14:43,201][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:14:43,201][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:14:43,201][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=01b600bd1a87cc6c4c8844a8a0612ac4).
[2015-05-29 17:14:43,202][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=-1).
[2015-05-29 17:14:43,202][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:14:43,202][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:14:43,204][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6pztfcBRKJSWYAwSPJlGQyf0dyzTH4SpakvQWT7LzakItCNe3MxISlYJv0LOdGTEVMvmaos6Zv5gyusLrEEcqVDhnBZbJlpIWzLt0Qq+jDWUZj8tVWTvshy8cfIbMx5xDJ2Z8QufMzCnKyiZdt0MrfNckd0dFdr3MWv+lg4+aLxW9bTRSqPuUtyVaIaAznHtucFx6KV5CDsy+LA70yj0twkkLLtICl43BOdIi1nwH3tF3pLpcXzDRYJqCX+OwmvyQZfaghyS93wYk1OAVf+zQCxJAkgjw2SIt6yVikGJMHHEY8z7fqGaadbmFCa5UdrU/ssrfIuaroclexP8MXpGSiu+Cfve2RmrGbgJt1kXs3qmQe5zpnpv6qJT2uzPi28te5FmXDEQ2bGPAZPf8KHMG/nx0fqwDxq3cWP/oig8oA5vWUUQUZ6a2cz/fyxfgPUcbEWZmko4Rm0PfRcRtBPVqcbmUN3sVzAzGw8LH4qDkTMbMSnuKKFfSx3Ma3Mj53F0DRY6IfnDOD1dqj4BjlBFk8i2MWcRAkAIr9/BXFbgYDtDvsuAcC4VbwE+dvjA5oNP0MChYBN8sUnL76toerpn5s0AWyvwa4S6mZR77VSgkvWhyeAglq4Ci7wK8vcoeFLVHgjR7ZhQfmtuV/6g3H4mI+jwXXMzBR8LRhkriO8XheQ+ohEKe/5UIzYSZCQgw9Dlodiiug8wL9AcXBwEBPfEJEaGgzeKOlrNsoSP5ItMci1IpwqASXO8lBswb+HhYRuur4A/0GicdLORQzmzV0sugEuyQQJrbEE+kLn1NkDqWsflgQNQAcK5qHJUwuJjC3wF+CNibEFnmbRGdT1sSALnwY7HjMMPmajM/pp6Mrddu+2mZ1SVrZUcXdlkcvi5BUwh9g7/Bmc572Bx339KPqh38PZQY73Zeg/35aqYAAeBhVekcRQvyVZEv690B9Er7Q7NA/01ZhxPXqNKS+UCM4to9psKDhi6mh+ekkvgxJgmshREiSnjVkaJraDEkDEM4kqWNr9QH1gbsEbCt0aiFcVIgjQJZyhUrBW5TAOwNwJ/BAQB3urVpy/BIj5QKvB6KfCZMt8qW5pVpxp43ww+udqRkTzM4WgkQw8lUpYCQfj09zChRw9oib4eL/5PZA+JGOWc0exDzCUqIZab/Nu1cfAorx6H2el2TKq1J12ERVpQpcio1nC22VW5zXOx4aMyfG26tg0uoRkWIc0lwYHhD2H6uLECLdTLyQdaS51Cge7k1+36jukubwKHXFZGvDzoxFDDr3/6K+ftXNdTgz6bqQbRp8kXgdcnItPDZAJN85iTb8uzOkQMjdOKdE6WSEQLO3e639WQXr+ZngVvb9Q9nrdScqhbuC8g9R174LPDt/DP9aWh4GAKUT30ihKk45eHVDo1pyPkbkou6KiHbOBl9M19+S6D+yatt2pGLhh4PffiTdldPO7eyxBx8bcrHiSyjnJvAP696C1WM08IGLCW2Or5d0pnOh7JbDsqENcMvPlK4BsP2Y7NEuvuOz5llt67KxNiTse7Mdytb0DciSp6Kj2jCdmUR65FcJmVGh6SFAHfzA65fC49GesUvlQP4fCCNlSXfpa1yWr773Qpcagu4y7/gVIAehYPxqU+lczik9Z3yBeIwaymkqnQW9XjMcPxgP2/JDa3r1lvG1s/CYzs/N/z86aLihQutT2tLMZGhbZeHh9aTc02juv9CqvRnKLpJCFfX+kd4p5msokfgz6En+5TyL0RMieozw/i23ulKz4W63TJeRGHC7V+DgkpmqT/J9dUjr5HFXThhc3Id5YBm567ftEuvMFE/EsgPMBILIAuO9W992J20lctIP4dvHSuvyJSmi9ojXjmiM3KLthwkTY4be1p8IVn8/58XaNREv5WnOe0nPrQ26YD8CZzyiTzM1edFxGGMpC/wlEH.
[2015-05-29 17:14:43,204][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890883182|Timestamp:20150529171443|Transaction-Type:451|Transaction-Id:|Response-Code:|).
[2015-05-29 17:14:43,205][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<OfflineVatSale totalCount="4"><VAT totalAmount="1000.0" code="foodA" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805001" transTimestamp="20150529171443"><Ticket serialNo="20140805001" barcode="14cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt/KasGYFkVHOyhvon3oFa5u" validationCode="371842" multipleDraws="1" totalBets="1" totalAmount="100.0"><GameDraw number="11001" gameId="RA-1"/></Ticket></VAT><VAT totalAmount="1000.0" code="foodA" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805002" transTimestamp="20150529171443"><Ticket serialNo="20140805002" barcode="14cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt/KasGYFkVHOyyOxNj73VQT" validationCode="371842" multipleDraws="1" totalBets="1" totalAmount="100.0"><GameDraw number="11002" gameId="RA-1"/></Ticket></VAT><VAT totalAmount="1000.0" code="foodB" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805003" transTimestamp="20150529171443"><Ticket serialNo="20140805003" barcode="18cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt/KasGYFkVHO7Q9AlJkdWsN" validationCode="371842" multipleDraws="1" totalBets="2" totalAmount="200.0"><GameDraw number="001" gameId="LK-1"/><Entry selectedNumber="59" betOption="1" inputChannel="0" totalBets="1" entryAmount="100.0"/><Entry selectedNumber="60" betOption="1" inputChannel="0" totalBets="1" entryAmount="100.0"/></Ticket></VAT><VAT totalAmount="1000.0" code="foodB" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805004" transTimestamp="20150529171443"/></OfflineVatSale>
[2015-05-29 17:14:43,205][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890883182|Timestamp:20150529171443|Transaction-Type:451|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<OfflineVatSale totalCount="4"><VAT totalAmount="1000.0" code="foodA" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805001" transTimestamp="20150529171443"><Ticket serialNo="20140805001" barcode="14cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt/KasGYFkVHOyhvon3oFa5u" validationCode="371842" multipleDraws="1" totalBets="1" totalAmount="100.0"><GameDraw number="11001" gameId="RA-1"/></Ticket></VAT><VAT totalAmount="1000.0" code="foodA" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805002" transTimestamp="20150529171443"><Ticket serialNo="20140805002" barcode="14cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt/KasGYFkVHOyyOxNj73VQT" validationCode="371842" multipleDraws="1" totalBets="1" totalAmount="100.0"><GameDraw number="11002" gameId="RA-1"/></Ticket></VAT><VAT totalAmount="1000.0" code="foodB" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805003" transTimestamp="20150529171443"><Ticket serialNo="20140805003" barcode="18cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt/KasGYFkVHO7Q9AlJkdWsN" validationCode="371842" multipleDraws="1" totalBets="2" totalAmount="200.0"><GameDraw number="001" gameId="LK-1"/><Entry selectedNumber="59" betOption="1" inputChannel="0" totalBets="1" entryAmount="100.0"/><Entry selectedNumber="60" betOption="1" inputChannel="0" totalBets="1" entryAmount="100.0"/></Ticket></VAT><VAT totalAmount="1000.0" code="foodB" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805004" transTimestamp="20150529171443"/></OfflineVatSale>,hash=221888391), get digest:01b600bd1a87cc6c4c8844a8a0612ac4
[2015-05-29 17:14:43,205][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/vat/OfflineVatUpload_Req.xml) by key(transtype.451).
[2015-05-29 17:14:43,205][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/vat/OfflineVatUpload_Req.xml
[2015-05-29 17:14:43,205][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/vat/OfflineVatUpload_Req.xml) by key(transtype.451).
[2015-05-29 17:14:43,226][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_451_1.5.0).
[2015-05-29 17:14:43,226][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_451_).
[2015-05-29 17:14:43,226][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(-1_451_), found controller(com.mpos.lottery.te.valueaddservice.vat.VatController@1aeefda9) and method(public void com.mpos.lottery.te.valueaddservice.vat.VatController.uploadOfflineSale(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:14:43,269][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:14:43,269][Test worker][DEBUG][DefaultOfflineTicketService] The ID of current active game instance is GII-112 of gameType:14
[2015-05-29 17:14:43,282][Test worker][DEBUG][DefaultCreditService] The current credit level(before transaction) of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0] is saleCreditLevel:200000000,payoutCreditLevel:1000
[2015-05-29 17:14:43,282][Test worker][DEBUG][DefaultCreditService] The new sale credit level of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199999900.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0] is 199999900.0
[2015-05-29 17:14:43,313][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:14:43,313][Test worker][DEBUG][DefaultOfflineTicketService] The ID of current active game instance is GII-112 of gameType:14
[2015-05-29 17:14:43,321][Test worker][DEBUG][DefaultCreditService] The current credit level(before transaction) of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199999900, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0] is saleCreditLevel:199999900,payoutCreditLevel:1000
[2015-05-29 17:14:43,321][Test worker][DEBUG][DefaultCreditService] The new sale credit level of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199999800.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0] is 199999800.0
[2015-05-29 17:14:43,362][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:14:43,362][Test worker][DEBUG][DefaultOfflineTicketService] The ID of current active game instance is GII-111 of gameType:18
[2015-05-29 17:14:43,374][Test worker][DEBUG][DefaultCreditService] The current credit level(before transaction) of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199999800, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0] is saleCreditLevel:199999800,payoutCreditLevel:1000
[2015-05-29 17:14:43,374][Test worker][DEBUG][DefaultCreditService] The new sale credit level of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199999600.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0] is 199999600.0
[2015-05-29 17:14:43,397][Test worker][DEBUG][CommonFacadeService] No need to publish AMQP message of transaction(VAT_UPLOAD_OFFLINESALE)
[2015-05-29 17:14:43,397][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/vat/OfflineVatUpload_Res.xml) by key(transtype.4451).
[2015-05-29 17:14:43,397][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.valueaddservice.vat.web.VatOfflineSaleUploadDto),mappingFile=xml-mapping/vat/OfflineVatUpload_Res.xml
[2015-05-29 17:14:43,398][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/vat/OfflineVatUpload_Res.xml) by key(transtype.4451).
[2015-05-29 17:14:43,408][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.valueaddservice.vat.web.VatOfflineSaleUploadDto, mappingFile=xml-mapping/vat/OfflineVatUpload_Res.xml).
[2015-05-29 17:14:43,408][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890883182|Timestamp:20150529171443|Transaction-Type:4451|Transaction-Id:0115052900000000002515|Response-Code:200|<?xml version="1.0" encoding="UTF-8"?>
<OfflineVatSale totalCount="4" success="4" failure="0"/>):12c3f3989691dcc476c203d943e6066f
[2015-05-29 17:14:43,408][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=128) succesfully.
[2015-05-29 17:14:43,409][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=128): <?xml version="1.0" encoding="UTF-8"?>
<OfflineVatSale totalCount="4" success="4" failure="0"/>
[2015-05-29 17:14:43,409][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/vat/OfflineVatUpload_Res.xml) by key(transtype.4451).
[2015-05-29 17:14:43,470][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:14:43,470][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:14:43,471][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@5bb0b288) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:14:43,471][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:14:43,471][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:14:43,471][Test worker][INFO ][BaseTransactionalIntegrationTest] | OfflineVatUploadIntegrationTest.testUpload_PartialSuccess                                                              |
[2015-05-29 17:14:43,471][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:14:43,480][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/vat/OfflineVatUpload_Req.xml) by key(transtype.451).
[2015-05-29 17:14:43,482][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.valueaddservice.vat.web.VatOfflineSaleUploadDto, mappingFile=xml-mapping/vat/OfflineVatUpload_Req.xml).
[2015-05-29 17:14:43,482][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890883480|Timestamp:20150529171443|Transaction-Type:451|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<OfflineVatSale totalCount="4"><VAT totalAmount="1000.0" code="foodA" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805001" transTimestamp="20150529171443"><Ticket serialNo="20140805001" barcode="14cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt/KasGYFkVHOyhvon3oFa5u" validationCode="371842" multipleDraws="1" totalBets="1" totalAmount="100.0"><GameDraw number="11001" gameId="RA-1"/></Ticket></VAT><VAT totalAmount="1000.0" code="NO-Exist" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805002" transTimestamp="20150529171443"><Ticket serialNo="20140805002" barcode="14cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt/KasGYFkVHOyyOxNj73VQT" validationCode="371842" multipleDraws="1" totalBets="1" totalAmount="100.0"><GameDraw number="11002" gameId="RA-1"/></Ticket></VAT><VAT totalAmount="1000.0" code="foodB" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805003" transTimestamp="20150529171443"><Ticket serialNo="20140805003" barcode="18cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt/KasGYFkVHO7Q9AlJkdWsN" validationCode="371842" multipleDraws="1" totalBets="2" totalAmount="200.0"><GameDraw number="001" gameId="LK-1"/><Entry selectedNumber="59" betOption="1" inputChannel="0" totalBets="1" entryAmount="100.0"/><Entry selectedNumber="60" betOption="1" inputChannel="0" totalBets="1" entryAmount="100.0"/></Ticket></VAT><VAT totalAmount="1000.0" code="foodB" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805004" transTimestamp="20150529171443"/></OfflineVatSale>,hash=-1284936186), get digest:97b5dd44fe28b0fbe15b5b7836b169d5
[2015-05-29 17:14:43,482][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=451).
[2015-05-29 17:14:43,482][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:14:43,483][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171443).
[2015-05-29 17:14:43,483][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:14:43,483][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890883480).
[2015-05-29 17:14:43,483][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:14:43,483][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:14:43,483][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=97b5dd44fe28b0fbe15b5b7836b169d5).
[2015-05-29 17:14:43,483][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=-1).
[2015-05-29 17:14:43,483][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:14:43,483][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:14:43,484][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6pztfcBRKJSWYAwSPJlGQyf0dyzTH4SpakvQWT7LzakItCNe3MxISlYJv0LOdGTEVMvmaos6Zv5gyusLrEEcqVDhnBZbJlpIWzLt0Qq+jDWUZj8tVWTvshy8cfIbMx5xDJ2Z8QufMzCnKyiZdt0MrfNckd0dFdr3MWv+lg4+aLxW9bTRSqPuUtyVaIaAznHtucFx6KV5CDsy+LA70yj0twkkLLtICl43BOdIi1nwH3tF3pLpcXzDRYJqCX+OwmvyQZfaghyS93wYk1OAVf+zQCxJAkgjw2SIt6yVikGJMHHEY8z7fqGaadbmFCa5UdrU/ssrfIuaroclexP8MXpGSiu+Cfve2RmrGbgJt1kXs3qmQe5zpnpv6qJT2uzPi28te5FmXDEQ2bGPAZPf8KHMG/nx0fqwDxq3cWP/oig8oA5vWUUQUZ6a2cz/fyxfgPUcbEWZmko4Rm0PfRcRtBPVqcbmUN3sVzAzGw8LH4qDkTMbMSnuKKFfSx3Ma3Mj53F0DRY6IfnDOD1dqj4BjlBFk8i2MWcRAkAIr9/BXFbgYDtDvsuAcC4VbwE2hgkdmjPSNVAZRKXSI24GmgNTHxk3LPzdMUpHAIXDbgkEywyEuN+gZxviNIzSgIQc3i1FeMOE3+XFRoyu1RrtInUzgkhkKABrMX5A3U+f00ExRJ3bEjNe+UmIL/kehTA6ZDm7B4BRlQDESv776Q5PczoioFr9qGhSMiOOBJA3guonF1/rgO16HjSerdIXnuSLl9Y2z4kLdkRKQ+hAqXzUdbpec+tj9HHwVX6XoeKZFfvNmMt4TPMexy4jgEj6ARloEXDsEnkmRNgYV4Bl9Zpd8Ga29wJxiMn+5EyRNq6D78oKjlfGQgNYnfJU9M9tUZIq82DwC6tevOdAq92NipHdyzzP24YTzCd/Rd/qqzEhGD3xm5t/Cl9xRdsO18J8rNJbiG8u3kPAMDieVO5J6Bb5R0fYQ4OQb3qMXfCtNfJwBKXYr2VirmG+Lunjuf7J4swjQ7eXzR5J0QwhuaGvRCGKUjE3ihcbXiceeGS4EUEE0TZoKTpRUNfKJFgRbUhXAkAjfY25dAiPBDaNz19qrkuXqt7aLxKiP5C+7LuCM6Lxdy+ZtJ7Afr+8hQPW62p5BoGCqe/bZWhG9B0cxhJMhDBDWJamGFqGTmMgjJ/D097Ic2ErkxbJILKZZfX4GRpTR0Fi3T1Xav2JYiUYt0/qP/DEGdfK+H7B0DShS/Vbsm9+16o94o0ONc+WmejmshVpmzY+1DkoITG2IAjEO3C3e+TFo8z91s4dv/7zrn9jRadLBm9dEjcApCG2Yog8qXGpGGFnwQQxbgjLsdXWL9HzKAdkP25IzjRu5cWIUlfyFgoOy1f2IWLRFqQj4f0C5j6G6q7JrwbgKdst5sayuYec98ATomv/k2LGPOX6YwgFbaOhQNzMa8TpvAiVtFBktN59r6xLmCSvhjSWBeDQAaEYedbaI8aWman7vx6DOLcylE88QxUMCQxWXL3asGm6FfIBanux1XUJaSy3ruP4x3ZDQcXPBFCp67GTjpMcsMraE3A9quVQf7wZunOkjx/1oMaFgGozPN+RUwmfxnLF7gRx7DSnCVMxEYbRKKpe6BV9zt2/SNWGTNPCTh+lJU69QEABufz0PB1GOYy+IjHpSGFopgXgFzCJfiMz5JD0zgvLhFNyveSaEUl96sJ/NUHJxqzVf4SAMXCPUCJBGZJTryp84w8UThcaLehlZ9chuOY/1TcVKDD2xJLhCn+d1XP37U5v9MNDddGeQp82iGWr2CmCU3L0VJwpMM/xD1o/ZT4iOfI59OwxLdNsMGZbZt5BRR9R52rAZNPN48ngX+5VaxOdt0SJwgfVUGClAoPa+vBmhNt3EjVl+Q3DmtFao8lLVp/yM/6UDOGrwNhUU8/1SPMGoB3J.
[2015-05-29 17:14:43,485][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890883480|Timestamp:20150529171443|Transaction-Type:451|Transaction-Id:|Response-Code:|).
[2015-05-29 17:14:43,485][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<OfflineVatSale totalCount="4"><VAT totalAmount="1000.0" code="foodA" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805001" transTimestamp="20150529171443"><Ticket serialNo="20140805001" barcode="14cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt/KasGYFkVHOyhvon3oFa5u" validationCode="371842" multipleDraws="1" totalBets="1" totalAmount="100.0"><GameDraw number="11001" gameId="RA-1"/></Ticket></VAT><VAT totalAmount="1000.0" code="NO-Exist" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805002" transTimestamp="20150529171443"><Ticket serialNo="20140805002" barcode="14cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt/KasGYFkVHOyyOxNj73VQT" validationCode="371842" multipleDraws="1" totalBets="1" totalAmount="100.0"><GameDraw number="11002" gameId="RA-1"/></Ticket></VAT><VAT totalAmount="1000.0" code="foodB" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805003" transTimestamp="20150529171443"><Ticket serialNo="20140805003" barcode="18cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt/KasGYFkVHO7Q9AlJkdWsN" validationCode="371842" multipleDraws="1" totalBets="2" totalAmount="200.0"><GameDraw number="001" gameId="LK-1"/><Entry selectedNumber="59" betOption="1" inputChannel="0" totalBets="1" entryAmount="100.0"/><Entry selectedNumber="60" betOption="1" inputChannel="0" totalBets="1" entryAmount="100.0"/></Ticket></VAT><VAT totalAmount="1000.0" code="foodB" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805004" transTimestamp="20150529171443"/></OfflineVatSale>
[2015-05-29 17:14:43,485][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890883480|Timestamp:20150529171443|Transaction-Type:451|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<OfflineVatSale totalCount="4"><VAT totalAmount="1000.0" code="foodA" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805001" transTimestamp="20150529171443"><Ticket serialNo="20140805001" barcode="14cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt/KasGYFkVHOyhvon3oFa5u" validationCode="371842" multipleDraws="1" totalBets="1" totalAmount="100.0"><GameDraw number="11001" gameId="RA-1"/></Ticket></VAT><VAT totalAmount="1000.0" code="NO-Exist" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805002" transTimestamp="20150529171443"><Ticket serialNo="20140805002" barcode="14cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt/KasGYFkVHOyyOxNj73VQT" validationCode="371842" multipleDraws="1" totalBets="1" totalAmount="100.0"><GameDraw number="11002" gameId="RA-1"/></Ticket></VAT><VAT totalAmount="1000.0" code="foodB" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805003" transTimestamp="20150529171443"><Ticket serialNo="20140805003" barcode="18cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt/KasGYFkVHO7Q9AlJkdWsN" validationCode="371842" multipleDraws="1" totalBets="2" totalAmount="200.0"><GameDraw number="001" gameId="LK-1"/><Entry selectedNumber="59" betOption="1" inputChannel="0" totalBets="1" entryAmount="100.0"/><Entry selectedNumber="60" betOption="1" inputChannel="0" totalBets="1" entryAmount="100.0"/></Ticket></VAT><VAT totalAmount="1000.0" code="foodB" buyerTaxNo="TAX-112" rate="0.1" refNo="20140805004" transTimestamp="20150529171443"/></OfflineVatSale>,hash=-1284936186), get digest:97b5dd44fe28b0fbe15b5b7836b169d5
[2015-05-29 17:14:43,485][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/vat/OfflineVatUpload_Req.xml) by key(transtype.451).
[2015-05-29 17:14:43,485][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/vat/OfflineVatUpload_Req.xml
[2015-05-29 17:14:43,485][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/vat/OfflineVatUpload_Req.xml) by key(transtype.451).
[2015-05-29 17:14:43,504][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_451_1.5.0).
[2015-05-29 17:14:43,504][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_451_).
[2015-05-29 17:14:43,504][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(-1_451_), found controller(com.mpos.lottery.te.valueaddservice.vat.VatController@1aeefda9) and method(public void com.mpos.lottery.te.valueaddservice.vat.VatController.uploadOfflineSale(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:14:43,530][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:14:43,530][Test worker][DEBUG][DefaultOfflineTicketService] The ID of current active game instance is GII-112 of gameType:14
[2015-05-29 17:14:43,538][Test worker][DEBUG][DefaultCreditService] The current credit level(before transaction) of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0] is saleCreditLevel:200000000,payoutCreditLevel:1000
[2015-05-29 17:14:43,539][Test worker][DEBUG][DefaultCreditService] The new sale credit level of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199999900.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0] is 199999900.0
[2015-05-29 17:14:43,546][Test worker][WARN ][DefaultVatOfflineSaleService] No valid VAT found by code(NO-Exist)
com.mpos.lottery.te.config.exception.ApplicationException: No valid VAT found by code(NO-Exist)
	at com.mpos.lottery.te.valueaddservice.vat.service.impl.DefaultVatOfflineSaleService.handleOffline(DefaultVatOfflineSaleService.java:143)
	at com.mpos.lottery.te.valueaddservice.vat.service.impl.DefaultVatOfflineSaleService.upload(DefaultVatOfflineSaleService.java:97)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy77.upload(Unknown Source)
	at com.mpos.lottery.te.valueaddservice.vat.VatController.uploadOfflineSale(VatController.java:57)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.valueaddservice.vat.sale.OfflineVatUploadIntegrationTest.testUpload_PartialSuccess(OfflineVatUploadIntegrationTest.java:190)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:14:43,574][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:14:43,574][Test worker][DEBUG][DefaultOfflineTicketService] The ID of current active game instance is GII-111 of gameType:18
[2015-05-29 17:14:43,582][Test worker][DEBUG][DefaultCreditService] The current credit level(before transaction) of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199999900, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0] is saleCreditLevel:199999900,payoutCreditLevel:1000
[2015-05-29 17:14:43,582][Test worker][DEBUG][DefaultCreditService] The new sale credit level of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199999700.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0] is 199999700.0
[2015-05-29 17:14:43,605][Test worker][DEBUG][CommonFacadeService] No need to publish AMQP message of transaction(VAT_UPLOAD_OFFLINESALE)
[2015-05-29 17:14:43,606][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/vat/OfflineVatUpload_Res.xml) by key(transtype.4451).
[2015-05-29 17:14:43,606][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.valueaddservice.vat.web.VatOfflineSaleUploadDto),mappingFile=xml-mapping/vat/OfflineVatUpload_Res.xml
[2015-05-29 17:14:43,606][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/vat/OfflineVatUpload_Res.xml) by key(transtype.4451).
[2015-05-29 17:14:43,606][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.valueaddservice.vat.web.VatOfflineSaleUploadDto, mappingFile=xml-mapping/vat/OfflineVatUpload_Res.xml).
[2015-05-29 17:14:43,606][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890883480|Timestamp:20150529171443|Transaction-Type:4451|Transaction-Id:0115052900000000002528|Response-Code:200|<?xml version="1.0" encoding="UTF-8"?>
<OfflineVatSale totalCount="4" success="3" failure="1"><VAT refNo="20140805002" code="505"/></OfflineVatSale>):68aaaf54dadbee6d9fcef9d0e730e444
[2015-05-29 17:14:43,607][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=204) succesfully.
[2015-05-29 17:14:43,607][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=204): <?xml version="1.0" encoding="UTF-8"?>
<OfflineVatSale totalCount="4" success="3" failure="1"><VAT refNo="20140805002" code="505"/></OfflineVatSale>
[2015-05-29 17:14:43,607][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/vat/OfflineVatUpload_Res.xml) by key(transtype.4451).
]]></system-out>
  <system-err><![CDATA[]]></system-err>
</testsuite>

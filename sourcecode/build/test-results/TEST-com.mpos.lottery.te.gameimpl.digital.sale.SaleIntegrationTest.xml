<?xml version="1.0" encoding="UTF-8"?>
<testsuite name="com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest" tests="18" skipped="0" failures="0" errors="0" timestamp="2015-05-29T09:12:59" hostname="Ramon-PC" time="2.298">
  <properties/>
  <testcase name="testSell_GameInstanceSuspendSale" classname="com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest" time="0.153"/>
  <testcase name="testSell_No_Sum_Supported" classname="com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest" time="0.093"/>
  <testcase name="testSell_ExceedMaxAllowedMultiDraw" classname="com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest" time="0.08"/>
  <testcase name="testSell_Single_QP_OK" classname="com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest" time="0.403"/>
  <testcase name="testSell_Single_ErrorSelectedNumber1" classname="com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest" time="0.096"/>
  <testcase name="testSell_Single_ErrorSelectedNumber2" classname="com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest" time="0.085"/>
  <testcase name="testSell_Single_ErrorSelectedNumber3" classname="com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest" time="0.078"/>
  <testcase name="testSell_AllBetOptions_OK" classname="com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest" time="0.328"/>
  <testcase name="testSell_Single_OK" classname="com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest" time="0.144"/>
  <testcase name="testSell_No_EvenOdd_Supported" classname="com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest" time="0.064"/>
  <testcase name="testSell_SUM_exceedMax" classname="com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest" time="0.057"/>
  <testcase name="testSell_TypeE_6D" classname="com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest" time="0.134"/>
  <testcase name="testSell_Single_OutOfRange1" classname="com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest" time="0.069"/>
  <testcase name="testSell_Single_OutOfRange2" classname="com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest" time="0.061"/>
  <testcase name="testSell_Zero_MulteDraw" classname="com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest" time="0.048"/>
  <testcase name="testEnquiryQP" classname="com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest" time="0.137"/>
  <testcase name="testSell_MultiDraw_OK" classname="com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest" time="0.18"/>
  <testcase name="testSell_Single_UnmatchedAmount" classname="com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest" time="0.075"/>
  <system-out><![CDATA[[2015-05-29 17:12:59,131][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:12:59,131][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:12:59,132][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@13b62ffe) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:12:59,132][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:12:59,133][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:12:59,133][Test worker][INFO ][BaseTransactionalIntegrationTest] | SaleIntegrationTest.testSell_GameInstanceSuspendSale                                                                   |
[2015-05-29 17:12:59,133][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:12:59,138][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:12:59,171][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket, mappingFile=xml-mapping/game/digital/SellTicket_Req.xml).
[2015-05-29 17:12:59,172][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779137|Timestamp:20150529171259|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=-810810231), get digest:b2aee0b75704af79b5a1fa5850016b88
[2015-05-29 17:12:59,172][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:12:59,172][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:12:59,172][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171259).
[2015-05-29 17:12:59,172][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:12:59,172][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890779137).
[2015-05-29 17:12:59,172][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:12:59,173][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:12:59,173][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=b2aee0b75704af79b5a1fa5850016b88).
[2015-05-29 17:12:59,173][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=7).
[2015-05-29 17:12:59,173][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:12:59,173][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:12:59,176][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9btrOyNtL8dAXOsCAt2VNz1Y3CyjizpWI1I8nQlwlEa8u3GnJdhPFqIwM+Go3KKjwWeZYUIZCCRGWj1yuQpJlzXfrBcB0y+SIx9BCcDqX9Cq9c2sM8doKNf2KfW5C60akmrLPtm4ds3wtET6JtIywgiNFKLcIdAG//+8JPC3fMLps3JnYw9/PChBNW4+JKSio1UkYGHWQMW8cZ8cWTDtVXm8ZINTl4bZYkVQl+v2xOSZWJfSo5PoTuCSV8U4FP7D/T6UDilZ4acW94+RrdCzF5xCwRJMMncqK4YeX8axPGnJNj8CfPsIS98AxpAtzOKg4eGW58K3qGmGJNAC9vxn2hqlnhCJ/guYLb6ysfRvd83y7AzPJ8taL+kqG6YmonjVwLMGX5NAyO1SNZJurVU7P5dRbgGIQtziq.
[2015-05-29 17:12:59,176][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779137|Timestamp:20150529171259|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:12:59,177][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>
[2015-05-29 17:12:59,177][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779137|Timestamp:20150529171259|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=-810810231), get digest:b2aee0b75704af79b5a1fa5850016b88
[2015-05-29 17:12:59,177][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:12:59,177][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/digital/SellTicket_Req.xml
[2015-05-29 17:12:59,178][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:12:59,204][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_1.5.0).
[2015-05-29 17:12:59,204][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_).
[2015-05-29 17:12:59,204][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(7_200_), found controller(com.mpos.lottery.te.gameimpl.digital.DigitalController@2c507c91) and method(public void com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:12:59,240][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.digital.game.DigitalGameInstance) by(number=11002,gameId=FD-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:12:59,249][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:12:59,249][Test worker][ERROR][AbstractGameInstanceService] The game instance(number=11002,game.type=7,status=2,startSellintTime=2015-05-28 17:12:15.0,stopSellTime=2015-05-30 17:12:15.0,suspendSale=true) doesn't accept sale.
[2015-05-29 17:12:59,249][Test worker][ERROR][TEPortServlet] Game instance has suspended sale.
com.mpos.lottery.te.config.exception.ApplicationException: Game instance has suspended sale.
	at com.mpos.lottery.te.gamespec.game.service.impl.AbstractGameInstanceService.allowSale(AbstractGameInstanceService.java:242)
	at com.mpos.lottery.te.gamespec.game.service.impl.AbstractGameInstanceService.doEnquiryMultiDraw(AbstractGameInstanceService.java:182)
	at com.mpos.lottery.te.gamespec.game.service.impl.AbstractGameInstanceService.enquirySaleReady(AbstractGameInstanceService.java:98)
	at sun.reflect.GeneratedMethodAccessor131.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy54.enquirySaleReady(Unknown Source)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.lookupSaleReadyGameInstance(AbstractTicketService.java:348)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:123)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(DigitalController.java:37)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest.testSell_GameInstanceSuspendSale(SaleIntegrationTest.java:638)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:12:59,254][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779137|Timestamp:20150529171259|Transaction-Type:4200|Transaction-Id:0115052900000000000097|Response-Code:310|):cb081142e41a1fc1857dfc75b57efb42
[2015-05-29 17:12:59,255][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=310,length=0): 
[2015-05-29 17:12:59,274][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:12:59,275][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:12:59,275][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@52a29236) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:12:59,276][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:12:59,276][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:12:59,276][Test worker][INFO ][BaseTransactionalIntegrationTest] | SaleIntegrationTest.testSell_No_Sum_Supported                                                                          |
[2015-05-29 17:12:59,276][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:12:59,280][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:12:59,281][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket, mappingFile=xml-mapping/game/digital/SellTicket_Req.xml).
[2015-05-29 17:12:59,282][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779280|Timestamp:20150529171259|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="24" betOption="-3" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=-1872710347), get digest:2ba8de8729371dac9f005ee221f8ea0f
[2015-05-29 17:12:59,283][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:12:59,283][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:12:59,283][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171259).
[2015-05-29 17:12:59,283][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:12:59,283][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890779280).
[2015-05-29 17:12:59,283][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:12:59,283][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:12:59,283][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=2ba8de8729371dac9f005ee221f8ea0f).
[2015-05-29 17:12:59,283][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=7).
[2015-05-29 17:12:59,284][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:12:59,284][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:12:59,286][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9btrOyNtL8dAXOsCAt2VNz1Y3CyjizpWI1I8nQlwlEa8u3GnJdhPFqIwM+Go3KKjwWeZYUIZCCRGWj1yuQpJlzXfrBcB0y+SIx9BCcDqX9CogUDoPZNvln3ToNbyI1bEiEXw8VVSN0wySSfA7p1S9luw+j+r0IgZpwrqqh05DH/QiEMqD6XQcCN8Kox/7JEdyTILi3PHGbyCG7asKSnpC/lvR5Z2uHc2SxaTZfeq3MNF0FJcNzYfTdeP/PUop1DG+4SOQMn4A6YXcPlP9O6/wtot/2+d0IS6p7rjSP3JwDyEGizRY1yTsy5Yd1TyLFXsbfqnIIz38Wlh4fa5IWk8ojDQuIruyjXZZero0eA6BawpyaLh0Ch6xcrM5+nzks0TtYsdYtMf06gHbFvIsBfSR8Q==.
[2015-05-29 17:12:59,286][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779280|Timestamp:20150529171259|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:12:59,287][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="24" betOption="-3" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>
[2015-05-29 17:12:59,287][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779280|Timestamp:20150529171259|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="24" betOption="-3" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=-1872710347), get digest:2ba8de8729371dac9f005ee221f8ea0f
[2015-05-29 17:12:59,287][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:12:59,287][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/digital/SellTicket_Req.xml
[2015-05-29 17:12:59,287][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:12:59,318][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_1.5.0).
[2015-05-29 17:12:59,318][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_).
[2015-05-29 17:12:59,319][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(7_200_), found controller(com.mpos.lottery.te.gameimpl.digital.DigitalController@2c507c91) and method(public void com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:12:59,330][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.digital.game.DigitalGameInstance) by(number=11002,gameId=FD-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:12:59,337][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:12:59,338][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745719200001885
[2015-05-29 17:12:59,346][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:12:59,347][Test worker][ERROR][TEPortServlet] SUM bet option are not supported
com.mpos.lottery.te.config.exception.ApplicationException: SUM bet option are not supported
	at com.mpos.lottery.te.gameimpl.digital.sale.support.DigitalSumSelectedNumberValidator.checkNumbers(DigitalSumSelectedNumberValidator.java:25)
	at com.mpos.lottery.te.gameimpl.digital.sale.support.DigitalXDSelectedNumberValidator.validate(DigitalXDSelectedNumberValidator.java:30)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validate(DefaultTicketValidator.java:42)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.validateTicketRequest(AbstractTicketService.java:386)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:140)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(DigitalController.java:37)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest.testSell_No_Sum_Supported(SaleIntegrationTest.java:601)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:12:59,351][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779280|Timestamp:20150529171259|Transaction-Type:4200|Transaction-Id:0115052900000000000098|Response-Code:306|):5ff71de206b3d512b42168db4ffa58fd
[2015-05-29 17:12:59,352][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=306,length=0): 
[2015-05-29 17:12:59,366][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:12:59,367][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:12:59,367][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@db9fd38) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:12:59,367][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:12:59,368][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:12:59,368][Test worker][INFO ][BaseTransactionalIntegrationTest] | SaleIntegrationTest.testSell_ExceedMaxAllowedMultiDraw                                                                 |
[2015-05-29 17:12:59,368][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:12:59,370][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:12:59,372][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket, mappingFile=xml-mapping/game/digital/SellTicket_Req.xml).
[2015-05-29 17:12:59,373][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779370|Timestamp:20150529171259|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=-953159502), get digest:de71176ffc515d550c1f983d5090aa3c
[2015-05-29 17:12:59,373][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:12:59,373][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:12:59,373][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171259).
[2015-05-29 17:12:59,373][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:12:59,373][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890779370).
[2015-05-29 17:12:59,373][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:12:59,374][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:12:59,374][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=de71176ffc515d550c1f983d5090aa3c).
[2015-05-29 17:12:59,374][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=7).
[2015-05-29 17:12:59,374][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:12:59,374][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:12:59,377][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9btrOyNtL8dAXOsCAt2VNz1Y3CyjizpWI1I8nQlwlEa8u3GnJdhPFqIwM+Go3KKjwWeZYUIZCCRGWj1yuQpJlzXfrBcB0y+SIx9BCcDqX9Cq9c2sM8doKNf2KfW5C60akmrLPtm4ds3wtET6JtIywgiNFKLcIdAG//+8JPC3fMLps3JnYw9/PChBNW4+JKSio1UkYGHWQMW8cZ8cWTDtVXm8ZINTl4bZYkVQl+v2xOSZWJfSo5PoTuCSV8U4FP7D/T6UDilZ4acW94+RrdCzF5xCwRJMMncqK4YeX8axPGnJNj8CfPsIS98AxpAtzOKg4eGW58K3qGmGJNAC9vxn2hqlnhCJ/guYLb6ysfRvd83y7AzPJ8taL+kqG6YmonjVwLMGX5NAyO1SNZJurVU7P5dRbgGIQtziq.
[2015-05-29 17:12:59,378][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779370|Timestamp:20150529171259|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:12:59,378][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>
[2015-05-29 17:12:59,379][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779370|Timestamp:20150529171259|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=-953159502), get digest:de71176ffc515d550c1f983d5090aa3c
[2015-05-29 17:12:59,379][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:12:59,379][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/digital/SellTicket_Req.xml
[2015-05-29 17:12:59,379][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:12:59,403][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_1.5.0).
[2015-05-29 17:12:59,403][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_).
[2015-05-29 17:12:59,403][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(7_200_), found controller(com.mpos.lottery.te.gameimpl.digital.DigitalController@2c507c91) and method(public void com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:12:59,413][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.digital.game.DigitalGameInstance) by(number=11002,gameId=FD-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:12:59,419][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:12:59,419][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745719200001982
[2015-05-29 17:12:59,427][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 1, merchant limit to 3, the smaller 1 will be used.
[2015-05-29 17:12:59,428][Test worker][ERROR][TEPortServlet] THe multiple draw[2] is not in range of allowed multiple-draws[1,1] of game(id=FD-1)
com.mpos.lottery.te.config.exception.ApplicationException: THe multiple draw[2] is not in range of allowed multiple-draws[1,1] of game(id=FD-1)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validateMaxAllowedMultipleDraw(DefaultTicketValidator.java:80)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validate(DefaultTicketValidator.java:32)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.validateTicketRequest(AbstractTicketService.java:386)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:140)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(DigitalController.java:37)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest.testSell_ExceedMaxAllowedMultiDraw(SaleIntegrationTest.java:251)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:12:59,432][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779370|Timestamp:20150529171259|Transaction-Type:4200|Transaction-Id:0115052900000000000099|Response-Code:280|):c6829c60adf5f835798df0fb89975a13
[2015-05-29 17:12:59,432][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=280,length=0): 
[2015-05-29 17:12:59,448][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:12:59,449][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:12:59,449][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@1d4b5721) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:12:59,449][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:12:59,450][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:12:59,450][Test worker][INFO ][BaseTransactionalIntegrationTest] | SaleIntegrationTest.testSell_Single_QP_OK                                                                              |
[2015-05-29 17:12:59,450][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:12:59,457][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:12:59,458][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket, mappingFile=xml-mapping/game/digital/SellTicket_Req.xml).
[2015-05-29 17:12:59,458][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779456|Timestamp:20150529171259|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry betOption="4" inputChannel="3" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=-2100449340), get digest:85d913da7ddae9f385ed27d90b7e8a75
[2015-05-29 17:12:59,459][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:12:59,459][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:12:59,459][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171259).
[2015-05-29 17:12:59,459][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:12:59,459][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890779456).
[2015-05-29 17:12:59,459][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:12:59,459][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:12:59,459][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=85d913da7ddae9f385ed27d90b7e8a75).
[2015-05-29 17:12:59,459][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=7).
[2015-05-29 17:12:59,460][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:12:59,460][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:12:59,462][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9btrOyNtL8dAXOsCAt2VNz1Y3CyjizpWI1I8nQlwlEa8u3GnJdhPFqIwM+Go3KKjwWeZYUIZCCRGWj1yuQpJlzWkKlssoMvLqd+qoFK6BaBLsq3u2zfv1WYWZ2d/6Ko/8yOmfeTYacokC+NujDS9bpefytjJokCyOksrKYkpWlF81ssiiSeXUrN7YRT7bnijWUIwdTkdWH3oa1n4YTLcEYjfkFMj9miNJ3NUHWAus0UhvO8JAGjlzykJHXVUTopYsEcjO0RNw1gVJR7hZz9XNBb/nzu7Yl+dY88lz71FZrIeV6tIJ15flCSdpXGuItcNXtoPrszSN1VABxAdj4firWve5WviPvtpSr4kDBIY02bBg14AxxXro2aK0l12KXXsN.
[2015-05-29 17:12:59,462][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779456|Timestamp:20150529171259|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:12:59,462][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry betOption="4" inputChannel="3" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>
[2015-05-29 17:12:59,463][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779456|Timestamp:20150529171259|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry betOption="4" inputChannel="3" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=-2100449340), get digest:85d913da7ddae9f385ed27d90b7e8a75
[2015-05-29 17:12:59,463][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:12:59,463][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/digital/SellTicket_Req.xml
[2015-05-29 17:12:59,463][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:12:59,478][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_1.5.0).
[2015-05-29 17:12:59,478][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_).
[2015-05-29 17:12:59,478][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(7_200_), found controller(com.mpos.lottery.te.gameimpl.digital.DigitalController@2c507c91) and method(public void com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:12:59,488][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.digital.game.DigitalGameInstance) by(number=11002,gameId=FD-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:12:59,494][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:12:59,494][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745719200002097
[2015-05-29 17:12:59,518][Test worker][DEBUG][JpaDigitalStatOfSelectedNumberDao] Total 40 StatOfSelectedNumber entities found(gameInstanceId=GII-112).
[2015-05-29 17:12:59,520][Test worker][DEBUG][DigitalSaleService] 90% of total 10 of position[4] will be put in QP sample, 7 is picked.
[2015-05-29 17:12:59,520][Test worker][DEBUG][DigitalSaleService] 90% of total 10 of position[3] will be put in QP sample, 3 is picked.
[2015-05-29 17:12:59,520][Test worker][DEBUG][DigitalSaleService] 90% of total 10 of position[2] will be put in QP sample, 1 is picked.
[2015-05-29 17:12:59,520][Test worker][DEBUG][DigitalSaleService] 90% of total 10 of position[1] will be put in QP sample, 8 is picked.
[2015-05-29 17:12:59,520][Test worker][DEBUG][DigitalSaleService] Generate QP number:7,3,1,8 of game instance(id=GII-112).
[2015-05-29 17:12:59,524][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:12:59,529][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu6hO4wThnaXV2kq+JMAmYOU) as 150000
[2015-05-29 17:12:59,589][Test worker][DEBUG][DigitalRiskControlService] There total 1 possible prize levels found, determine the final loss amount of prize level as 150000.00=150000/1
[2015-05-29 17:12:59,589][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=41, bettingNumber=null]
[2015-05-29 17:12:59,590][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,3,1,8, amount=60.0) is 50
[2015-05-29 17:12:59,614][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu6hO4wThnaXV2kq+JMAmYOU) as 150000
[2015-05-29 17:12:59,627][Test worker][DEBUG][DigitalRiskControlService] There total 1 possible prize levels found, determine the final loss amount of prize level as 150000.00=150000/1
[2015-05-29 17:12:59,627][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=-3, bettingNumber=25]
[2015-05-29 17:12:59,627][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(25, amount=140.0) is 50
[2015-05-29 17:12:59,646][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu6hO4wThnaXV2kq+JMAmYOU) as 150000
[2015-05-29 17:12:59,657][Test worker][DEBUG][DigitalRiskControlService] There total 1 possible prize levels found, determine the final loss amount of prize level as 150000.00=150000/1
[2015-05-29 17:12:59,657][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=41, bettingNumber=null]
[2015-05-29 17:12:59,657][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,3,1,8, amount=60.0) is 50
[2015-05-29 17:12:59,675][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu6hO4wThnaXV2kq+JMAmYOU) as 150000
[2015-05-29 17:12:59,685][Test worker][DEBUG][DigitalRiskControlService] There total 1 possible prize levels found, determine the final loss amount of prize level as 150000.00=150000/1
[2015-05-29 17:12:59,685][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=-3, bettingNumber=25]
[2015-05-29 17:12:59,685][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(25, amount=140.0) is 50
[2015-05-29 17:12:59,722][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:12:59,723][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:12:59,723][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199999600.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:12:59,731][Test worker][WARN ][BaseJpaDao] Should be at most only 1 entity(com.mpos.lottery.te.merchant.domain.OperatorCommission) found, however total 2 entities found... the 1st entity(com.mpos.lottery.te.merchant.domain.OperatorCommission@780bfb81) will be returned.
[2015-05-29 17:12:59,749][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.7]: transaction {
  id: "0115052900000000000100"
  dev_id: "111"
  operator_id: "OPERATOR-111"
  merchant_id: "111"
  create_time: 1432890779000
  trans_type: 200
  game_id: "FD-1"
  game_type: 7
  total_amount: "400.0"
}
multi_draw: 2
total_amount: "400.0"
serial_no: "aHhDkgTyIu6hO4wThnaXV2kq+JMAmYOU"
game_instance {
  id: "GII-112"
}
entries {
  selected_number: "7,3,1,8"
  bet_option: 4
  total_bets: 1
  entry_amount: "60.0"
  input_channel: "3"
}
entries {
  selected_number: "25"
  bet_option: -3
  total_bets: 1
  entry_amount: "140.0"
  input_channel: "2"
}

[2015-05-29 17:12:59,750][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:12:59,750][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Res.xml) by key(7.transtype.4200).
[2015-05-29 17:12:59,750][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket),mappingFile=xml-mapping/game/digital/SellTicket_Res.xml
[2015-05-29 17:12:59,750][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Res.xml) by key(7.transtype.4200).
[2015-05-29 17:12:59,778][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket, mappingFile=xml-mapping/game/digital/SellTicket_Res.xml).
[2015-05-29 17:12:59,779][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779456|Timestamp:20150529171259|Transaction-Type:4200|Transaction-Id:0115052900000000000100|Response-Code:200|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01110745719200002097" type="1" lastDrawNo="11003" barcode="07cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcl/TymwzZd571UC9rYPX07E=" validationCode="426081" multipleDraws="2" totalBets="4" totalAmount="400.0"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="7,3,1,8" betOption="4" inputChannel="3" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/></Ticket>):70bceedad304966e4da934c73eacc23e
[2015-05-29 17:12:59,780][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=652) succesfully.
[2015-05-29 17:12:59,780][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=652): <?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01110745719200002097" type="1" lastDrawNo="11003" barcode="07cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcl/TymwzZd571UC9rYPX07E=" validationCode="426081" multipleDraws="2" totalBets="4" totalAmount="400.0"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="7,3,1,8" betOption="4" inputChannel="3" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/></Ticket>
[2015-05-29 17:12:59,780][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Res.xml) by key(7.transtype.4200).
[2015-05-29 17:12:59,853][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:12:59,854][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:12:59,854][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@6f8f89ca) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:12:59,855][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:12:59,855][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:12:59,855][Test worker][INFO ][BaseTransactionalIntegrationTest] | SaleIntegrationTest.testSell_Single_ErrorSelectedNumber1                                                               |
[2015-05-29 17:12:59,855][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:12:59,856][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:12:59,858][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket, mappingFile=xml-mapping/game/digital/SellTicket_Req.xml).
[2015-05-29 17:12:59,859][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779856|Timestamp:20150529171259|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,1,2" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=1342392375), get digest:5548f226aced3784fbbb19ddc93c2b87
[2015-05-29 17:12:59,859][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:12:59,859][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:12:59,859][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171259).
[2015-05-29 17:12:59,859][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:12:59,859][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890779856).
[2015-05-29 17:12:59,860][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:12:59,860][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:12:59,860][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=5548f226aced3784fbbb19ddc93c2b87).
[2015-05-29 17:12:59,860][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=7).
[2015-05-29 17:12:59,860][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:12:59,860][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:12:59,865][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9btrOyNtL8dAXOsCAt2VNz1Y3CyjizpWI1I8nQlwlEa8u3GnJdhPFqIwM+Go3KKjwWeZYUIZCCRGWj1yuQpJlzXfrBcB0y+SIx9BCcDqX9Cq9c2sM8doKNe3ZwdFSR5qGkGqX+bmN/fm/m/v4o6nPpzZnvhf4fnoPEb1/ACmJErH+yV/LWrqOamBoDlwb8jZPEHo8y/rtkSU0MmHSPj6HIo1wE75DiyNbA4pUeLx220f3js6R6LWe+8gV53oBPp6OymTdtK0BknxEIrALsMkDr49IfSl3AqVXhqThMHvb14hPbV9SPw43ZokNGwzUtEd1Nr8IQlcPpR/OEqe1OVdHdp2oxhp+N7PnHUycwKMnh9+8FFQiEdRGb0C/s/crEAxsn5cpDFtLM4u+MB/pOwqhKQ==.
[2015-05-29 17:12:59,865][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779856|Timestamp:20150529171259|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:12:59,865][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,1,2" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>
[2015-05-29 17:12:59,866][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779856|Timestamp:20150529171259|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,1,2" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=1342392375), get digest:5548f226aced3784fbbb19ddc93c2b87
[2015-05-29 17:12:59,866][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:12:59,867][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/digital/SellTicket_Req.xml
[2015-05-29 17:12:59,867][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:12:59,896][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_1.5.0).
[2015-05-29 17:12:59,896][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_).
[2015-05-29 17:12:59,897][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(7_200_), found controller(com.mpos.lottery.te.gameimpl.digital.DigitalController@2c507c91) and method(public void com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:12:59,908][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.digital.game.DigitalGameInstance) by(number=11002,gameId=FD-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:12:59,915][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:12:59,915][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745719200002165
[2015-05-29 17:12:59,927][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:12:59,928][Test worker][ERROR][TEPortServlet] The selected number(0,1,2) of bet option(4) of ticket(serialNo=aHhDkgTyIu6hO4wThnaXV5bDjmqBMmUZ) is not match to '^\d+,\d+,\d+,\d+$'.
com.mpos.lottery.te.config.exception.SystemException: The selected number(0,1,2) of bet option(4) of ticket(serialNo=aHhDkgTyIu6hO4wThnaXV5bDjmqBMmUZ) is not match to '^\d+,\d+,\d+,\d+$'.
	at com.mpos.lottery.te.gameimpl.digital.sale.support.DigitalXDSelectedNumberValidator.validate(DigitalXDSelectedNumberValidator.java:25)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validate(DefaultTicketValidator.java:42)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.validateTicketRequest(AbstractTicketService.java:386)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:140)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(DigitalController.java:37)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest.testSell_Single_ErrorSelectedNumber1(SaleIntegrationTest.java:457)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:12:59,932][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779856|Timestamp:20150529171259|Transaction-Type:4200|Transaction-Id:0115052900000000000109|Response-Code:305|):8f6fbf72797927dd4c4e54e889d2c451
[2015-05-29 17:12:59,932][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=305,length=0): 
[2015-05-29 17:12:59,953][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:12:59,954][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:12:59,954][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@cd402e3) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:12:59,954][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:12:59,955][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:12:59,955][Test worker][INFO ][BaseTransactionalIntegrationTest] | SaleIntegrationTest.testSell_Single_ErrorSelectedNumber2                                                               |
[2015-05-29 17:12:59,955][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:12:59,956][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:12:59,958][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket, mappingFile=xml-mapping/game/digital/SellTicket_Req.xml).
[2015-05-29 17:12:59,959][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779955|Timestamp:20150529171259|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,11,2,4" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=369445594), get digest:9f3ff6f7d092a5b274b5555d9633a649
[2015-05-29 17:12:59,959][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:12:59,960][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:12:59,960][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171259).
[2015-05-29 17:12:59,960][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:12:59,960][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890779955).
[2015-05-29 17:12:59,960][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:12:59,960][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:12:59,960][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=9f3ff6f7d092a5b274b5555d9633a649).
[2015-05-29 17:12:59,960][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=7).
[2015-05-29 17:12:59,960][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:12:59,961][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:12:59,965][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9btrOyNtL8dAXOsCAt2VNz1Y3CyjizpWI1I8nQlwlEa8u3GnJdhPFqIwM+Go3KKjwWeZYUIZCCRGWj1yuQpJlzXfrBcB0y+SIx9BCcDqX9Cq9c2sM8doKNf8d4EaYnDyvNoqLBJ+Lu52KZgvPqxUov4fNU4bxKjzZNn4JV1F0/ji0236bbhxOBI+ZE1atSnffcO2TwAb/lLBkpgui8sG2corB7PRa5g8wtgE4xt9w9MKtdjuhL1XtBT+nHviNA7N0tcDtf0Yssb81ltvguRCWgv2J3hvdOUHGthuIcUTfcddp0/TpiU4B+MlroDqgEbmrNkrQyxGMtR/8VgPDQz6ZoJajxSddnBP7i1jaoHcVMM2hvK4oJ/Zno9Np0L8uZZDF6zfuw/yiNbOiwVXlOsY93jpLD/Fxw+Ys.
[2015-05-29 17:12:59,965][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779955|Timestamp:20150529171259|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:12:59,966][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,11,2,4" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>
[2015-05-29 17:12:59,966][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779955|Timestamp:20150529171259|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,11,2,4" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=369445594), get digest:9f3ff6f7d092a5b274b5555d9633a649
[2015-05-29 17:12:59,966][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:12:59,966][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/digital/SellTicket_Req.xml
[2015-05-29 17:12:59,966][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:12:59,994][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_1.5.0).
[2015-05-29 17:12:59,994][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_).
[2015-05-29 17:12:59,994][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(7_200_), found controller(com.mpos.lottery.te.gameimpl.digital.DigitalController@2c507c91) and method(public void com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:00,000][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.digital.game.DigitalGameInstance) by(number=11002,gameId=FD-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:00,004][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:00,004][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745719300002244
[2015-05-29 17:13:00,011][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:00,012][Test worker][ERROR][TEPortServlet] The number of single selected number(0,11,2,4) must be in range of (0,9)
com.mpos.lottery.te.config.exception.SystemException: The number of single selected number(0,11,2,4) must be in range of (0,9)
	at com.mpos.lottery.te.gameimpl.digital.sale.support.DigitalXDSelectedNumberValidator.checkRangeOfNumber(DigitalXDSelectedNumberValidator.java:61)
	at com.mpos.lottery.te.gameimpl.digital.sale.support.DigitalXDSelectedNumberValidator.checkNumbers(DigitalXDSelectedNumberValidator.java:54)
	at com.mpos.lottery.te.gameimpl.digital.sale.support.DigitalXDSelectedNumberValidator.validate(DigitalXDSelectedNumberValidator.java:30)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validate(DefaultTicketValidator.java:42)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.validateTicketRequest(AbstractTicketService.java:386)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:140)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(DigitalController.java:37)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest.testSell_Single_ErrorSelectedNumber2(SaleIntegrationTest.java:475)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:00,016][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890779955|Timestamp:20150529171259|Transaction-Type:4200|Transaction-Id:0115052900000000000110|Response-Code:305|):3525ac2c698697407160b266ca9753e6
[2015-05-29 17:13:00,016][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=305,length=0): 
[2015-05-29 17:13:00,038][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:00,038][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:00,039][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@6e8378c2) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:00,039][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:00,039][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:00,040][Test worker][INFO ][BaseTransactionalIntegrationTest] | SaleIntegrationTest.testSell_Single_ErrorSelectedNumber3                                                               |
[2015-05-29 17:13:00,040][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:00,040][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,042][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket, mappingFile=xml-mapping/game/digital/SellTicket_Req.xml).
[2015-05-29 17:13:00,043][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780040|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="even" betOption="-2" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=-513860659), get digest:19798e0c53422b55778b8876a8fc2844
[2015-05-29 17:13:00,043][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:00,043][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:00,043][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171300).
[2015-05-29 17:13:00,043][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:00,043][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890780040).
[2015-05-29 17:13:00,043][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:00,043][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:00,044][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=19798e0c53422b55778b8876a8fc2844).
[2015-05-29 17:13:00,044][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=7).
[2015-05-29 17:13:00,044][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:00,044][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:00,046][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9btrOyNtL8dAXOsCAt2VNz1Y3CyjizpWI1I8nQlwlEa8u3GnJdhPFqIwM+Go3KKjwWeZYUIZCCRGWj1yuQpJlzXfrBcB0y+SIx9BCcDqX9CrucGpRjJp0iTR5CrDxISZ6LK2TfeDzVMluC64tbcBR2KXwVbw9jRUrsK/SU4GstxxzJbNwISLxtNwYV+7nM+oqEG9BQsaD4ePzzn8bG3ggmbcu/XCAiTUnOxpSC9xr7WbLgZrkC2uAhqWqep3B2Kve6bBUrVf1JJfhi2kYFQEQ0nj5QDFTrp+0sVcHzOaAGQ1dG2fUcQOkGjdTCSPqLPDhZ2u1NM1iqIMXTteX2+q5y3FYtSyo+bQZn991RduEjeWbV93qDOhiEAZ7utSsGGyIxjfBW0pRQ2d+ULfBgcWl6w==.
[2015-05-29 17:13:00,046][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780040|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:00,047][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="even" betOption="-2" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>
[2015-05-29 17:13:00,047][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780040|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="even" betOption="-2" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=-513860659), get digest:19798e0c53422b55778b8876a8fc2844
[2015-05-29 17:13:00,047][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,047][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/digital/SellTicket_Req.xml
[2015-05-29 17:13:00,047][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,066][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_1.5.0).
[2015-05-29 17:13:00,067][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_).
[2015-05-29 17:13:00,067][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(7_200_), found controller(com.mpos.lottery.te.gameimpl.digital.DigitalController@2c507c91) and method(public void com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:00,073][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.digital.game.DigitalGameInstance) by(number=11002,gameId=FD-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:00,080][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:00,080][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745719300002332
[2015-05-29 17:13:00,089][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:00,090][Test worker][ERROR][TEPortServlet] The selected number(even) of bet option(-2) of ticket(serialNo=aHhDkgTyIu50A2BrZKmpP4WdZOt+3q3E) is not match to 'EVEN'.
com.mpos.lottery.te.config.exception.SystemException: The selected number(even) of bet option(-2) of ticket(serialNo=aHhDkgTyIu50A2BrZKmpP4WdZOt+3q3E) is not match to 'EVEN'.
	at com.mpos.lottery.te.gameimpl.digital.sale.support.DigitalXDSelectedNumberValidator.validate(DigitalXDSelectedNumberValidator.java:25)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validate(DefaultTicketValidator.java:42)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.validateTicketRequest(AbstractTicketService.java:386)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:140)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(DigitalController.java:37)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest.testSell_Single_ErrorSelectedNumber3(SaleIntegrationTest.java:494)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:00,093][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780040|Timestamp:20150529171300|Transaction-Type:4200|Transaction-Id:0115052900000000000111|Response-Code:305|):59ebac78b4dbfde587b99414bcac2e4c
[2015-05-29 17:13:00,093][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=305,length=0): 
[2015-05-29 17:13:00,114][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:00,115][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:00,115][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@680ad9e5) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:00,115][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:00,116][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:00,116][Test worker][INFO ][BaseTransactionalIntegrationTest] | SaleIntegrationTest.testSell_AllBetOptions_OK                                                                          |
[2015-05-29 17:13:00,116][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:00,116][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,118][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket, mappingFile=xml-mapping/game/digital/SellTicket_Req.xml).
[2015-05-29 17:13:00,119][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780116|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="1200" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="00,03,02,08" betOption="4" inputChannel="2" entryAmount="100"/><Entry selectedNumber="9,03,00" betOption="3" inputChannel="2" entryAmount="100"/><Entry selectedNumber="9,03" betOption="2" inputChannel="2" entryAmount="90"/><Entry selectedNumber="09" betOption="1" inputChannel="2" entryAmount="110"/><Entry selectedNumber="EVEN" betOption="-2" inputChannel="2" entryAmount="80"/><Entry selectedNumber="ODD" betOption="-1" inputChannel="2" entryAmount="120"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=526677699), get digest:7479741a3f98ac50ea5c6ad701fd9404
[2015-05-29 17:13:00,119][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:00,120][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:00,120][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171300).
[2015-05-29 17:13:00,120][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:00,120][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890780116).
[2015-05-29 17:13:00,120][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:00,120][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:00,120][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=7479741a3f98ac50ea5c6ad701fd9404).
[2015-05-29 17:13:00,120][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=7).
[2015-05-29 17:13:00,120][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:00,120][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:00,124][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg928b2RPFNgStFN41nZE2uukXvlnBCQI9CNOJG0+G2dCo+nHThf2Xp9yc11Z2hzTIe3YooI/7A/tngoql8B2Ot4XJYNVlB/fuPrg0AVkGreRdeI6VhN4uLvr3HhN34zK+aFLICruL4+S1bgLqqUQDOlY4PjUCCJUW8/D2VC/dVr7qfGcO2KBFxDGBSNRGx1PxhykX42Rn7M8YHNL3Qk5squiLo/igRO+Q3v+lOvwp3HOhi7VejgwHrn+shsyKqKJmrx03RM0EppYJl/DhYznwXvFsfqFmEX1a3AaABCMlsFU8YAktmg4EJa/W/GXlk987SYOi4jXKBUT9EGnIJRyP/p8+3LPvtf9LNs6ECyKSPOWZLFhYDZjOPIQ6oLUu99TCRZJXbPcuSznGO2V+yL8aB7obvJhP6gslq22ZnNyuVVAJ52cKeQqXe2ibyxlAlAszs2nwikuc/2S6Y5+IlcyCNlUjTuY5KSX8zhiRhjZ/BMsguEWrtXcCfyjeB0St99QKUIqXaKFTcK3NzzHJyBPl+7u4RdieXMrm4xrDTzl/cDKEomCBe5BAFyfHI52dWCfVs3rnZ1JRKbg78BVc7tyNprJQKStAac0SxTmIuy7buk9pGSLpmJUB8zcGBEnTDF5OssLtKwm+c07R42EcU4s7iiXsF4B2J0/O2NDy9aizQGMm3kjopL23otYOGRNI4VMh+6N5hfuK02zpdt5xi3OFJviSCh9iwAPAlqUTLYBQ047V9zCbtR0gm0KVYbxlglF1GC7LaMZW9UxCRcB/EaW8jfuItUaq+tAYo/lVA7wKydNbRZDwnSVoTgvjDCkx13T76.
[2015-05-29 17:13:00,124][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780116|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:00,125][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="1200" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="00,03,02,08" betOption="4" inputChannel="2" entryAmount="100"/><Entry selectedNumber="9,03,00" betOption="3" inputChannel="2" entryAmount="100"/><Entry selectedNumber="9,03" betOption="2" inputChannel="2" entryAmount="90"/><Entry selectedNumber="09" betOption="1" inputChannel="2" entryAmount="110"/><Entry selectedNumber="EVEN" betOption="-2" inputChannel="2" entryAmount="80"/><Entry selectedNumber="ODD" betOption="-1" inputChannel="2" entryAmount="120"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>
[2015-05-29 17:13:00,125][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780116|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="1200" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="00,03,02,08" betOption="4" inputChannel="2" entryAmount="100"/><Entry selectedNumber="9,03,00" betOption="3" inputChannel="2" entryAmount="100"/><Entry selectedNumber="9,03" betOption="2" inputChannel="2" entryAmount="90"/><Entry selectedNumber="09" betOption="1" inputChannel="2" entryAmount="110"/><Entry selectedNumber="EVEN" betOption="-2" inputChannel="2" entryAmount="80"/><Entry selectedNumber="ODD" betOption="-1" inputChannel="2" entryAmount="120"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=526677699), get digest:7479741a3f98ac50ea5c6ad701fd9404
[2015-05-29 17:13:00,125][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,125][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/digital/SellTicket_Req.xml
[2015-05-29 17:13:00,126][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,144][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_1.5.0).
[2015-05-29 17:13:00,144][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_).
[2015-05-29 17:13:00,144][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(7_200_), found controller(com.mpos.lottery.te.gameimpl.digital.DigitalController@2c507c91) and method(public void com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:00,149][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.digital.game.DigitalGameInstance) by(number=11002,gameId=FD-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:00,154][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:00,155][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745719300002464
[2015-05-29 17:13:00,161][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:00,165][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu50A2BrZKmpP2l8oTsWg/Gp) as 150000
[2015-05-29 17:13:00,172][Test worker][DEBUG][DigitalRiskControlService] There total 1 possible prize levels found, determine the final loss amount of prize level as 150000.00=150000/1
[2015-05-29 17:13:00,172][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=41, bettingNumber=null]
[2015-05-29 17:13:00,172][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(0,3,2,8, amount=100) is 50
[2015-05-29 17:13:00,181][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu50A2BrZKmpP2l8oTsWg/Gp) as 150000
[2015-05-29 17:13:00,185][Test worker][DEBUG][DigitalRiskControlService] There total 2 possible prize levels found, determine the final loss amount of prize level as 75000.00=150000/2
[2015-05-29 17:13:00,185][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=32, bettingNumber=null]
[2015-05-29 17:13:00,185][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(9,3,0, amount=100) is 30
[2015-05-29 17:13:00,192][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=31, bettingNumber=null]
[2015-05-29 17:13:00,192][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(9,3,0, amount=100) is 30
[2015-05-29 17:13:00,201][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu50A2BrZKmpP2l8oTsWg/Gp) as 150000
[2015-05-29 17:13:00,205][Test worker][DEBUG][DigitalRiskControlService] There total 2 possible prize levels found, determine the final loss amount of prize level as 75000.00=150000/2
[2015-05-29 17:13:00,205][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=20, prizelLevelType=22, bettingNumber=null]
[2015-05-29 17:13:00,205][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(9,3, amount=90) is 20
[2015-05-29 17:13:00,213][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=20, prizelLevelType=21, bettingNumber=null]
[2015-05-29 17:13:00,213][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(9,3, amount=90) is 20
[2015-05-29 17:13:00,222][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu50A2BrZKmpP2l8oTsWg/Gp) as 150000
[2015-05-29 17:13:00,225][Test worker][DEBUG][DigitalRiskControlService] There total 2 possible prize levels found, determine the final loss amount of prize level as 75000.00=150000/2
[2015-05-29 17:13:00,225][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=10, prizelLevelType=12, bettingNumber=null]
[2015-05-29 17:13:00,225][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(9, amount=110) is 10
[2015-05-29 17:13:00,234][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=10, prizelLevelType=11, bettingNumber=null]
[2015-05-29 17:13:00,234][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(9, amount=110) is 10
[2015-05-29 17:13:00,242][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu50A2BrZKmpP2l8oTsWg/Gp) as 150000
[2015-05-29 17:13:00,246][Test worker][DEBUG][DigitalRiskControlService] There total 1 possible prize levels found, determine the final loss amount of prize level as 150000.00=150000/1
[2015-05-29 17:13:00,246][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=25, prizelLevelType=-2, bettingNumber=null]
[2015-05-29 17:13:00,246][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(EVEN, amount=80) is 25
[2015-05-29 17:13:00,255][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu50A2BrZKmpP2l8oTsWg/Gp) as 150000
[2015-05-29 17:13:00,260][Test worker][DEBUG][DigitalRiskControlService] There total 1 possible prize levels found, determine the final loss amount of prize level as 150000.00=150000/1
[2015-05-29 17:13:00,260][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=15, prizelLevelType=-1, bettingNumber=null]
[2015-05-29 17:13:00,260][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(ODD, amount=120) is 15
[2015-05-29 17:13:00,270][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu50A2BrZKmpP2l8oTsWg/Gp) as 150000
[2015-05-29 17:13:00,276][Test worker][DEBUG][DigitalRiskControlService] There total 1 possible prize levels found, determine the final loss amount of prize level as 150000.00=150000/1
[2015-05-29 17:13:00,276][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=41, bettingNumber=null]
[2015-05-29 17:13:00,276][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(0,3,2,8, amount=100) is 50
[2015-05-29 17:13:00,283][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu50A2BrZKmpP2l8oTsWg/Gp) as 150000
[2015-05-29 17:13:00,287][Test worker][DEBUG][DigitalRiskControlService] There total 2 possible prize levels found, determine the final loss amount of prize level as 75000.00=150000/2
[2015-05-29 17:13:00,287][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=32, bettingNumber=null]
[2015-05-29 17:13:00,287][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(9,3,0, amount=100) is 30
[2015-05-29 17:13:00,294][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=31, bettingNumber=null]
[2015-05-29 17:13:00,294][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(9,3,0, amount=100) is 30
[2015-05-29 17:13:00,302][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu50A2BrZKmpP2l8oTsWg/Gp) as 150000
[2015-05-29 17:13:00,306][Test worker][DEBUG][DigitalRiskControlService] There total 2 possible prize levels found, determine the final loss amount of prize level as 75000.00=150000/2
[2015-05-29 17:13:00,306][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=20, prizelLevelType=22, bettingNumber=null]
[2015-05-29 17:13:00,306][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(9,3, amount=90) is 20
[2015-05-29 17:13:00,314][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=20, prizelLevelType=21, bettingNumber=null]
[2015-05-29 17:13:00,314][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(9,3, amount=90) is 20
[2015-05-29 17:13:00,322][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu50A2BrZKmpP2l8oTsWg/Gp) as 150000
[2015-05-29 17:13:00,326][Test worker][DEBUG][DigitalRiskControlService] There total 2 possible prize levels found, determine the final loss amount of prize level as 75000.00=150000/2
[2015-05-29 17:13:00,327][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=10, prizelLevelType=12, bettingNumber=null]
[2015-05-29 17:13:00,327][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(9, amount=110) is 10
[2015-05-29 17:13:00,335][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=10, prizelLevelType=11, bettingNumber=null]
[2015-05-29 17:13:00,336][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(9, amount=110) is 10
[2015-05-29 17:13:00,344][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu50A2BrZKmpP2l8oTsWg/Gp) as 150000
[2015-05-29 17:13:00,347][Test worker][DEBUG][DigitalRiskControlService] There total 1 possible prize levels found, determine the final loss amount of prize level as 150000.00=150000/1
[2015-05-29 17:13:00,348][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=25, prizelLevelType=-2, bettingNumber=null]
[2015-05-29 17:13:00,348][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(EVEN, amount=80) is 25
[2015-05-29 17:13:00,355][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu50A2BrZKmpP2l8oTsWg/Gp) as 150000
[2015-05-29 17:13:00,358][Test worker][DEBUG][DigitalRiskControlService] There total 1 possible prize levels found, determine the final loss amount of prize level as 150000.00=150000/1
[2015-05-29 17:13:00,359][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=15, prizelLevelType=-1, bettingNumber=null]
[2015-05-29 17:13:00,359][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(ODD, amount=120) is 15
[2015-05-29 17:13:00,391][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:00,391][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:00,391][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199998800, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:00,397][Test worker][WARN ][BaseJpaDao] Should be at most only 1 entity(com.mpos.lottery.te.merchant.domain.OperatorCommission) found, however total 2 entities found... the 1st entity(com.mpos.lottery.te.merchant.domain.OperatorCommission@3c318d83) will be returned.
[2015-05-29 17:13:00,414][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.7]: transaction {
  id: "0115052900000000000112"
  dev_id: "111"
  operator_id: "OPERATOR-111"
  merchant_id: "111"
  create_time: 1432890780000
  trans_type: 200
  game_id: "FD-1"
  game_type: 7
  total_amount: "1200"
}
multi_draw: 2
total_amount: "1200"
serial_no: "aHhDkgTyIu50A2BrZKmpP2l8oTsWg/Gp"
game_instance {
  id: "GII-112"
}
entries {
  selected_number: "0,3,2,8"
  bet_option: 4
  total_bets: 1
  entry_amount: "100"
  input_channel: "2"
}
entries {
  selected_number: "9,3,0"
  bet_option: 3
  total_bets: 1
  entry_amount: "100"
  input_channel: "2"
}
entries {
  selected_number: "9,3"
  bet_option: 2
  total_bets: 1
  entry_amount: "90"
  input_channel: "2"
}
entries {
  selected_number: "9"
  bet_option: 1
  total_bets: 1
  entry_amount: "110"
  input_channel: "2"
}
entries {
  selected_number: "EVEN"
  bet_option: -2
  total_bets: 1
  entry_amount: "80"
  input_channel: "2"
}
entries {
  selected_number: "ODD"
  bet_option: -1
  total_bets: 1
  entry_amount: "120"
  input_channel: "2"
}

[2015-05-29 17:13:00,415][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:00,415][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Res.xml) by key(7.transtype.4200).
[2015-05-29 17:13:00,415][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket),mappingFile=xml-mapping/game/digital/SellTicket_Res.xml
[2015-05-29 17:13:00,415][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Res.xml) by key(7.transtype.4200).
[2015-05-29 17:13:00,417][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket, mappingFile=xml-mapping/game/digital/SellTicket_Res.xml).
[2015-05-29 17:13:00,418][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780116|Timestamp:20150529171300|Transaction-Type:4200|Transaction-Id:0115052900000000000112|Response-Code:200|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01110745719300002464" type="1" lastDrawNo="11003" barcode="07cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcp3InwF+WYqVmBAmTRC3Fts=" validationCode="897304" multipleDraws="2" totalBets="12" totalAmount="1200"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="100"/><Entry selectedNumber="9,3,0" betOption="3" inputChannel="2" entryAmount="100"/><Entry selectedNumber="9,3" betOption="2" inputChannel="2" entryAmount="90"/><Entry selectedNumber="9" betOption="1" inputChannel="2" entryAmount="110"/><Entry selectedNumber="EVEN" betOption="-2" inputChannel="2" entryAmount="80"/><Entry selectedNumber="ODD" betOption="-1" inputChannel="2" entryAmount="120"/></Ticket>):48b694959ebefe636b9e5cc783c13952
[2015-05-29 17:13:00,419][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=1068) succesfully.
[2015-05-29 17:13:00,419][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=1068): <?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01110745719300002464" type="1" lastDrawNo="11003" barcode="07cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcp3InwF+WYqVmBAmTRC3Fts=" validationCode="897304" multipleDraws="2" totalBets="12" totalAmount="1200"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="100"/><Entry selectedNumber="9,3,0" betOption="3" inputChannel="2" entryAmount="100"/><Entry selectedNumber="9,3" betOption="2" inputChannel="2" entryAmount="90"/><Entry selectedNumber="9" betOption="1" inputChannel="2" entryAmount="110"/><Entry selectedNumber="EVEN" betOption="-2" inputChannel="2" entryAmount="80"/><Entry selectedNumber="ODD" betOption="-1" inputChannel="2" entryAmount="120"/></Ticket>
[2015-05-29 17:13:00,419][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Res.xml) by key(7.transtype.4200).
[2015-05-29 17:13:00,442][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:00,442][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:00,443][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@6cbf6255) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:00,443][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:00,443][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:00,444][Test worker][INFO ][BaseTransactionalIntegrationTest] | SaleIntegrationTest.testSell_Single_OK                                                                                 |
[2015-05-29 17:13:00,444][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:00,448][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,449][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket, mappingFile=xml-mapping/game/digital/SellTicket_Req.xml).
[2015-05-29 17:13:00,450][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780448|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="1" totalAmount="200.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=617809526), get digest:6c914039dca36a4e4f40d30441fdf681
[2015-05-29 17:13:00,450][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:00,450][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:00,450][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171300).
[2015-05-29 17:13:00,450][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:00,450][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890780448).
[2015-05-29 17:13:00,450][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:00,450][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:00,450][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=6c914039dca36a4e4f40d30441fdf681).
[2015-05-29 17:13:00,450][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=7).
[2015-05-29 17:13:00,451][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:00,451][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:00,453][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfnfSvzUuvi5gIW+x7OzQghYnJjT10DODyU6imaDSZbxOYR96NkVBm9HA3zKnCrOY9xybqb4o37Vf6Mzxwb3osVGxUgUOcbjuCx2MGFe7dkAtcoYBkCQnoHnLVr9UPNP+nY8+xt1TrBKP5+shH2MqfanTunvYhQiHtU/dIa4HuE+HEEiyXkStkVZRdJVehcOjNsgdEbH7GyrctE08HCIYVNvA0UdkU8Q3COWXWwOm0xDm0Ydb/LoEvsO2lwcNB0wmA+T061GLCpEZO7gWMyrxTMy8adNE1u5f1LfSSYc017pyTcYHNWxCw/gdm4IgCecMchpdyxQyxO0nGusoBYX+i1Nzyjv9l+NtMzFYOwMHLzsFua2LR54W2xuU80j2U1p24SaCCQ4yI9XIfdSXcDbvcUc97eE4nJWqwD8MeMt0PTHWSE+T11CBzlkL.
[2015-05-29 17:13:00,453][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780448|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:00,453][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="1" totalAmount="200.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>
[2015-05-29 17:13:00,454][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780448|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="1" totalAmount="200.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=617809526), get digest:6c914039dca36a4e4f40d30441fdf681
[2015-05-29 17:13:00,454][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,454][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/digital/SellTicket_Req.xml
[2015-05-29 17:13:00,454][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,470][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_1.5.0).
[2015-05-29 17:13:00,470][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_).
[2015-05-29 17:13:00,470][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(7_200_), found controller(com.mpos.lottery.te.gameimpl.digital.DigitalController@2c507c91) and method(public void com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:00,480][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:00,480][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745719300002548
[2015-05-29 17:13:00,487][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:00,489][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu50A2BrZKmpPw0rLgpDQaJe) as 150000
[2015-05-29 17:13:00,496][Test worker][DEBUG][DigitalRiskControlService] There total 1 possible prize levels found, determine the final loss amount of prize level as 150000.00=150000/1
[2015-05-29 17:13:00,497][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=41, bettingNumber=null]
[2015-05-29 17:13:00,497][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(0,3,2,8, amount=60.0) is 50
[2015-05-29 17:13:00,505][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu50A2BrZKmpPw0rLgpDQaJe) as 150000
[2015-05-29 17:13:00,509][Test worker][DEBUG][DigitalRiskControlService] There total 1 possible prize levels found, determine the final loss amount of prize level as 150000.00=150000/1
[2015-05-29 17:13:00,509][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=-3, bettingNumber=25]
[2015-05-29 17:13:00,510][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(25, amount=140.0) is 50
[2015-05-29 17:13:00,530][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:00,530][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:00,530][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199999800.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:00,534][Test worker][WARN ][BaseJpaDao] Should be at most only 1 entity(com.mpos.lottery.te.merchant.domain.OperatorCommission) found, however total 2 entities found... the 1st entity(com.mpos.lottery.te.merchant.domain.OperatorCommission@1a98b600) will be returned.
[2015-05-29 17:13:00,547][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.7]: transaction {
  id: "0115052900000000000139"
  dev_id: "111"
  operator_id: "OPERATOR-111"
  merchant_id: "111"
  create_time: 1432890780000
  trans_type: 200
  game_id: "FD-1"
  game_type: 7
  total_amount: "200.0"
}
multi_draw: 1
total_amount: "200.0"
serial_no: "aHhDkgTyIu50A2BrZKmpPw0rLgpDQaJe"
game_instance {
  id: "GII-112"
}
entries {
  selected_number: "0,3,2,8"
  bet_option: 4
  total_bets: 1
  entry_amount: "60.0"
  input_channel: "2"
}
entries {
  selected_number: "25"
  bet_option: -3
  total_bets: 1
  entry_amount: "140.0"
  input_channel: "2"
}

[2015-05-29 17:13:00,548][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:00,548][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Res.xml) by key(7.transtype.4200).
[2015-05-29 17:13:00,548][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket),mappingFile=xml-mapping/game/digital/SellTicket_Res.xml
[2015-05-29 17:13:00,548][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Res.xml) by key(7.transtype.4200).
[2015-05-29 17:13:00,549][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket, mappingFile=xml-mapping/game/digital/SellTicket_Res.xml).
[2015-05-29 17:13:00,550][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780448|Timestamp:20150529171300|Transaction-Type:4200|Transaction-Id:0115052900000000000139|Response-Code:200|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01110745719300002548" type="1" lastDrawNo="11002" barcode="07cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcp3InwF+WYqV6Fs2KD1Yx+o=" validationCode="973579" multipleDraws="1" totalBets="2" totalAmount="200.0"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/></Ticket>):6eb5c0f06ae36beedd8636fe002c1183
[2015-05-29 17:13:00,550][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=652) succesfully.
[2015-05-29 17:13:00,551][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=652): <?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01110745719300002548" type="1" lastDrawNo="11002" barcode="07cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcp3InwF+WYqV6Fs2KD1Yx+o=" validationCode="973579" multipleDraws="1" totalBets="2" totalAmount="200.0"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/></Ticket>
[2015-05-29 17:13:00,551][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Res.xml) by key(7.transtype.4200).
[2015-05-29 17:13:00,587][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:00,587][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:00,588][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@6ee27e6b) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:00,588][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:00,588][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:00,589][Test worker][INFO ][BaseTransactionalIntegrationTest] | SaleIntegrationTest.testSell_No_EvenOdd_Supported                                                                      |
[2015-05-29 17:13:00,589][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:00,590][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,591][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket, mappingFile=xml-mapping/game/digital/SellTicket_Req.xml).
[2015-05-29 17:13:00,592][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780590|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="EVEN" betOption="-2" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=256584813), get digest:bca4cbe98fb77ce1bd34bf397ff2ffa6
[2015-05-29 17:13:00,592][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:00,592][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:00,592][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171300).
[2015-05-29 17:13:00,592][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:00,592][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890780590).
[2015-05-29 17:13:00,592][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:00,592][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:00,593][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=bca4cbe98fb77ce1bd34bf397ff2ffa6).
[2015-05-29 17:13:00,593][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=7).
[2015-05-29 17:13:00,593][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:00,593][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:00,595][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9btrOyNtL8dAXOsCAt2VNz1Y3CyjizpWI1I8nQlwlEa8u3GnJdhPFqIwM+Go3KKjwWeZYUIZCCRGWj1yuQpJlzXfrBcB0y+SIx9BCcDqX9Co9A3AByFmnZoQveNLHInzF+nN5BHXeOSNU9/EaznwTzoGyfP0kg6vi4NW1wLnCo47p4hD8cBO+WsdkvTapOkzT7tnE1BYLfvlyBRu5org0bBsVjujDMfxsDNzB12QT67+TpsNBD0Wb+1o4mPgEeiGr8DHpKhwgs7eJMs5f1EwWitzVAXEkOf/hjxIKpmM4yRu/fK5w1xgC+7qEonwKH1zhOu8B2nhTNhbz8HKwL5WOEBInrgSDxg2HLcvM747tIx5lG/se8IeHt0D3U821+S1IQBR+u16rR1urlEpdNsEeJA==.
[2015-05-29 17:13:00,595][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780590|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:00,595][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="EVEN" betOption="-2" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>
[2015-05-29 17:13:00,596][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780590|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="EVEN" betOption="-2" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=256584813), get digest:bca4cbe98fb77ce1bd34bf397ff2ffa6
[2015-05-29 17:13:00,596][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,596][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/digital/SellTicket_Req.xml
[2015-05-29 17:13:00,596][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,614][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_1.5.0).
[2015-05-29 17:13:00,614][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_).
[2015-05-29 17:13:00,614][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(7_200_), found controller(com.mpos.lottery.te.gameimpl.digital.DigitalController@2c507c91) and method(public void com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:00,620][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.digital.game.DigitalGameInstance) by(number=11002,gameId=FD-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:00,626][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:00,626][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745719300002697
[2015-05-29 17:13:00,633][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:00,633][Test worker][ERROR][TEPortServlet] ODD/EVEN bet option are not supported
com.mpos.lottery.te.config.exception.ApplicationException: ODD/EVEN bet option are not supported
	at com.mpos.lottery.te.gameimpl.digital.sale.support.DigitalOddEvenSelectedNumberValidator.checkNumbers(DigitalOddEvenSelectedNumberValidator.java:19)
	at com.mpos.lottery.te.gameimpl.digital.sale.support.DigitalXDSelectedNumberValidator.validate(DigitalXDSelectedNumberValidator.java:30)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validate(DefaultTicketValidator.java:42)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.validateTicketRequest(AbstractTicketService.java:386)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:140)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(DigitalController.java:37)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest.testSell_No_EvenOdd_Supported(SaleIntegrationTest.java:580)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:00,636][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780590|Timestamp:20150529171300|Transaction-Type:4200|Transaction-Id:0115052900000000000145|Response-Code:306|):9f24b591baef48bea120ae50683a1cca
[2015-05-29 17:13:00,636][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=306,length=0): 
[2015-05-29 17:13:00,650][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:00,651][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:00,651][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@2c9152a1) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:00,651][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:00,652][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:00,652][Test worker][INFO ][BaseTransactionalIntegrationTest] | SaleIntegrationTest.testSell_SUM_exceedMax                                                                             |
[2015-05-29 17:13:00,652][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:00,653][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,654][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket, mappingFile=xml-mapping/game/digital/SellTicket_Req.xml).
[2015-05-29 17:13:00,655][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780653|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="1" totalAmount="200.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="10000" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=-265654336), get digest:65369a1818bfbc3972c16ce4cb7bc7e7
[2015-05-29 17:13:00,655][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:00,655][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:00,655][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171300).
[2015-05-29 17:13:00,655][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:00,655][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890780653).
[2015-05-29 17:13:00,655][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:00,655][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:00,655][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=65369a1818bfbc3972c16ce4cb7bc7e7).
[2015-05-29 17:13:00,656][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=7).
[2015-05-29 17:13:00,656][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:00,656][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:00,658][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfnfSvzUuvi5gIW+x7OzQghYnJjT10DODyU6imaDSZbxOYR96NkVBm9HA3zKnCrOY9xybqb4o37Vf6Mzxwb3osVGxUgUOcbjuCx2MGFe7dkAtcoYBkCQnoHnLVr9UPNP+nY8+xt1TrBKP5+shH2MqfanTunvYhQiHtU/dIa4HuE+HEEiyXkStkVZRdJVehcOjNsgdEbH7GyrctE08HCIYVNvA0UdkU8Q3COWXWwOm0xDm0Ydb/LoEvsO22G6i2ohP2x/Ei2rsQYBWLYu/xH4nglMDTsrwb2028ZNRc81TKkEdwThK/aCeJjv9EcbFG/mrXYcNcUDOB+R3A+dl3CwCWyKuxFHizYnfsPRCVMh8lu9OQILTNdLbvJ/PNc/etPr7nm21km1ayP6trAiITK8XAq+XmwLdPyofFW1+8iGPJ6H8IwVRS5J4cdhq.
[2015-05-29 17:13:00,658][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780653|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:00,659][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="1" totalAmount="200.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="10000" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>
[2015-05-29 17:13:00,659][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780653|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="1" totalAmount="200.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="10000" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=-265654336), get digest:65369a1818bfbc3972c16ce4cb7bc7e7
[2015-05-29 17:13:00,659][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,659][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/digital/SellTicket_Req.xml
[2015-05-29 17:13:00,660][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,677][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_1.5.0).
[2015-05-29 17:13:00,677][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_).
[2015-05-29 17:13:00,677][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(7_200_), found controller(com.mpos.lottery.te.gameimpl.digital.DigitalController@2c507c91) and method(public void com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:00,684][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:00,684][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745719300002784
[2015-05-29 17:13:00,691][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:00,692][Test worker][ERROR][TEPortServlet] The sum should be between 0 and 36, however it is 10000
com.mpos.lottery.te.config.exception.SystemException: The sum should be between 0 and 36, however it is 10000
	at com.mpos.lottery.te.gameimpl.digital.sale.support.DigitalSumSelectedNumberValidator.checkNumbers(DigitalSumSelectedNumberValidator.java:33)
	at com.mpos.lottery.te.gameimpl.digital.sale.support.DigitalXDSelectedNumberValidator.validate(DigitalXDSelectedNumberValidator.java:30)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validate(DefaultTicketValidator.java:42)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.validateTicketRequest(AbstractTicketService.java:386)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:140)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(DigitalController.java:37)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest.testSell_SUM_exceedMax(SaleIntegrationTest.java:658)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:00,695][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780653|Timestamp:20150529171300|Transaction-Type:4200|Transaction-Id:0115052900000000000146|Response-Code:305|):65f6f1619aa5c5f7fb802deffa600251
[2015-05-29 17:13:00,695][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=305,length=0): 
[2015-05-29 17:13:00,708][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:00,709][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:00,709][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@4d57089f) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:00,709][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:00,710][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:00,710][Test worker][INFO ][BaseTransactionalIntegrationTest] | SaleIntegrationTest.testSell_TypeE_6D                                                                                  |
[2015-05-29 17:13:00,710][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:00,713][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,714][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket, mappingFile=xml-mapping/game/digital/SellTicket_Req.xml).
[2015-05-29 17:13:00,714][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780712|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="1" totalAmount="60.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="1,2,3,4,5,6" betOption="6" inputChannel="2" entryAmount="60.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=-1535068494), get digest:ff596f6f6433d27837c60eec211b37e9
[2015-05-29 17:13:00,715][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:00,715][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:00,715][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171300).
[2015-05-29 17:13:00,715][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:00,715][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890780712).
[2015-05-29 17:13:00,715][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:00,715][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:00,715][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=ff596f6f6433d27837c60eec211b37e9).
[2015-05-29 17:13:00,715][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=7).
[2015-05-29 17:13:00,715][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:00,716][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:00,720][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfnfSvzUuvi5gIW+x7OzQghYn61j67DgR6TBVy0+8UOQwFouABQ1BZVaWGMyhWg+ffjkCOvVblXD+Y1xAZWdKPvI3oBdVNXqiWYUBK4HKq/72nJif70QK2KUzcgCZ0LNb/ZiQuMAejilE8S14UcrINyEx4r8lJ9Eh2Zu8PvEVP4OpBMInCCZVtXSVC8/66dfpPhD0UbO2ZloF8i8uHP8ZewfBMnxxp/WueqUsaSDmC5lskK3pJGMR0l51vhox7O/D5TDZ+A49nnkNY/whWgZJDwIKzHYDZuqjU573BoxbFGcP2AzzJUQpAcMi//munHzJmjjKUcNMFeM0Xw==.
[2015-05-29 17:13:00,721][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780712|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:00,721][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="1" totalAmount="60.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="1,2,3,4,5,6" betOption="6" inputChannel="2" entryAmount="60.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>
[2015-05-29 17:13:00,721][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780712|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="1" totalAmount="60.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="1,2,3,4,5,6" betOption="6" inputChannel="2" entryAmount="60.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=-1535068494), get digest:ff596f6f6433d27837c60eec211b37e9
[2015-05-29 17:13:00,722][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,722][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/digital/SellTicket_Req.xml
[2015-05-29 17:13:00,722][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,748][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_1.5.0).
[2015-05-29 17:13:00,749][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_).
[2015-05-29 17:13:00,749][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(7_200_), found controller(com.mpos.lottery.te.gameimpl.digital.DigitalController@2c507c91) and method(public void com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:00,757][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:00,758][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745719300002832
[2015-05-29 17:13:00,765][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:00,768][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu50A2BrZKmpP/cK+VRHCAlq) as 150000
[2015-05-29 17:13:00,775][Test worker][DEBUG][DigitalRiskControlService] There total 2 possible prize levels found, determine the final loss amount of prize level as 75000.00=150000/2
[2015-05-29 17:13:00,775][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=6, bettingNumber=null]
[2015-05-29 17:13:00,775][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(1,2,3,4,5,6, amount=60.0) is 50
[2015-05-29 17:13:00,783][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=5, bettingNumber=null]
[2015-05-29 17:13:00,783][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(1,2,3,4,5,6, amount=60.0) is 30
[2015-05-29 17:13:00,801][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:00,801][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:00,801][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199999940.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:00,806][Test worker][WARN ][BaseJpaDao] Should be at most only 1 entity(com.mpos.lottery.te.merchant.domain.OperatorCommission) found, however total 2 entities found... the 1st entity(com.mpos.lottery.te.merchant.domain.OperatorCommission@7353a6a5) will be returned.
[2015-05-29 17:13:00,821][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.7]: transaction {
  id: "0115052900000000000147"
  dev_id: "111"
  operator_id: "OPERATOR-111"
  merchant_id: "111"
  create_time: 1432890780000
  trans_type: 200
  game_id: "FD-1"
  game_type: 7
  total_amount: "60.0"
}
multi_draw: 1
total_amount: "60.0"
serial_no: "aHhDkgTyIu50A2BrZKmpP/cK+VRHCAlq"
game_instance {
  id: "GII-112"
}
entries {
  selected_number: "1,2,3,4,5,6"
  bet_option: 6
  total_bets: 1
  entry_amount: "60.0"
  input_channel: "2"
}

[2015-05-29 17:13:00,821][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:00,822][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Res.xml) by key(7.transtype.4200).
[2015-05-29 17:13:00,822][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket),mappingFile=xml-mapping/game/digital/SellTicket_Res.xml
[2015-05-29 17:13:00,822][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Res.xml) by key(7.transtype.4200).
[2015-05-29 17:13:00,823][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket, mappingFile=xml-mapping/game/digital/SellTicket_Res.xml).
[2015-05-29 17:13:00,824][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780712|Timestamp:20150529171300|Transaction-Type:4200|Transaction-Id:0115052900000000000147|Response-Code:200|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01110745719300002832" type="1" lastDrawNo="11002" barcode="07cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcp3InwF+WYqVFA+560IUs1E=" validationCode="542570" multipleDraws="1" totalBets="1" totalAmount="60.0"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="1,2,3,4,5,6" betOption="6" inputChannel="2" entryAmount="60.0"/></Ticket>):c281d32143360ff4ca4cca63c015d68a
[2015-05-29 17:13:00,824][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=544) succesfully.
[2015-05-29 17:13:00,825][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=544): <?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01110745719300002832" type="1" lastDrawNo="11002" barcode="07cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcp3InwF+WYqVFA+560IUs1E=" validationCode="542570" multipleDraws="1" totalBets="1" totalAmount="60.0"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="1,2,3,4,5,6" betOption="6" inputChannel="2" entryAmount="60.0"/></Ticket>
[2015-05-29 17:13:00,825][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Res.xml) by key(7.transtype.4200).
[2015-05-29 17:13:00,845][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:00,846][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:00,846][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@6f21165) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:00,846][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:00,846][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:00,846][Test worker][INFO ][BaseTransactionalIntegrationTest] | SaleIntegrationTest.testSell_Single_OutOfRange1                                                                        |
[2015-05-29 17:13:00,847][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:00,847][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,848][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket, mappingFile=xml-mapping/game/digital/SellTicket_Req.xml).
[2015-05-29 17:13:00,849][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780847|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="360" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="40"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=247935117), get digest:0255e8dd771cd8f1862c3150ebde2c2b
[2015-05-29 17:13:00,849][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:00,849][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:00,849][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171300).
[2015-05-29 17:13:00,850][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:00,850][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890780847).
[2015-05-29 17:13:00,850][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:00,850][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:00,850][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=0255e8dd771cd8f1862c3150ebde2c2b).
[2015-05-29 17:13:00,850][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=7).
[2015-05-29 17:13:00,850][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:00,850][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:00,852][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9lgpIT/Biz3VzVUidTijb6D7E+V0X2uzNINs8vldNuY4sGjht9G7YLcwLg17nh9E3avAOboAekam5yr/uADZ8KbszfIWxJPJDxunJWtQvJfsIipBJARyBvF2Jni+UIX4ZIJdPtfIIAa+TMyqwd1jHU5Sqd9IHztN0LKg+3Lor7rWfFNRjQ4mnUK7hbQJAJT1WABGJwvAbS41vIXPuxJ/Ow32Ff9sKdpJ7+oQaTAmbmvleiBC6jCihmfaaBkirpbkIgl9vHokTAbx5OlEJEOVjkJqHEFRYkRCCls/17R+cjFVF11ZRXUuffFa2DcqW9zIg8oq5/x44E1GGk1rL0Dh8dXXE/EA+9iBWpKG39awPObFW11kpFt0zOMnA91CyePGBQXcVCgV/wORcnFHvxkTbzg==.
[2015-05-29 17:13:00,853][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780847|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:00,853][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="360" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="40"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>
[2015-05-29 17:13:00,853][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780847|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="360" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="40"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=247935117), get digest:0255e8dd771cd8f1862c3150ebde2c2b
[2015-05-29 17:13:00,854][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,854][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/digital/SellTicket_Req.xml
[2015-05-29 17:13:00,854][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,873][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_1.5.0).
[2015-05-29 17:13:00,873][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_).
[2015-05-29 17:13:00,873][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(7_200_), found controller(com.mpos.lottery.te.gameimpl.digital.DigitalController@2c507c91) and method(public void com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:00,879][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.digital.game.DigitalGameInstance) by(number=11002,gameId=FD-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:00,886][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:00,886][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745719300002943
[2015-05-29 17:13:00,894][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:00,894][Test worker][ERROR][TEPortServlet] The entry amount must be in range(50,5000), however the amount is 40
com.mpos.lottery.te.config.exception.ApplicationException: The entry amount must be in range(50,5000), however the amount is 40
	at com.mpos.lottery.te.gameimpl.digital.sale.support.DigitalXDSelectedNumberValidator.checkEntryAmount(DigitalXDSelectedNumberValidator.java:38)
	at com.mpos.lottery.te.gameimpl.digital.sale.support.DigitalXDSelectedNumberValidator.validate(DigitalXDSelectedNumberValidator.java:31)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validate(DefaultTicketValidator.java:42)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.validateTicketRequest(AbstractTicketService.java:386)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:140)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(DigitalController.java:37)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest.testSell_Single_OutOfRange1(SaleIntegrationTest.java:537)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:00,898][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780847|Timestamp:20150529171300|Transaction-Type:4200|Transaction-Id:0115052900000000000152|Response-Code:307|):d26200aa1a9b4ce3fadc02add5bbf7c6
[2015-05-29 17:13:00,898][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=307,length=0): 
[2015-05-29 17:13:00,913][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:00,913][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:00,913][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@1605cc3e) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:00,914][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:00,915][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:00,915][Test worker][INFO ][BaseTransactionalIntegrationTest] | SaleIntegrationTest.testSell_Single_OutOfRange2                                                                        |
[2015-05-29 17:13:00,915][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:00,915][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,916][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket, mappingFile=xml-mapping/game/digital/SellTicket_Req.xml).
[2015-05-29 17:13:00,917][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780915|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="12280" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="6000"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=369645605), get digest:838c1ad0d3bb4b5a71c0f0774dabb3a0
[2015-05-29 17:13:00,917][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:00,917][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:00,918][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171300).
[2015-05-29 17:13:00,918][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:00,918][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890780915).
[2015-05-29 17:13:00,918][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:00,918][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:00,918][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=838c1ad0d3bb4b5a71c0f0774dabb3a0).
[2015-05-29 17:13:00,918][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=7).
[2015-05-29 17:13:00,918][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:00,918][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:00,921][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg928b2RPFNgSuDnwMdPktzV/4QsvvEjEORediSncYiXYD1ksJAEyOB0ixd4bsEitzEBDhQlER+odm2KkYFGjVAbF9g6+MTevlOEvEeaV1R/oi3uW/P2v39OJCzAPX3K6uRKErhehfvxnjJEEchbd4ZX1D1uD4r1PZWOu0uWYY27cM1QQUbVWJn3QAWkIp7wuriZghBAX5fBFU6c/hIY2KCarkwYKC64ltS3x2+RmkZdiYCpkzP2SmmnV0wJjFpSoRCZgjcT168zb6YFlmzr1VHRUK8yV7wddeutXuyuRAxoj4KPcS4xOrRqN3MtwLXxZgJJmGWNfK1/QZiHl12Wfj67jsbOQTosRmZiCQi3HOfCsJ7nBD+llGmTc5vjvTA4eOkAr1anuVb7IDl6HJeOhTa95uYwxxp3nm+.
[2015-05-29 17:13:00,921][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780915|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:00,921][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="12280" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="6000"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>
[2015-05-29 17:13:00,922][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780915|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="12280" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="6000"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=369645605), get digest:838c1ad0d3bb4b5a71c0f0774dabb3a0
[2015-05-29 17:13:00,922][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,922][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/digital/SellTicket_Req.xml
[2015-05-29 17:13:00,922][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,940][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_1.5.0).
[2015-05-29 17:13:00,941][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_).
[2015-05-29 17:13:00,941][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(7_200_), found controller(com.mpos.lottery.te.gameimpl.digital.DigitalController@2c507c91) and method(public void com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:00,947][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.digital.game.DigitalGameInstance) by(number=11002,gameId=FD-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:00,951][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:00,952][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745719300003022
[2015-05-29 17:13:00,958][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:00,958][Test worker][ERROR][TEPortServlet] The entry amount must be in range(50,5000), however the amount is 6000
com.mpos.lottery.te.config.exception.ApplicationException: The entry amount must be in range(50,5000), however the amount is 6000
	at com.mpos.lottery.te.gameimpl.digital.sale.support.DigitalXDSelectedNumberValidator.checkEntryAmount(DigitalXDSelectedNumberValidator.java:38)
	at com.mpos.lottery.te.gameimpl.digital.sale.support.DigitalXDSelectedNumberValidator.validate(DigitalXDSelectedNumberValidator.java:31)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validate(DefaultTicketValidator.java:42)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.validateTicketRequest(AbstractTicketService.java:386)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:140)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(DigitalController.java:37)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest.testSell_Single_OutOfRange2(SaleIntegrationTest.java:559)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:00,962][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780915|Timestamp:20150529171300|Transaction-Type:4200|Transaction-Id:0115052900000000000153|Response-Code:307|):2a87539ea90fa6baaf67a5f181c124c5
[2015-05-29 17:13:00,962][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=307,length=0): 
[2015-05-29 17:13:00,977][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:00,977][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:00,977][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@30be88b2) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:00,978][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:00,978][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:00,978][Test worker][INFO ][BaseTransactionalIntegrationTest] | SaleIntegrationTest.testSell_Zero_MulteDraw                                                                            |
[2015-05-29 17:13:00,978][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:00,979][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,981][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket, mappingFile=xml-mapping/game/digital/SellTicket_Req.xml).
[2015-05-29 17:13:00,982][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780979|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="0" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=9096884), get digest:acd05df49545bf82afaba590009d1241
[2015-05-29 17:13:00,982][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:00,982][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:00,982][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171300).
[2015-05-29 17:13:00,982][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:00,982][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890780979).
[2015-05-29 17:13:00,982][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:00,982][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:00,982][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=acd05df49545bf82afaba590009d1241).
[2015-05-29 17:13:00,983][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=7).
[2015-05-29 17:13:00,983][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:00,983][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:00,986][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfneJzaP+7LMfb9vnbgfHxhQbRyPZfrPmKs46l68/amNRghJ8Zt/Itf4YJ7l/RBPuWTBKPQGw0kJPESTXqwuwqLq1tujet40fsesYDIBW4b12ctl/+YfnEeLf/GgH+6KI0j+5G7SS0H0z133JAqoce4xWvKGsqAv42Jis2L9DIKRhpgsnTxVFGrDe0Kt360jiuD0ecjVzBd2LULZvxT3mYRBpNeggVKTWkr5NmBqjWMiclA+dQD1pl+AJIwiHlzxKHdh6A5ddOgs8fn17r6c0Fsn6dMYLo4iHV1l3v2afswr84tWQbIFiSf7TCxwQv5m550yzb1ncGK7AsobpRV5kbXaY/EUgpUpdfW1plm8vHZyj7dvz1JIsMfbzPU0e8iRWIzxVwdBpQjSIxCfAd4peTFiGRP+TRoEW9l7z2C1D8MCynWiONs4pdj01.
[2015-05-29 17:13:00,986][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780979|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:00,987][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="0" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>
[2015-05-29 17:13:00,987][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780979|Timestamp:20150529171300|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="0" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=9096884), get digest:acd05df49545bf82afaba590009d1241
[2015-05-29 17:13:00,987][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:00,987][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/digital/SellTicket_Req.xml
[2015-05-29 17:13:00,987][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:01,005][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_1.5.0).
[2015-05-29 17:13:01,005][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_).
[2015-05-29 17:13:01,005][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(7_200_), found controller(com.mpos.lottery.te.gameimpl.digital.DigitalController@2c507c91) and method(public void com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:01,006][Test worker][ERROR][TEPortServlet] THe multi-draw must be at least 1
com.mpos.lottery.te.config.exception.ApplicationException: THe multi-draw must be at least 1
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:119)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(DigitalController.java:37)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest.testSell_Zero_MulteDraw(SaleIntegrationTest.java:619)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:01,009][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890780979|Timestamp:20150529171300|Transaction-Type:4200|Transaction-Id:0115052900000000000154|Response-Code:210|):5a8e630575570df863286705ff928afb
[2015-05-29 17:13:01,009][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=210,length=0): 
[2015-05-29 17:13:01,024][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:01,024][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:01,025][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@688a7b22) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:01,025][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:01,026][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:01,026][Test worker][INFO ][BaseTransactionalIntegrationTest] | SaleIntegrationTest.testEnquiryQP                                                                                      |
[2015-05-29 17:13:01,026][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:01,026][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/QPEnquiry_Req.xml) by key(7.transtype.211).
[2015-05-29 17:13:01,042][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gamespec.sale.web.QPEnquiryDto, mappingFile=xml-mapping/game/digital/QPEnquiry_Req.xml).
[2015-05-29 17:13:01,043][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890781026|Timestamp:20150529171301|Transaction-Type:211|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<QPGenerator countOfQPNumbers="4" countOfQP="3"><GameDraw number="11002" gameId="FD-1"/></QPGenerator>,hash=-608691269), get digest:d68741d9bf2c1c2bec030358b45ee894
[2015-05-29 17:13:01,043][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=211).
[2015-05-29 17:13:01,043][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:01,043][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171301).
[2015-05-29 17:13:01,043][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:01,043][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890781026).
[2015-05-29 17:13:01,043][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:01,043][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:01,043][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=d68741d9bf2c1c2bec030358b45ee894).
[2015-05-29 17:13:01,044][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=7).
[2015-05-29 17:13:01,044][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:01,044][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:01,046][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6oJoDNAH1tpsPSfJkbDgGrKQERwUdCr7yMmWHsRIm8s9UXbB6YsLCcRJ2SxppoZVRuTtMQAPLAMgao93c4ZT+AtxapTT9OFYA+xHDKntRvoovP59yAEVKCBavkRnrEbSwkmyv613C1KB.
[2015-05-29 17:13:01,046][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890781026|Timestamp:20150529171301|Transaction-Type:211|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:01,046][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<QPGenerator countOfQPNumbers="4" countOfQP="3"><GameDraw number="11002" gameId="FD-1"/></QPGenerator>
[2015-05-29 17:13:01,047][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890781026|Timestamp:20150529171301|Transaction-Type:211|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<QPGenerator countOfQPNumbers="4" countOfQP="3"><GameDraw number="11002" gameId="FD-1"/></QPGenerator>,hash=-608691269), get digest:d68741d9bf2c1c2bec030358b45ee894
[2015-05-29 17:13:01,047][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/QPEnquiry_Req.xml) by key(7.transtype.211).
[2015-05-29 17:13:01,047][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/digital/QPEnquiry_Req.xml
[2015-05-29 17:13:01,047][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/QPEnquiry_Req.xml) by key(7.transtype.211).
[2015-05-29 17:13:01,066][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_211_1.5.0).
[2015-05-29 17:13:01,066][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_211_).
[2015-05-29 17:13:01,066][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(7_211_), found controller(com.mpos.lottery.te.gameimpl.digital.DigitalController@2c507c91) and method(public void com.mpos.lottery.te.gameimpl.digital.DigitalController.enquiryQP(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:01,096][Test worker][DEBUG][JpaDigitalStatOfSelectedNumberDao] Total 112 StatOfSelectedNumber entities found(gameInstanceId=GII-112).
[2015-05-29 17:13:01,097][Test worker][DEBUG][DigitalSaleService] 90% of total 10 of position[4] will be put in QP sample, 3 is picked.
[2015-05-29 17:13:01,097][Test worker][DEBUG][DigitalSaleService] 90% of total 10 of position[3] will be put in QP sample, 6 is picked.
[2015-05-29 17:13:01,097][Test worker][DEBUG][DigitalSaleService] 90% of total 82 of position[2] will be put in QP sample, 1 is picked.
[2015-05-29 17:13:01,097][Test worker][DEBUG][DigitalSaleService] 90% of total 10 of position[1] will be put in QP sample, 0 is picked.
[2015-05-29 17:13:01,097][Test worker][DEBUG][DigitalSaleService] Generate QP number:3,6,1,0 of game instance(id=GII-112).
[2015-05-29 17:13:01,116][Test worker][DEBUG][JpaDigitalStatOfSelectedNumberDao] Total 112 StatOfSelectedNumber entities found(gameInstanceId=GII-112).
[2015-05-29 17:13:01,116][Test worker][DEBUG][DigitalSaleService] 90% of total 10 of position[4] will be put in QP sample, 6 is picked.
[2015-05-29 17:13:01,117][Test worker][DEBUG][DigitalSaleService] 90% of total 10 of position[3] will be put in QP sample, 3 is picked.
[2015-05-29 17:13:01,117][Test worker][DEBUG][DigitalSaleService] 90% of total 82 of position[2] will be put in QP sample, 3 is picked.
[2015-05-29 17:13:01,117][Test worker][DEBUG][DigitalSaleService] 90% of total 10 of position[1] will be put in QP sample, 1 is picked.
[2015-05-29 17:13:01,117][Test worker][DEBUG][DigitalSaleService] Generate QP number:6,3,3,1 of game instance(id=GII-112).
[2015-05-29 17:13:01,135][Test worker][DEBUG][JpaDigitalStatOfSelectedNumberDao] Total 112 StatOfSelectedNumber entities found(gameInstanceId=GII-112).
[2015-05-29 17:13:01,136][Test worker][DEBUG][DigitalSaleService] 90% of total 10 of position[4] will be put in QP sample, 1 is picked.
[2015-05-29 17:13:01,136][Test worker][DEBUG][DigitalSaleService] 90% of total 10 of position[3] will be put in QP sample, 1 is picked.
[2015-05-29 17:13:01,136][Test worker][DEBUG][DigitalSaleService] 90% of total 82 of position[2] will be put in QP sample, 1 is picked.
[2015-05-29 17:13:01,136][Test worker][DEBUG][DigitalSaleService] 90% of total 10 of position[1] will be put in QP sample, 1 is picked.
[2015-05-29 17:13:01,136][Test worker][DEBUG][DigitalSaleService] Generate QP number:1,1,1,1 of game instance(id=GII-112).
[2015-05-29 17:13:01,142][Test worker][DEBUG][CommonFacadeService] No need to publish AMQP message of transaction(ENQUIRY_QP_NUMBERS)
[2015-05-29 17:13:01,142][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/QPEnquiry_Req.xml) by key(7.transtype.4211).
[2015-05-29 17:13:01,143][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gamespec.sale.web.QPEnquiryDto),mappingFile=xml-mapping/game/digital/QPEnquiry_Req.xml
[2015-05-29 17:13:01,143][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/QPEnquiry_Req.xml) by key(7.transtype.4211).
[2015-05-29 17:13:01,144][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gamespec.sale.web.QPEnquiryDto, mappingFile=xml-mapping/game/digital/QPEnquiry_Req.xml).
[2015-05-29 17:13:01,144][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890781026|Timestamp:20150529171301|Transaction-Type:4211|Transaction-Id:0115052900000000000155|Response-Code:200|<?xml version="1.0" encoding="UTF-8"?>
<QPGenerator countOfQPNumbers="4" countOfQP="3"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="3,6,1,0"/><Entry selectedNumber="6,3,3,1"/><Entry selectedNumber="1,1,1,1"/></QPGenerator>):da7deba80e77562a7f3043b50a87117f
[2015-05-29 17:13:01,144][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=332) succesfully.
[2015-05-29 17:13:01,145][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=332): <?xml version="1.0" encoding="UTF-8"?>
<QPGenerator countOfQPNumbers="4" countOfQP="3"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="3,6,1,0"/><Entry selectedNumber="6,3,3,1"/><Entry selectedNumber="1,1,1,1"/></QPGenerator>
[2015-05-29 17:13:01,145][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/QPEnquiry_Req.xml) by key(7.transtype.4211).
[2015-05-29 17:13:01,161][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:01,162][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:01,162][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@feeffc0) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:01,162][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:01,163][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:01,163][Test worker][INFO ][BaseTransactionalIntegrationTest] | SaleIntegrationTest.testSell_MultiDraw_OK                                                                              |
[2015-05-29 17:13:01,163][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:01,167][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:01,168][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket, mappingFile=xml-mapping/game/digital/SellTicket_Req.xml).
[2015-05-29 17:13:01,169][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890781167|Timestamp:20150529171301|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=-2092806271), get digest:9cd98e88af06fd52f84219668a15ede4
[2015-05-29 17:13:01,169][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:01,169][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:01,169][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171301).
[2015-05-29 17:13:01,170][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:01,170][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890781167).
[2015-05-29 17:13:01,170][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:01,170][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:01,170][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=9cd98e88af06fd52f84219668a15ede4).
[2015-05-29 17:13:01,170][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=7).
[2015-05-29 17:13:01,170][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:01,170][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:01,172][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9btrOyNtL8dAXOsCAt2VNz1Y3CyjizpWI1I8nQlwlEa8u3GnJdhPFqIwM+Go3KKjwWeZYUIZCCRGWj1yuQpJlzXfrBcB0y+SIx9BCcDqX9Cq9c2sM8doKNf2KfW5C60akmrLPtm4ds3wtET6JtIywgiNFKLcIdAG//+8JPC3fMLps3JnYw9/PChBNW4+JKSio1UkYGHWQMW8cZ8cWTDtVXm8ZINTl4bZYkVQl+v2xOSZWJfSo5PoTuCSV8U4FP7D/T6UDilZ4acW94+RrdCzF5xCwRJMMncqK4YeX8axPGnJNj8CfPsIS98AxpAtzOKg4eGW58K3qGmGJNAC9vxn2hqlnhCJ/guYLb6ysfRvd83y7AzPJ8taL+kqG6YmonjVwLMGX5NAyO1SNZJurVU7P5dRbgGIQtziq.
[2015-05-29 17:13:01,172][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890781167|Timestamp:20150529171301|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:01,173][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>
[2015-05-29 17:13:01,173][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890781167|Timestamp:20150529171301|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="400.0" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=-2092806271), get digest:9cd98e88af06fd52f84219668a15ede4
[2015-05-29 17:13:01,174][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:01,174][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/digital/SellTicket_Req.xml
[2015-05-29 17:13:01,174][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:01,189][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_1.5.0).
[2015-05-29 17:13:01,190][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_).
[2015-05-29 17:13:01,190][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(7_200_), found controller(com.mpos.lottery.te.gameimpl.digital.DigitalController@2c507c91) and method(public void com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:01,197][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.digital.game.DigitalGameInstance) by(number=11002,gameId=FD-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:01,202][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:01,202][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745719300003168
[2015-05-29 17:13:01,209][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:01,211][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu50A2BrZKmpP8xHFasdap9S) as 150000
[2015-05-29 17:13:01,217][Test worker][DEBUG][DigitalRiskControlService] There total 1 possible prize levels found, determine the final loss amount of prize level as 150000.00=150000/1
[2015-05-29 17:13:01,217][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=41, bettingNumber=null]
[2015-05-29 17:13:01,217][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(0,3,2,8, amount=60.0) is 50
[2015-05-29 17:13:01,225][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu50A2BrZKmpP8xHFasdap9S) as 150000
[2015-05-29 17:13:01,229][Test worker][DEBUG][DigitalRiskControlService] There total 1 possible prize levels found, determine the final loss amount of prize level as 150000.00=150000/1
[2015-05-29 17:13:01,229][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=-3, bettingNumber=25]
[2015-05-29 17:13:01,229][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(25, amount=140.0) is 50
[2015-05-29 17:13:01,237][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu50A2BrZKmpP8xHFasdap9S) as 150000
[2015-05-29 17:13:01,243][Test worker][DEBUG][DigitalRiskControlService] There total 1 possible prize levels found, determine the final loss amount of prize level as 150000.00=150000/1
[2015-05-29 17:13:01,243][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=41, bettingNumber=null]
[2015-05-29 17:13:01,243][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(0,3,2,8, amount=60.0) is 50
[2015-05-29 17:13:01,253][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(aHhDkgTyIu50A2BrZKmpP8xHFasdap9S) as 150000
[2015-05-29 17:13:01,259][Test worker][DEBUG][DigitalRiskControlService] There total 1 possible prize levels found, determine the final loss amount of prize level as 150000.00=150000/1
[2015-05-29 17:13:01,259][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=-3, bettingNumber=25]
[2015-05-29 17:13:01,259][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(25, amount=140.0) is 50
[2015-05-29 17:13:01,282][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:01,282][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:01,282][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199999600.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:01,286][Test worker][WARN ][BaseJpaDao] Should be at most only 1 entity(com.mpos.lottery.te.merchant.domain.OperatorCommission) found, however total 2 entities found... the 1st entity(com.mpos.lottery.te.merchant.domain.OperatorCommission@3f4d3398) will be returned.
[2015-05-29 17:13:01,299][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.7]: transaction {
  id: "0115052900000000000156"
  dev_id: "111"
  operator_id: "OPERATOR-111"
  merchant_id: "111"
  create_time: 1432890781000
  trans_type: 200
  game_id: "FD-1"
  game_type: 7
  total_amount: "400.0"
}
multi_draw: 2
total_amount: "400.0"
serial_no: "aHhDkgTyIu50A2BrZKmpP8xHFasdap9S"
game_instance {
  id: "GII-112"
}
entries {
  selected_number: "0,3,2,8"
  bet_option: 4
  total_bets: 1
  entry_amount: "60.0"
  input_channel: "2"
}
entries {
  selected_number: "25"
  bet_option: -3
  total_bets: 1
  entry_amount: "140.0"
  input_channel: "2"
}

[2015-05-29 17:13:01,299][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:01,299][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Res.xml) by key(7.transtype.4200).
[2015-05-29 17:13:01,299][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket),mappingFile=xml-mapping/game/digital/SellTicket_Res.xml
[2015-05-29 17:13:01,299][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Res.xml) by key(7.transtype.4200).
[2015-05-29 17:13:01,300][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket, mappingFile=xml-mapping/game/digital/SellTicket_Res.xml).
[2015-05-29 17:13:01,301][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890781167|Timestamp:20150529171301|Transaction-Type:4200|Transaction-Id:0115052900000000000156|Response-Code:200|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01110745719300003168" type="1" lastDrawNo="11003" barcode="07cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcp3InwF+WYqV7xkzxXbeaMg=" validationCode="534078" multipleDraws="2" totalBets="4" totalAmount="400.0"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/></Ticket>):c81c4de965457386e274a649099c61b4
[2015-05-29 17:13:01,301][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=652) succesfully.
[2015-05-29 17:13:01,302][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=652): <?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01110745719300003168" type="1" lastDrawNo="11003" barcode="07cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcp3InwF+WYqV7xkzxXbeaMg=" validationCode="534078" multipleDraws="2" totalBets="4" totalAmount="400.0"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/></Ticket>
[2015-05-29 17:13:01,302][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Res.xml) by key(7.transtype.4200).
[2015-05-29 17:13:01,343][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:01,343][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:01,343][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@5ee11119) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:01,344][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:01,344][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:01,344][Test worker][INFO ][BaseTransactionalIntegrationTest] | SaleIntegrationTest.testSell_Single_UnmatchedAmount                                                                    |
[2015-05-29 17:13:01,344][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:01,345][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:01,346][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.digital.sale.DigitalTicket, mappingFile=xml-mapping/game/digital/SellTicket_Req.xml).
[2015-05-29 17:13:01,346][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890781345|Timestamp:20150529171301|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="360" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=2096524726), get digest:495a85e13164f42d8d8c3081513db1b9
[2015-05-29 17:13:01,346][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:01,347][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:01,347][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171301).
[2015-05-29 17:13:01,347][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:01,347][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890781345).
[2015-05-29 17:13:01,347][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:01,347][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:01,347][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=495a85e13164f42d8d8c3081513db1b9).
[2015-05-29 17:13:01,347][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=7).
[2015-05-29 17:13:01,347][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:01,347][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:01,349][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9lgpIT/Biz3VzVUidTijb6D7E+V0X2uzNINs8vldNuY4sGjht9G7YLcwLg17nh9E3avAOboAekam5yr/uADZ8KbszfIWxJPJDxunJWtQvJfsIipBJARyBvF2Jni+UIX4ZIJdPtfIIAa+TMyqwd1jHU5Sqd9IHztN0LKg+3Lor7rWfFNRjQ4mnUPj+0alcmtaGH5gVuIpmV3FP2HnuKSjucc6366zQy36DnLOK2b/ShYwF4xDjeHnlvP8YL+8E1WVPbEdBhsZDW0ufVUhcVt9FYSaJVjWjWjyHrP+Qm/Crp8btUgxr7XXRmAiMrx03X2nHKfB9zbQ1hSr5sXqsKJSngRmWCr48Ur6XnKba0wfczu/YX/hVAnT3FTRiItEwRwcze13HFZqalgB+hJWlwRjKBg==.
[2015-05-29 17:13:01,350][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890781345|Timestamp:20150529171301|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:01,350][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="360" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>
[2015-05-29 17:13:01,350][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890781345|Timestamp:20150529171301|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="360" PIN="!!!"><GameDraw number="11002" gameId="FD-1"/><Entry selectedNumber="0,3,2,8" betOption="4" inputChannel="2" entryAmount="60.0"/><Entry selectedNumber="25" betOption="-3" inputChannel="2" entryAmount="140.0"/><User mobile="13800138000" creditCardSN="09812091283120123" id="lai"/></Ticket>,hash=2096524726), get digest:495a85e13164f42d8d8c3081513db1b9
[2015-05-29 17:13:01,351][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:01,351][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/digital/SellTicket_Req.xml
[2015-05-29 17:13:01,351][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/digital/SellTicket_Req.xml) by key(7.transtype.200).
[2015-05-29 17:13:01,375][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_1.5.0).
[2015-05-29 17:13:01,375][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(7_200_).
[2015-05-29 17:13:01,375][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(7_200_), found controller(com.mpos.lottery.te.gameimpl.digital.DigitalController@2c507c91) and method(public void com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:01,381][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.digital.game.DigitalGameInstance) by(number=11002,gameId=FD-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:01,386][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:01,386][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745719300003290
[2015-05-29 17:13:01,396][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:01,397][Test worker][ERROR][TEPortServlet] The total amount(360) of client ticket is unmatched with the server side(totalAmount=400.0,totalBets=2)
com.mpos.lottery.te.config.exception.ApplicationException: The total amount(360) of client ticket is unmatched with the server side(totalAmount=400.0,totalBets=2)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validateAmount(DefaultTicketValidator.java:114)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validate(DefaultTicketValidator.java:52)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.validateTicketRequest(AbstractTicketService.java:386)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:140)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.digital.DigitalController.sell(DigitalController.java:37)
	at sun.reflect.GeneratedMethodAccessor191.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.digital.sale.SaleIntegrationTest.testSell_Single_UnmatchedAmount(SaleIntegrationTest.java:515)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:01,400][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890781345|Timestamp:20150529171301|Transaction-Type:4200|Transaction-Id:0115052900000000000165|Response-Code:307|):31ed960a71c541c097b4a66db159d797
[2015-05-29 17:13:01,401][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=307,length=0): 
]]></system-out>
  <system-err><![CDATA[]]></system-err>
</testsuite>

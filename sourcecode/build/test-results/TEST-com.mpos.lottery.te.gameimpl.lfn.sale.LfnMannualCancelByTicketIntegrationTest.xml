<?xml version="1.0" encoding="UTF-8"?>
<testsuite name="com.mpos.lottery.te.gameimpl.lfn.sale.LfnMannualCancelByTicketIntegrationTest" tests="3" skipped="0" failures="0" errors="0" timestamp="2015-05-29T09:13:22" hostname="Ramon-PC" time="1.319">
  <properties/>
  <testcase name="testCancel_Game_Disable" classname="com.mpos.lottery.te.gameimpl.lfn.sale.LfnMannualCancelByTicketIntegrationTest" time="0.41"/>
  <testcase name="testCancel_OK" classname="com.mpos.lottery.te.gameimpl.lfn.sale.LfnMannualCancelByTicketIntegrationTest" time="0.483"/>
  <testcase name="testCancel_GameInstance_Disable" classname="com.mpos.lottery.te.gameimpl.lfn.sale.LfnMannualCancelByTicketIntegrationTest" time="0.424"/>
  <system-out><![CDATA[[2015-05-29 17:13:22,233][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:22,234][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:22,234][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@36be646b) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:22,234][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:22,234][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:22,234][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnMannualCancelByTicketIntegrationTest.testCancel_Game_Disable                                                        |
[2015-05-29 17:13:22,234][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:22,236][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:22,237][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:22,237][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890802236|Timestamp:20150529171322|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=-757905774), get digest:70c162bebad6eab40e0c21a83d07a02b
[2015-05-29 17:13:22,237][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:22,237][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:22,237][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171322).
[2015-05-29 17:13:22,237][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:22,237][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890802236).
[2015-05-29 17:13:22,237][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:22,237][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:22,237][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=70c162bebad6eab40e0c21a83d07a02b).
[2015-05-29 17:13:22,238][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:22,238][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:22,238][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:22,239][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9L2k05jXFbPjS1FsBBTLuWj4a8kJVsM72/YMzruGEM7DWPI5uQU+kvE7y74H12t4zbaRoUQTDb7n/h8zAxrh6Hn2mtyfU/CYtxKe3z/Py5RlIQZDC6AG8TrAvhb3G3SNDjlu4Vxm32uHjs7iClqnt2hDh9rhQSOHhB9K5LUL3NVo8dKwh6SCwM56BaXiK557zz5HaYz2004U1raT6OlReAP7pgHuknsbfxdYkwSI2v0wkzsQ/uHRPv01BVY1tFvgu1/1csAMYBq+O2tRLIhXeAoIJOVLJJPvPHAkozf5FsxcYBza1aivogG1+z8aPrO9uA0h0ScFgQ8LmCP5AX0mf6ruPkYWDcmUtW5ansd9eHP+N72iCfLshuhdBbTWGleRy.
[2015-05-29 17:13:22,239][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890802236|Timestamp:20150529171322|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:22,240][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>
[2015-05-29 17:13:22,240][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890802236|Timestamp:20150529171322|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=-757905774), get digest:70c162bebad6eab40e0c21a83d07a02b
[2015-05-29 17:13:22,240][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:22,240][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:22,240][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:22,255][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_1.5.0).
[2015-05-29 17:13:22,255][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_).
[2015-05-29 17:13:22,255][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_200_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:22,263][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance) by(number=11002,gameId=LFN-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:22,266][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:22,267][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01111745519300008078
[2015-05-29 17:13:22,273][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:22,275][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMiebUvmpX9Wv) as 80000
[2015-05-29 17:13:22,279][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMiebUvmpX9Wv, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:22,279][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:22,279][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:22,286][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMiebUvmpX9Wv) as 80000
[2015-05-29 17:13:22,289][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMiebUvmpX9Wv, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:22,289][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:22,289][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:22,296][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:22,296][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:22,302][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:22,302][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:22,309][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:22,309][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:22,318][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:22,318][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:22,325][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:22,325][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:22,332][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:22,332][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:22,339][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:22,339][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:22,347][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:22,347][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:22,353][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:22,353][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:22,360][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:22,360][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:22,366][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:22,366][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:22,372][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:22,372][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:22,380][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:22,380][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:22,387][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:22,387][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:22,394][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:22,394][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:22,401][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:22,401][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:22,407][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:22,407][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:22,414][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:22,414][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:22,420][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:22,420][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:22,427][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMiebUvmpX9Wv) as 80000
[2015-05-29 17:13:22,429][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMiebUvmpX9Wv, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:22,429][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:22,429][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:22,435][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMiebUvmpX9Wv) as 80000
[2015-05-29 17:13:22,437][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMiebUvmpX9Wv, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:22,437][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:22,437][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:22,443][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:22,444][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:22,450][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:22,450][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:22,456][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:22,456][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:22,462][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:22,463][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:22,469][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:22,469][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:22,475][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:22,475][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:22,481][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:22,481][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:22,487][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:22,487][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:22,493][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:22,493][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:22,499][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:22,499][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:22,506][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:22,506][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:22,512][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:22,512][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:22,518][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:22,518][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:22,524][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:22,525][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:22,530][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:22,531][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:22,537][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:22,537][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:22,543][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:22,543][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:22,549][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:22,549][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:22,555][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:22,555][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:22,571][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:22,571][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:22,571][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199997400.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:22,585][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.15]: transaction {
  id: "0115052900000000001195"
  dev_id: "111"
  operator_id: "OPERATOR-111"
  merchant_id: "111"
  create_time: 1432890802000
  trans_type: 200
  game_id: "LFN-1"
  game_type: 15
  total_amount: "2600.0"
}
multi_draw: 2
total_amount: "2600.0"
serial_no: "y013eOifYgLRjcmw7N8vMiebUvmpX9Wv"
game_instance {
  id: "GII-112"
}
entries {
  selected_number: "2,7,13,24,25,36"
  bet_option: 53
  total_bets: 20
  entry_amount: "1200.0"
  input_channel: "2"
}
entries {
  selected_number: "5"
  bet_option: 1
  total_bets: 1
  entry_amount: "100.0"
  input_channel: "2"
}

[2015-05-29 17:13:22,585][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:22,585][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:22,585][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket),mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml
[2015-05-29 17:13:22,585][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:22,586][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml).
[2015-05-29 17:13:22,586][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890802236|Timestamp:20150529171322|Transaction-Type:4200|Transaction-Id:0115052900000000001195|Response-Code:200|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300008078" type="1" lastDrawNo="11003" barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqY/Arvx66Gts=" validationCode="660637" multipleDraws="2" totalBets="42" totalAmount="2600.0"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0"/></Ticket>):7c2ae3f706fcc767c6b8a1d52634b59c
[2015-05-29 17:13:22,587][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=672) succesfully.
[2015-05-29 17:13:22,587][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=672): <?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300008078" type="1" lastDrawNo="11003" barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqY/Arvx66Gts=" validationCode="660637" multipleDraws="2" totalBets="42" totalAmount="2600.0"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0"/></Ticket>
[2015-05-29 17:13:22,587][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:22,594][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.201).
[2015-05-29 17:13:22,594][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/CancelTicket_Req.xml).
[2015-05-29 17:13:22,595][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890802594|Timestamp:20150529171322|Transaction-Type:201|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300008078" isMannul="1"/>,hash=1846971101), get digest:98d16f3079ad04a454be0be6840cf92b
[2015-05-29 17:13:22,595][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=201).
[2015-05-29 17:13:22,595][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:22,595][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171322).
[2015-05-29 17:13:22,595][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:22,595][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890802594).
[2015-05-29 17:13:22,595][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:22,595][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:22,595][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=98d16f3079ad04a454be0be6840cf92b).
[2015-05-29 17:13:22,595][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:22,595][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:22,595][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:22,598][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6ttFDFcpmi1MamgAomcAmY77ZmH0pucSJt0uEHFSyYt5CC2BvJqckOh7rUGfPtBfAHGmJBfyKzPD.
[2015-05-29 17:13:22,598][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890802594|Timestamp:20150529171322|Transaction-Type:201|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:22,598][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300008078" isMannul="1"/>
[2015-05-29 17:13:22,598][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890802594|Timestamp:20150529171322|Transaction-Type:201|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300008078" isMannul="1"/>,hash=1846971101), get digest:98d16f3079ad04a454be0be6840cf92b
[2015-05-29 17:13:22,598][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.201).
[2015-05-29 17:13:22,598][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/CancelTicket_Req.xml
[2015-05-29 17:13:22,598][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.201).
[2015-05-29 17:13:22,615][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_201_1.5.0).
[2015-05-29 17:13:22,615][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_201_).
[2015-05-29 17:13:22,615][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_201_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.cancelByTicket(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:22,623][Test worker][DEBUG][ReversalOrCancelStrategyFactory] Found ReversalStrategy(class com.mpos.lottery.te.gameimpl.lfn.sale.service.LfnSaleService) to cancel transaction(gameType=15,terminalId=111,transType=200,protocolVersion=1.5.0).
[2015-05-29 17:13:22,628][Test worker][ERROR][TEPortServlet] No manual cancellation allowed of game (gameId=LFN-1).
com.mpos.lottery.te.config.exception.ApplicationException: No manual cancellation allowed of game (gameId=LFN-1).
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.allowManualCancellation(AbstractTicketService.java:376)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.cancelByTicket(AbstractTicketService.java:217)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.cancelOrReverse(AbstractTicketService.java:283)
	at com.mpos.lottery.te.trans.service.impl.TransactionServiceImpl.reverseOrCancel(TransactionServiceImpl.java:203)
	at com.mpos.lottery.te.trans.service.impl.TransactionServiceImpl.reverseOrCancel(TransactionServiceImpl.java:227)
	at sun.reflect.GeneratedMethodAccessor288.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy55.reverseOrCancel(Unknown Source)
	at com.mpos.lottery.te.gameimpl.lfn.LfnController.cancelByTicket(LfnController.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.lfn.sale.LfnMannualCancelByTicketIntegrationTest.testCancel_Game_Disable(LfnMannualCancelByTicketIntegrationTest.java:104)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:22,629][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890802594|Timestamp:20150529171322|Transaction-Type:4201|Transaction-Id:0115052900000000001242|Response-Code:261|):6f7743cf297e59e41d9b883be4a842a4
[2015-05-29 17:13:22,630][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=261,length=0): 
[2015-05-29 17:13:22,642][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:22,643][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:22,643][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@5cef09e9) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:22,643][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:22,643][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:22,643][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnMannualCancelByTicketIntegrationTest.testCancel_OK                                                                  |
[2015-05-29 17:13:22,643][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:22,644][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:22,645][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:22,645][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890802644|Timestamp:20150529171322|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=1969560081), get digest:e5da885f30f8aa7e578f79ce3127619e
[2015-05-29 17:13:22,645][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:22,645][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:22,645][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171322).
[2015-05-29 17:13:22,645][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:22,646][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890802644).
[2015-05-29 17:13:22,646][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:22,646][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:22,646][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=e5da885f30f8aa7e578f79ce3127619e).
[2015-05-29 17:13:22,646][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:22,646][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:22,646][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:22,647][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9L2k05jXFbPjS1FsBBTLuWj4a8kJVsM72/YMzruGEM7DWPI5uQU+kvE7y74H12t4zbaRoUQTDb7n/h8zAxrh6Hn2mtyfU/CYtxKe3z/Py5RlIQZDC6AG8TrAvhb3G3SNDjlu4Vxm32uHjs7iClqnt2hDh9rhQSOHhB9K5LUL3NVo8dKwh6SCwM56BaXiK557zz5HaYz2004U1raT6OlReAP7pgHuknsbfxdYkwSI2v0wkzsQ/uHRPv01BVY1tFvgu1/1csAMYBq+O2tRLIhXeAoIJOVLJJPvPHAkozf5FsxcYBza1aivogG1+z8aPrO9uA0h0ScFgQ8LmCP5AX0mf6ruPkYWDcmUtW5ansd9eHP+N72iCfLshuhdBbTWGleRy.
[2015-05-29 17:13:22,648][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890802644|Timestamp:20150529171322|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:22,648][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>
[2015-05-29 17:13:22,648][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890802644|Timestamp:20150529171322|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=1969560081), get digest:e5da885f30f8aa7e578f79ce3127619e
[2015-05-29 17:13:22,648][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:22,648][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:22,648][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:22,663][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_1.5.0).
[2015-05-29 17:13:22,663][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_).
[2015-05-29 17:13:22,663][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_200_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:22,670][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance) by(number=11002,gameId=LFN-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:22,675][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:22,675][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01111745519300008137
[2015-05-29 17:13:22,681][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:22,683][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMu2l+EHVWqpw) as 80000
[2015-05-29 17:13:22,687][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMu2l+EHVWqpw, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:22,687][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:22,687][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:22,693][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMu2l+EHVWqpw) as 80000
[2015-05-29 17:13:22,695][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMu2l+EHVWqpw, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:22,695][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:22,695][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:22,701][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:22,702][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:22,709][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:22,709][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:22,715][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:22,715][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:22,722][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:22,722][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:22,728][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:22,728][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:22,735][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:22,735][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:22,741][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:22,741][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:22,747][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:22,747][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:22,753][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:22,753][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:22,760][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:22,760][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:22,766][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:22,766][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:22,773][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:22,773][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:22,779][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:22,779][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:22,786][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:22,786][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:22,792][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:22,792][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:22,798][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:22,798][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:22,804][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:22,804][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:22,811][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:22,811][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:22,817][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:22,817][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:22,823][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMu2l+EHVWqpw) as 80000
[2015-05-29 17:13:22,825][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMu2l+EHVWqpw, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:22,825][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:22,825][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:22,832][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMu2l+EHVWqpw) as 80000
[2015-05-29 17:13:22,834][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMu2l+EHVWqpw, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:22,834][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:22,834][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:22,840][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:22,840][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:22,847][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:22,847][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:22,853][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:22,853][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:22,860][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:22,860][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:22,866][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:22,866][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:22,873][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:22,873][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:22,879][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:22,879][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:22,885][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:22,885][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:22,891][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:22,891][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:22,899][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:22,899][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:22,906][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:22,906][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:22,913][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:22,913][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:22,919][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:22,919][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:22,925][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:22,925][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:22,931][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:22,931][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:22,938][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:22,938][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:22,944][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:22,944][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:22,950][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:22,950][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:22,957][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:22,957][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:22,974][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:22,974][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:22,975][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199997400.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:22,988][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.15]: transaction {
  id: "0115052900000000001243"
  dev_id: "111"
  operator_id: "OPERATOR-111"
  merchant_id: "111"
  create_time: 1432890802000
  trans_type: 200
  game_id: "LFN-1"
  game_type: 15
  total_amount: "2600.0"
}
multi_draw: 2
total_amount: "2600.0"
serial_no: "y013eOifYgLRjcmw7N8vMu2l+EHVWqpw"
game_instance {
  id: "GII-112"
}
entries {
  selected_number: "2,7,13,24,25,36"
  bet_option: 53
  total_bets: 20
  entry_amount: "1200.0"
  input_channel: "2"
}
entries {
  selected_number: "5"
  bet_option: 1
  total_bets: 1
  entry_amount: "100.0"
  input_channel: "2"
}

[2015-05-29 17:13:22,988][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:22,988][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:22,988][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket),mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml
[2015-05-29 17:13:22,989][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:22,989][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml).
[2015-05-29 17:13:22,990][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890802644|Timestamp:20150529171322|Transaction-Type:4200|Transaction-Id:0115052900000000001243|Response-Code:200|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300008137" type="1" lastDrawNo="11003" barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqLUdrNaXDkIM=" validationCode="271022" multipleDraws="2" totalBets="42" totalAmount="2600.0"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0"/></Ticket>):4c8a3818004eb473d9e6e145372a5a4f
[2015-05-29 17:13:22,990][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=672) succesfully.
[2015-05-29 17:13:22,990][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=672): <?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300008137" type="1" lastDrawNo="11003" barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqLUdrNaXDkIM=" validationCode="271022" multipleDraws="2" totalBets="42" totalAmount="2600.0"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0"/></Ticket>
[2015-05-29 17:13:22,990][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:22,998][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.201).
[2015-05-29 17:13:22,998][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/CancelTicket_Req.xml).
[2015-05-29 17:13:22,998][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890802998|Timestamp:20150529171322|Transaction-Type:201|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300008137" isMannul="1"/>,hash=-760749543), get digest:06dab25cb13981af70a3b68a2b73aa13
[2015-05-29 17:13:22,999][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=201).
[2015-05-29 17:13:22,999][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:22,999][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171322).
[2015-05-29 17:13:22,999][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:22,999][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890802998).
[2015-05-29 17:13:22,999][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:22,999][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:22,999][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=06dab25cb13981af70a3b68a2b73aa13).
[2015-05-29 17:13:22,999][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:22,999][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:22,999][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:23,000][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6ttFDFcpmi1MamgAomcAmY77ZmH0pucSJt0uEHFSyYt50ofNeQ39KIOrjzHPu4KDdeO2aglK3osu.
[2015-05-29 17:13:23,001][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890802998|Timestamp:20150529171322|Transaction-Type:201|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:23,001][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300008137" isMannul="1"/>
[2015-05-29 17:13:23,001][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890802998|Timestamp:20150529171322|Transaction-Type:201|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300008137" isMannul="1"/>,hash=-760749543), get digest:06dab25cb13981af70a3b68a2b73aa13
[2015-05-29 17:13:23,001][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.201).
[2015-05-29 17:13:23,001][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/CancelTicket_Req.xml
[2015-05-29 17:13:23,001][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.201).
[2015-05-29 17:13:23,016][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_201_1.5.0).
[2015-05-29 17:13:23,016][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_201_).
[2015-05-29 17:13:23,016][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_201_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.cancelByTicket(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:23,024][Test worker][DEBUG][ReversalOrCancelStrategyFactory] Found ReversalStrategy(class com.mpos.lottery.te.gameimpl.lfn.sale.service.LfnSaleService) to cancel transaction(gameType=15,terminalId=111,transType=200,protocolVersion=1.5.0).
[2015-05-29 17:13:23,038][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199997400, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=520]
[2015-05-29 17:13:23,038][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:23,038][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=520]
[2015-05-29 17:13:23,108][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.CANCEL.200.15]: origTrans {
  id: "0115052900000000001243"
  dev_id: "111"
  operator_id: "OPERATOR-111"
  merchant_id: "111"
  create_time: 1432890802000
  trans_type: 200
  game_id: "LFN-1"
  game_type: 15
  total_amount: "2600"
}
cancelTrans {
  id: "0115052900000000001290"
  dev_id: "111"
  operator_id: "OPERATOR-111"
  merchant_id: "111"
  create_time: 1432890803000
  trans_type: 210
  game_id: "LFN-1"
  game_type: 15
  total_amount: "2600"
}

[2015-05-29 17:13:23,108][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:23,108][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890802998|Timestamp:20150529171323|Transaction-Type:4201|Transaction-Id:0115052900000000001290|Response-Code:200|):c510794b4913a8d6d82fa95468ae1de5
[2015-05-29 17:13:23,109][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=0): 
[2015-05-29 17:13:23,129][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:23,129][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:23,129][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@5f74f821) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:23,130][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:23,130][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:23,130][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnMannualCancelByTicketIntegrationTest.testCancel_GameInstance_Disable                                                |
[2015-05-29 17:13:23,130][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:23,131][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:23,132][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:23,133][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803131|Timestamp:20150529171323|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=1159063578), get digest:29da6f94958264632dc62f1c17b08e27
[2015-05-29 17:13:23,133][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:23,133][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:23,133][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171323).
[2015-05-29 17:13:23,133][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:23,133][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890803131).
[2015-05-29 17:13:23,133][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:23,133][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:23,133][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=29da6f94958264632dc62f1c17b08e27).
[2015-05-29 17:13:23,133][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:23,133][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:23,133][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:23,135][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9L2k05jXFbPjS1FsBBTLuWj4a8kJVsM72/YMzruGEM7DWPI5uQU+kvE7y74H12t4zbaRoUQTDb7n/h8zAxrh6Hn2mtyfU/CYtxKe3z/Py5RlIQZDC6AG8TrAvhb3G3SNDjlu4Vxm32uHjs7iClqnt2hDh9rhQSOHhB9K5LUL3NVo8dKwh6SCwM56BaXiK557zz5HaYz2004U1raT6OlReAP7pgHuknsbfxdYkwSI2v0wkzsQ/uHRPv01BVY1tFvgu1/1csAMYBq+O2tRLIhXeAoIJOVLJJPvPHAkozf5FsxcYBza1aivogG1+z8aPrO9uA0h0ScFgQ8LmCP5AX0mf6ruPkYWDcmUtW5ansd9eHP+N72iCfLshuhdBbTWGleRy.
[2015-05-29 17:13:23,135][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803131|Timestamp:20150529171323|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:23,135][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>
[2015-05-29 17:13:23,135][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803131|Timestamp:20150529171323|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=1159063578), get digest:29da6f94958264632dc62f1c17b08e27
[2015-05-29 17:13:23,135][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:23,135][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:23,135][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:23,149][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_1.5.0).
[2015-05-29 17:13:23,149][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_).
[2015-05-29 17:13:23,149][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_200_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:23,157][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance) by(number=11002,gameId=LFN-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:23,161][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:23,161][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01111745519300008283
[2015-05-29 17:13:23,167][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:23,170][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMuBkPwjQMfKn) as 80000
[2015-05-29 17:13:23,173][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMuBkPwjQMfKn, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:23,173][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:23,173][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:23,180][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMuBkPwjQMfKn) as 80000
[2015-05-29 17:13:23,183][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMuBkPwjQMfKn, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:23,183][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:23,183][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:23,190][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:23,190][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:23,196][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:23,196][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:23,203][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:23,203][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:23,211][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:23,212][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:23,218][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:23,218][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:23,225][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:23,225][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:23,232][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:23,232][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:23,239][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:23,240][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:23,246][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:23,246][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:23,253][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:23,253][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:23,264][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:23,264][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:23,271][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:23,271][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:23,277][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:23,277][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:23,284][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:23,284][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:23,290][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:23,290][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:23,297][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:23,297][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:23,303][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:23,304][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:23,310][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:23,310][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:23,317][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:23,317][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:23,323][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMuBkPwjQMfKn) as 80000
[2015-05-29 17:13:23,325][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMuBkPwjQMfKn, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:23,325][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:23,325][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:23,331][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMuBkPwjQMfKn) as 80000
[2015-05-29 17:13:23,333][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMuBkPwjQMfKn, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:23,334][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:23,334][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:23,340][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:23,340][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:23,346][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:23,346][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:23,353][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:23,353][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:23,359][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:23,359][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:23,365][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:23,365][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:23,372][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:23,372][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:23,379][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:23,379][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:23,385][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:23,385][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:23,391][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:23,392][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:23,398][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:23,398][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:23,404][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:23,404][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:23,411][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:23,411][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:23,419][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:23,419][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:23,426][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:23,426][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:23,432][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:23,432][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:23,439][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:23,440][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:23,454][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:23,454][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:23,461][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:23,461][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:23,468][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:23,468][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:23,483][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:23,483][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:23,483][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199997400.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:23,497][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.15]: transaction {
  id: "0115052900000000001291"
  dev_id: "111"
  operator_id: "OPERATOR-111"
  merchant_id: "111"
  create_time: 1432890803000
  trans_type: 200
  game_id: "LFN-1"
  game_type: 15
  total_amount: "2600.0"
}
multi_draw: 2
total_amount: "2600.0"
serial_no: "y013eOifYgLRjcmw7N8vMuBkPwjQMfKn"
game_instance {
  id: "GII-112"
}
entries {
  selected_number: "2,7,13,24,25,36"
  bet_option: 53
  total_bets: 20
  entry_amount: "1200.0"
  input_channel: "2"
}
entries {
  selected_number: "5"
  bet_option: 1
  total_bets: 1
  entry_amount: "100.0"
  input_channel: "2"
}

[2015-05-29 17:13:23,497][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:23,497][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:23,497][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket),mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml
[2015-05-29 17:13:23,497][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:23,498][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml).
[2015-05-29 17:13:23,498][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803131|Timestamp:20150529171323|Transaction-Type:4200|Transaction-Id:0115052900000000001291|Response-Code:200|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300008283" type="1" lastDrawNo="11003" barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIq+NPDzc5yRyw=" validationCode="846418" multipleDraws="2" totalBets="42" totalAmount="2600.0"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0"/></Ticket>):2b17003ccf7b5e1484fb8fac441681af
[2015-05-29 17:13:23,499][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=672) succesfully.
[2015-05-29 17:13:23,499][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=672): <?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300008283" type="1" lastDrawNo="11003" barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIq+NPDzc5yRyw=" validationCode="846418" multipleDraws="2" totalBets="42" totalAmount="2600.0"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0"/></Ticket>
[2015-05-29 17:13:23,499][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:23,506][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.201).
[2015-05-29 17:13:23,506][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/CancelTicket_Req.xml).
[2015-05-29 17:13:23,507][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803506|Timestamp:20150529171323|Transaction-Type:201|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300008283" isMannul="1"/>,hash=-1782059344), get digest:5d2290baaf31ad3f7f2056c1c73bb169
[2015-05-29 17:13:23,507][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=201).
[2015-05-29 17:13:23,507][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:23,507][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171323).
[2015-05-29 17:13:23,507][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:23,507][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890803506).
[2015-05-29 17:13:23,507][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:23,507][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:23,507][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=5d2290baaf31ad3f7f2056c1c73bb169).
[2015-05-29 17:13:23,507][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:23,507][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:23,507][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:23,509][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6ttFDFcpmi1MamgAomcAmY77ZmH0pucSJt0uEHFSyYt5bqu0fATsXmHuF1VKeJJK+oIAkN/i6R9S.
[2015-05-29 17:13:23,509][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803506|Timestamp:20150529171323|Transaction-Type:201|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:23,509][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300008283" isMannul="1"/>
[2015-05-29 17:13:23,509][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803506|Timestamp:20150529171323|Transaction-Type:201|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300008283" isMannul="1"/>,hash=-1782059344), get digest:5d2290baaf31ad3f7f2056c1c73bb169
[2015-05-29 17:13:23,509][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.201).
[2015-05-29 17:13:23,509][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/CancelTicket_Req.xml
[2015-05-29 17:13:23,509][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.201).
[2015-05-29 17:13:23,525][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_201_1.5.0).
[2015-05-29 17:13:23,525][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_201_).
[2015-05-29 17:13:23,525][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_201_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.cancelByTicket(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:23,532][Test worker][DEBUG][ReversalOrCancelStrategyFactory] Found ReversalStrategy(class com.mpos.lottery.te.gameimpl.lfn.sale.service.LfnSaleService) to cancel transaction(gameType=15,terminalId=111,transType=200,protocolVersion=1.5.0).
[2015-05-29 17:13:23,537][Test worker][ERROR][TEPortServlet] No manual cancellation allowed of game instance(gameId=LFN-1,number=11002).
com.mpos.lottery.te.config.exception.ApplicationException: No manual cancellation allowed of game instance(gameId=LFN-1,number=11002).
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.allowManualCancellation(AbstractTicketService.java:366)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.cancelByTicket(AbstractTicketService.java:217)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.cancelOrReverse(AbstractTicketService.java:283)
	at com.mpos.lottery.te.trans.service.impl.TransactionServiceImpl.reverseOrCancel(TransactionServiceImpl.java:203)
	at com.mpos.lottery.te.trans.service.impl.TransactionServiceImpl.reverseOrCancel(TransactionServiceImpl.java:227)
	at sun.reflect.GeneratedMethodAccessor288.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy55.reverseOrCancel(Unknown Source)
	at com.mpos.lottery.te.gameimpl.lfn.LfnController.cancelByTicket(LfnController.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.lfn.sale.LfnMannualCancelByTicketIntegrationTest.testCancel_GameInstance_Disable(LfnMannualCancelByTicketIntegrationTest.java:139)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:23,538][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803506|Timestamp:20150529171323|Transaction-Type:4201|Transaction-Id:0115052900000000001338|Response-Code:261|):30e6a4a3e044ba535e5294319b61bd9a
[2015-05-29 17:13:23,538][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=261,length=0): 
]]></system-out>
  <system-err><![CDATA[]]></system-err>
</testsuite>

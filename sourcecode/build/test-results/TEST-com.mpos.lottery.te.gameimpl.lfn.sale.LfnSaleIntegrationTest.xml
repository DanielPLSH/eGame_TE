<?xml version="1.0" encoding="UTF-8"?>
<testsuite name="com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest" tests="14" skipped="0" failures="0" errors="0" timestamp="2015-05-29T09:13:19" hostname="Ramon-PC" time="2.423">
  <properties/>
  <testcase name="testSell_UnsupportedInputChannel" classname="com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest" time="0.031"/>
  <testcase name="testSell_GameInstanceSuspendSale" classname="com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest" time="0.042"/>
  <testcase name="testSell_SingleDraw_OK" classname="com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest" time="0.26"/>
  <testcase name="testSell_NBetoptionGreaterThanK" classname="com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest" time="0.051"/>
  <testcase name="testSell_MultiDraw_UseParentCredit_VerifyBalanceLog_OK" classname="com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest" time="0.391"/>
  <testcase name="testSell_PBetoptionGreaterThanK" classname="com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest" time="0.049"/>
  <testcase name="testSell_MultiDraw_DefiniteCredit_VerifyBalanceLog_OK" classname="com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest" time="0.481"/>
  <testcase name="testSell_Exceed_MerchantAllowedMaxMultiple" classname="com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest" time="0.068"/>
  <testcase name="testSell_Exceed_MerchantAllowedMutiDraw" classname="com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest" time="0.049"/>
  <testcase name="testSell_AfterSettlement" classname="com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest" time="0.031"/>
  <testcase name="testSell_Under_EntryAmountLimit" classname="com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest" time="0.046"/>
  <testcase name="testEnquiryQP" classname="com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest" time="0.081"/>
  <testcase name="testSell_MultiDraw_OK" classname="com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest" time="0.393"/>
  <testcase name="testSell_MultiDraw_QP_OK" classname="com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest" time="0.445"/>
  <system-out><![CDATA[[2015-05-29 17:13:19,181][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:19,181][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:19,181][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@8fa6206) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:19,182][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:19,182][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:19,182][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnSaleIntegrationTest.testSell_UnsupportedInputChannel                                                                |
[2015-05-29 17:13:19,182][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:19,182][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:19,183][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:19,184][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799182|Timestamp:20150529171319|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="4" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=-1447724989), get digest:78ec474963c574a85dc0560ae4320451
[2015-05-29 17:13:19,184][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:19,184][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:19,184][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171319).
[2015-05-29 17:13:19,184][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:19,184][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890799182).
[2015-05-29 17:13:19,184][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:19,184][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:19,184][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=78ec474963c574a85dc0560ae4320451).
[2015-05-29 17:13:19,184][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:19,184][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:19,184][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:19,186][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9L2k05jXFbPjS1FsBBTLuWj4a8kJVsM72/YMzruGEM7DWPI5uQU+kvE7y74H12t4zbaRoUQTDb7n/h8zAxrh6Hn2mtyfU/CYtxKe3z/Py5RlIQZDC6AG8TrAvhb3G3SNDjlu4Vxm32uHjs7iClqnt2hDh9rhQSOHhNByrwHJgXnKA86J1xw9GTZhN9fxEr8wQdJ5fM5+i47U1kQNwVd39I2hGhq+FwgkXDg2Yr3Lvo6qFxO+CsaTIOO9nlWMXZER/C1uwTicycyijydOrkfee98PHfTdlU0rGvl96d6x1EUxReByE0cRCa36I/WQw/YEKGI8+AYWCr343cvroDON3vnHeZSFeHwXWrqloWxBeMjVejwQKGcchvWEaqi9da3kF.
[2015-05-29 17:13:19,186][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799182|Timestamp:20150529171319|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:19,187][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="4" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>
[2015-05-29 17:13:19,187][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799182|Timestamp:20150529171319|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="4" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=-1447724989), get digest:78ec474963c574a85dc0560ae4320451
[2015-05-29 17:13:19,187][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:19,187][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:19,187][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:19,191][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:19,191][Test worker][ERROR][TEPortServlet] Fail to parse message body(mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml):<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="4" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>
com.mpos.lottery.te.config.exception.MessageFormatException: unsupported input channel of entry:4
	at com.mpos.lottery.te.gamespec.sale.BaseEntry.setInputChannel(BaseEntry.java:128)
	at com.mpos.lottery.te.gamespec.sale.BaseEntry.setInputChannel(BaseEntry.java:119)
	at sun.reflect.GeneratedMethodAccessor39.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.exolab.castor.mapping.loader.FieldHandlerImpl.setValue(FieldHandlerImpl.java:515)
	at org.exolab.castor.xml.UnmarshalHandler.setAttributeValueOnObject(UnmarshalHandler.java:3164)
	at org.exolab.castor.xml.UnmarshalHandler.processAttribute(UnmarshalHandler.java:3111)
	at org.exolab.castor.xml.UnmarshalHandler.processAttributes(UnmarshalHandler.java:2776)
	at org.exolab.castor.xml.UnmarshalHandler.startElement(UnmarshalHandler.java:2407)
	at org.exolab.castor.xml.UnmarshalHandler.startElement(UnmarshalHandler.java:1435)
	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.startElement(AbstractSAXParser.java:509)
	at com.sun.org.apache.xerces.internal.parsers.AbstractXMLDocumentParser.emptyElement(AbstractXMLDocumentParser.java:182)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(XMLDocumentFragmentScannerImpl.java:1343)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2786)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:606)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:510)
	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:848)
	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:777)
	at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:141)
	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1213)
	at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:648)
	at org.exolab.castor.xml.Unmarshaller.unmarshal(Unmarshaller.java:748)
	at com.mpos.lottery.te.port.protocol.CastorHelper.unmarshal(CastorHelper.java:39)
	at com.mpos.lottery.te.port.protocol.ProtocolSerializer.deserialize(ProtocolSerializer.java:78)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:108)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest.testSell_UnsupportedInputChannel(LfnSaleIntegrationTest.java:574)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:19,193][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=210,length=0): 
[2015-05-29 17:13:19,199][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:19,200][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:19,200][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@4ca9aed5) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:19,200][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:19,200][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:19,200][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnSaleIntegrationTest.testSell_GameInstanceSuspendSale                                                                |
[2015-05-29 17:13:19,200][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:19,202][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:19,203][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:19,203][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799202|Timestamp:20150529171319|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=29622936), get digest:1191805f8d5d8becb34c95ebc922867b
[2015-05-29 17:13:19,203][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:19,204][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:19,204][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171319).
[2015-05-29 17:13:19,204][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:19,204][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890799202).
[2015-05-29 17:13:19,204][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:19,204][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:19,204][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=1191805f8d5d8becb34c95ebc922867b).
[2015-05-29 17:13:19,204][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:19,204][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:19,204][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:19,205][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9L2k05jXFbPjS1FsBBTLuWj4a8kJVsM72/YMzruGEM7DWPI5uQU+kvE7y74H12t4zbaRoUQTDb7n/h8zAxrh6Hn2mtyfU/CYtxKe3z/Py5RlIQZDC6AG8TrAvhb3G3SNDjlu4Vxm32uHjs7iClqnt2hDh9rhQSOHhB9K5LUL3NVo8dKwh6SCwM56BaXiK557zz5HaYz2004U1raT6OlReAP7pgHuknsbfxdYkwSI2v0wkzsQ/uHRPv01BVY1tFvgu1/1csAMYBq+O2tRLIhXeAoIJOVLJJPvPHAkozf5FsxcYBza1aivogG1+z8aPrO9uA0h0ScFgQ8LmCP5AX0mf6ruPkYWDcmUtW5ansd9eHP+N72iCfLshuhdBbTWGleRy.
[2015-05-29 17:13:19,206][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799202|Timestamp:20150529171319|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:19,206][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>
[2015-05-29 17:13:19,206][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799202|Timestamp:20150529171319|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=29622936), get digest:1191805f8d5d8becb34c95ebc922867b
[2015-05-29 17:13:19,206][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:19,206][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:19,206][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:19,220][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_1.5.0).
[2015-05-29 17:13:19,220][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_).
[2015-05-29 17:13:19,220][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_200_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:19,228][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance) by(number=11002,gameId=LFN-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:19,232][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:19,232][Test worker][ERROR][AbstractGameInstanceService] The game instance(number=11002,game.type=15,status=2,startSellintTime=2015-05-28 17:12:14.0,stopSellTime=2015-05-30 17:12:14.0,suspendSale=true) doesn't accept sale.
[2015-05-29 17:13:19,233][Test worker][ERROR][TEPortServlet] Game instance has suspended sale.
com.mpos.lottery.te.config.exception.ApplicationException: Game instance has suspended sale.
	at com.mpos.lottery.te.gamespec.game.service.impl.AbstractGameInstanceService.allowSale(AbstractGameInstanceService.java:242)
	at com.mpos.lottery.te.gamespec.game.service.impl.AbstractGameInstanceService.doEnquiryMultiDraw(AbstractGameInstanceService.java:182)
	at com.mpos.lottery.te.gamespec.game.service.impl.AbstractGameInstanceService.enquirySaleReady(AbstractGameInstanceService.java:98)
	at sun.reflect.GeneratedMethodAccessor131.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy54.enquirySaleReady(Unknown Source)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.lookupSaleReadyGameInstance(AbstractTicketService.java:348)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:123)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(LfnController.java:38)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest.testSell_GameInstanceSuspendSale(LfnSaleIntegrationTest.java:512)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:19,234][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799202|Timestamp:20150529171319|Transaction-Type:4200|Transaction-Id:0115052900000000000943|Response-Code:310|):18cc7517775b81eaedf4c322358c6e0e
[2015-05-29 17:13:19,234][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=310,length=0): 
[2015-05-29 17:13:19,242][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:19,242][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:19,242][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@24762e5d) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:19,243][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:19,243][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:19,243][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnSaleIntegrationTest.testSell_SingleDraw_OK                                                                          |
[2015-05-29 17:13:19,243][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:19,248][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:19,249][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:19,250][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799248|Timestamp:20150529171319|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="1" totalAmount="1300.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=1142516407), get digest:732f23ab2391e7714700f2af6fdf0d6a
[2015-05-29 17:13:19,250][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:19,250][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:19,250][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171319).
[2015-05-29 17:13:19,250][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:19,250][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890799248).
[2015-05-29 17:13:19,250][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:19,250][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:19,250][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=732f23ab2391e7714700f2af6fdf0d6a).
[2015-05-29 17:13:19,250][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:19,251][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:19,251][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:19,253][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfnfSvzUuvi5gIW+x7OzQghYnwXyabognesXFM+tQN6PmBbk3fSgyYq6ER4Mr0D9oAX5XX0CIUJ55wuyFGW/pJUyCpc/Opm/WtqiM+VAT8DFpap6jWN0Gu57ptGEXoF4lQjOLXNjImzkkzhUbutD50GycJJcsJ1T/T7d4TPEIMRC7RPz6Ak7b9Ou4XfT+5DrKFaFAuRRwInbx7OEXxAjlDAgEpNi3oG31C5PYdzV/Dkki0T0izqwl4/V55p5ff5zQl/BgijCil2a4j8TFfwZJ5y0t5EC/M96OQMDVEU0VOGnjjm6nKhDnYOXbrsnCOJZMEXBtHhQpyD2RGWqUlyyl/55J6JAi+l16SB8TONJDjGmPifgg/tfFpOts9PYj+ScKOInvEeH4J0cdP4gilXVaFa0y.
[2015-05-29 17:13:19,253][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799248|Timestamp:20150529171319|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:19,253][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="1" totalAmount="1300.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>
[2015-05-29 17:13:19,253][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799248|Timestamp:20150529171319|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="1" totalAmount="1300.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=1142516407), get digest:732f23ab2391e7714700f2af6fdf0d6a
[2015-05-29 17:13:19,254][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:19,254][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:19,254][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:19,267][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_1.5.0).
[2015-05-29 17:13:19,267][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_).
[2015-05-29 17:13:19,267][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_200_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:19,277][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:19,277][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01111745519300006586
[2015-05-29 17:13:19,283][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:19,286][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMisSSbjnFLwB) as 80000
[2015-05-29 17:13:19,290][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMisSSbjnFLwB, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:19,290][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:19,290][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:19,297][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMisSSbjnFLwB) as 80000
[2015-05-29 17:13:19,300][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMisSSbjnFLwB, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:19,300][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:19,300][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:19,307][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:19,307][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:19,313][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:19,314][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:19,320][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:19,320][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:19,326][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:19,326][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:19,334][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:19,334][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:19,341][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:19,341][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:19,348][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:19,348][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:19,356][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:19,356][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:19,363][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:19,363][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:19,370][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:19,370][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:19,377][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:19,377][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:19,384][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:19,384][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:19,391][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:19,391][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:19,398][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:19,398][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:19,405][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:19,405][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:19,416][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:19,416][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:19,422][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:19,423][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:19,429][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:19,429][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:19,436][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:19,436][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:19,454][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:19,454][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:19,454][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199998700.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:19,467][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.15]: transaction {
  id: "0115052900000000000944"
  dev_id: "111"
  operator_id: "OPERATOR-111"
  merchant_id: "111"
  create_time: 1432890799000
  trans_type: 200
  game_id: "LFN-1"
  game_type: 15
  total_amount: "1300.0"
}
multi_draw: 1
total_amount: "1300.0"
serial_no: "y013eOifYgLRjcmw7N8vMisSSbjnFLwB"
game_instance {
  id: "GII-112"
}
entries {
  selected_number: "2,7,13,24,25,36"
  bet_option: 53
  total_bets: 20
  entry_amount: "1200.0"
  input_channel: "2"
}
entries {
  selected_number: "5"
  bet_option: 1
  total_bets: 1
  entry_amount: "100.0"
  input_channel: "2"
}

[2015-05-29 17:13:19,467][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:19,467][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:19,467][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket),mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml
[2015-05-29 17:13:19,467][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:19,468][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml).
[2015-05-29 17:13:19,468][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799248|Timestamp:20150529171319|Transaction-Type:4200|Transaction-Id:0115052900000000000944|Response-Code:200|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300006586" type="1" lastDrawNo="11002" barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqT/HpqPJBAtY=" validationCode="837882" multipleDraws="1" totalBets="21" totalAmount="1300.0"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0"/></Ticket>):4a0c6af95286e10a461d9ce4d9363d23
[2015-05-29 17:13:19,468][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=672) succesfully.
[2015-05-29 17:13:19,469][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=672): <?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300006586" type="1" lastDrawNo="11002" barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqT/HpqPJBAtY=" validationCode="837882" multipleDraws="1" totalBets="21" totalAmount="1300.0"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0"/></Ticket>
[2015-05-29 17:13:19,469][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:19,503][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:19,503][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:19,503][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@10e78b6d) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:19,504][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:19,504][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:19,504][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnSaleIntegrationTest.testSell_NBetoptionGreaterThanK                                                                 |
[2015-05-29 17:13:19,504][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:19,504][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:19,505][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:19,506][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799504|Timestamp:20150529171319|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="1,2,3,4,5,6" betOption="6" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=1842745834), get digest:9a25a3e76d3973acc9340bc272fefc8f
[2015-05-29 17:13:19,506][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:19,506][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:19,506][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171319).
[2015-05-29 17:13:19,506][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:19,506][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890799504).
[2015-05-29 17:13:19,506][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:19,506][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:19,506][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=9a25a3e76d3973acc9340bc272fefc8f).
[2015-05-29 17:13:19,506][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:19,506][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:19,506][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:19,508][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9L2k05jXFbPjS1FsBBTLuWj4a8kJVsM72/YMzruGEM7DWPI5uQU+kvE7y74H12t4zbaRoUQTDb7n/h8zAxrh6Hn2mtyfU/CYtxKe3z/Py5RlIQZDC6AG8TkZ4/qhJn+o1qV8BLffE643HNXYL81iVZP+5FalAcWG3glLCKCNAoxn5KxQoXj9jZZjzshQo4ww2zmtDFAog1vB9wBE+UeA3zNTuL5HuoZ6I1EsZlm3tx2UzW7GiJ8Vs+iTmgMyy7kXWnmwn+OeIoJ4kHLDy7fFIoiJw16R4HuL9Tx3OSkoqlmNm3g1YuEUhMEUexYMZPEzUuYvvDdpI5+DPNS/R3u4tNsU/WAvuosR3z9FBXRs0uW8BTV83uG3ezKC53cnfmDi0CnCTFx+fr/U+5ex/LP1oLA==.
[2015-05-29 17:13:19,508][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799504|Timestamp:20150529171319|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:19,508][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="1,2,3,4,5,6" betOption="6" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>
[2015-05-29 17:13:19,509][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799504|Timestamp:20150529171319|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="1,2,3,4,5,6" betOption="6" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=1842745834), get digest:9a25a3e76d3973acc9340bc272fefc8f
[2015-05-29 17:13:19,509][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:19,509][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:19,509][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:19,523][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_1.5.0).
[2015-05-29 17:13:19,523][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_).
[2015-05-29 17:13:19,523][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_200_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:19,531][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance) by(number=11002,gameId=LFN-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:19,536][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:19,536][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01111745519300006649
[2015-05-29 17:13:19,544][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:19,544][Test worker][ERROR][TEPortServlet] Unsupported bet option:6, the N bet option can't be greater than K(5)
com.mpos.lottery.te.config.exception.SystemException: Unsupported bet option:6, the N bet option can't be greater than K(5)
	at com.mpos.lottery.te.gameimpl.lfn.sale.support.validator.LfnNmodeSelectedNumberValidator.customValidateAfter(LfnNmodeSelectedNumberValidator.java:56)
	at com.mpos.lottery.te.gamespec.sale.support.validator.AbstractSelectedNumberValidator.validate(AbstractSelectedNumberValidator.java:60)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validate(DefaultTicketValidator.java:42)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.validateTicketRequest(AbstractTicketService.java:386)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:140)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(LfnController.java:38)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest.testSell_NBetoptionGreaterThanK(LfnSaleIntegrationTest.java:528)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:19,545][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799504|Timestamp:20150529171319|Transaction-Type:4200|Transaction-Id:0115052900000000000969|Response-Code:306|):6c58ca62b04c31e9cd04b21b323ea0ee
[2015-05-29 17:13:19,546][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=306,length=0): 
[2015-05-29 17:13:19,552][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:19,553][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:19,553][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@145334b6) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:19,554][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:19,554][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:19,554][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnSaleIntegrationTest.testSell_MultiDraw_UseParentCredit_VerifyBalanceLog_OK                                          |
[2015-05-29 17:13:19,554][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:19,560][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:19,561][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:19,561][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799560|Timestamp:20150529171319|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=-122679939), get digest:889be1eefa84477631278ed2b8c03db6
[2015-05-29 17:13:19,562][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:19,562][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:19,562][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171319).
[2015-05-29 17:13:19,562][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:19,562][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890799560).
[2015-05-29 17:13:19,562][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:19,562][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:19,562][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=889be1eefa84477631278ed2b8c03db6).
[2015-05-29 17:13:19,562][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:19,562][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:19,562][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:19,564][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9L2k05jXFbPjS1FsBBTLuWj4a8kJVsM72/YMzruGEM7DWPI5uQU+kvE7y74H12t4zbaRoUQTDb7n/h8zAxrh6Hn2mtyfU/CYtxKe3z/Py5RlIQZDC6AG8TrAvhb3G3SNDjlu4Vxm32uHjs7iClqnt2hDh9rhQSOHhB9K5LUL3NVo8dKwh6SCwM56BaXiK557zz5HaYz2004U1raT6OlReAP7pgHuknsbfxdYkwSI2v0wkzsQ/uHRPv01BVY1tFvgu1/1csAMYBq+O2tRLIhXeAoIJOVLJJPvPHAkozf5FsxcYBza1aivogG1+z8aPrO9uA0h0ScFgQ8LmCP5AX0mf6ruPkYWDcmUtW5ansd9eHP+N72iCfLshuhdBbTWGleRy.
[2015-05-29 17:13:19,564][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799560|Timestamp:20150529171319|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:19,564][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>
[2015-05-29 17:13:19,564][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799560|Timestamp:20150529171319|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=-122679939), get digest:889be1eefa84477631278ed2b8c03db6
[2015-05-29 17:13:19,564][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:19,564][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:19,564][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:19,576][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_1.5.0).
[2015-05-29 17:13:19,576][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_).
[2015-05-29 17:13:19,576][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_200_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:19,583][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance) by(number=11002,gameId=LFN-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:19,591][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:19,591][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01111745519300006719
[2015-05-29 17:13:19,597][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:19,599][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMiNzbtnw2VzA) as 80000
[2015-05-29 17:13:19,604][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMiNzbtnw2VzA, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:19,604][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:19,604][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:19,610][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMiNzbtnw2VzA) as 80000
[2015-05-29 17:13:19,612][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMiNzbtnw2VzA, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:19,612][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:19,612][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:19,620][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:19,621][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:19,628][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:19,628][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:19,635][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:19,635][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:19,642][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:19,642][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:19,648][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:19,648][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:19,655][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:19,656][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:19,663][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:19,663][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:19,670][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:19,670][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:19,677][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:19,677][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:19,683][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:19,683][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:19,690][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:19,690][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:19,697][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:19,697][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:19,703][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:19,703][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:19,709][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:19,709][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:19,717][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:19,717][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:19,723][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:19,723][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:19,730][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:19,730][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:19,737][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:19,737][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:19,743][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:19,743][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:19,750][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMiNzbtnw2VzA) as 80000
[2015-05-29 17:13:19,752][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMiNzbtnw2VzA, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:19,752][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:19,752][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:19,759][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMiNzbtnw2VzA) as 80000
[2015-05-29 17:13:19,761][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMiNzbtnw2VzA, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:19,761][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:19,761][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:19,768][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:19,768][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:19,775][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:19,775][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:19,782][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:19,782][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:19,789][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:19,789][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:19,795][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:19,795][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:19,802][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:19,802][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:19,809][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:19,809][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:19,815][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:19,815][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:19,822][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:19,822][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:19,828][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:19,828][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:19,834][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:19,834][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:19,841][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:19,841][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:19,847][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:19,847][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:19,853][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:19,853][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:19,860][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:19,860][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:19,866][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:19,866][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:19,872][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:19,872][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:19,878][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:19,879][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:19,885][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:19,885][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:19,894][Test worker][DEBUG][DefaultBalanceService] Ignore balance calculation of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=4, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0], as its credit type is USE PARENT... check its parent merchant
[2015-05-29 17:13:19,904][Test worker][DEBUG][DefaultBalanceService] Merchant before transaction: Merchant [id=111, name=M-111, saleCreditLevel=100000000, payoutCreditLevel=1000, creditType=1, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:19,904][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:19,904][Test worker][DEBUG][DefaultBalanceService] Merchant after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=4, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:19,920][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.15]: transaction {
  id: "0115052900000000000970"
  dev_id: "111"
  operator_id: "OPERATOR-111"
  merchant_id: "111"
  create_time: 1432890799000
  trans_type: 200
  game_id: "LFN-1"
  game_type: 15
  total_amount: "2600.0"
}
multi_draw: 2
total_amount: "2600.0"
serial_no: "y013eOifYgLRjcmw7N8vMiNzbtnw2VzA"
game_instance {
  id: "GII-112"
}
entries {
  selected_number: "2,7,13,24,25,36"
  bet_option: 53
  total_bets: 20
  entry_amount: "1200.0"
  input_channel: "2"
}
entries {
  selected_number: "5"
  bet_option: 1
  total_bets: 1
  entry_amount: "100.0"
  input_channel: "2"
}

[2015-05-29 17:13:19,920][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:19,920][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:19,920][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket),mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml
[2015-05-29 17:13:19,920][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:19,921][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml).
[2015-05-29 17:13:19,921][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799560|Timestamp:20150529171319|Transaction-Type:4200|Transaction-Id:0115052900000000000970|Response-Code:200|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300006719" type="1" lastDrawNo="11003" barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqYOzJ0jPJ/60=" validationCode="349123" multipleDraws="2" totalBets="42" totalAmount="2600.0"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0"/></Ticket>):ae3d1deb979042bb5de3321f8846d3af
[2015-05-29 17:13:19,922][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=672) succesfully.
[2015-05-29 17:13:19,922][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=672): <?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300006719" type="1" lastDrawNo="11003" barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqYOzJ0jPJ/60=" validationCode="349123" multipleDraws="2" totalBets="42" totalAmount="2600.0"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0"/></Ticket>
[2015-05-29 17:13:19,922][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:19,945][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:19,946][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:19,946][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@d7b0363) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:19,946][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:19,946][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:19,946][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnSaleIntegrationTest.testSell_PBetoptionGreaterThanK                                                                 |
[2015-05-29 17:13:19,946][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:19,946][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:19,947][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:19,948][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799946|Timestamp:20150529171319|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="1,2,3,4,5,6,7,8" betOption="56" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=-105260404), get digest:6cc93b06439a2c1ba03f706c3a727ede
[2015-05-29 17:13:19,948][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:19,948][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:19,948][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171319).
[2015-05-29 17:13:19,948][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:19,948][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890799946).
[2015-05-29 17:13:19,948][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:19,948][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:19,948][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=6cc93b06439a2c1ba03f706c3a727ede).
[2015-05-29 17:13:19,948][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:19,948][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:19,948][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:19,950][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9L2k05jXFbPjS1FsBBTLuWj4a8kJVsM72/YMzruGEM7DWPI5uQU+kvE7y74H12t4zbaRoUQTDb7n/h8zAxrh6Hn2mtyfU/CYtxKe3z/Py5RlIQZDC6AG8TkZ4/qhJn+o1BJJcSwGzPaVRUvL9UB7ofHRjpW/CDvXQulUrQvztIgSPamQHKYrYa1cdKaHqE1rwB/O1MtnJukBA1FOGd0Gg+XzX7sljv5xNVGoJm/K0G9pKfZs5ENk2dJPxtb5eQk8w5srx4xjKpcITzjFjnU2Z1hdoW8SuQ7l0RlV1calfbmCXwqeuyDpoT+yq+s9tWKoq/2jUw8PEZqrgxcrUAcgE6E/MNnZR6pP9PRRCFEN7aZqOBupovE/CsYAV2JxX1frf9FBHHbK44X8Ypx3HJAqA2Q==.
[2015-05-29 17:13:19,950][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799946|Timestamp:20150529171319|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:19,950][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="1,2,3,4,5,6,7,8" betOption="56" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>
[2015-05-29 17:13:19,950][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799946|Timestamp:20150529171319|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="1,2,3,4,5,6,7,8" betOption="56" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=-105260404), get digest:6cc93b06439a2c1ba03f706c3a727ede
[2015-05-29 17:13:19,950][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:19,950][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:19,950][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:19,966][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_1.5.0).
[2015-05-29 17:13:19,966][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_).
[2015-05-29 17:13:19,966][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_200_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:19,973][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance) by(number=11002,gameId=LFN-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:19,978][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:19,978][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01111745519300006867
[2015-05-29 17:13:19,984][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:19,985][Test worker][ERROR][TEPortServlet] Unsupported bet option:56, the P bet option can't be greater than K(55)
com.mpos.lottery.te.config.exception.SystemException: Unsupported bet option:56, the P bet option can't be greater than K(55)
	at com.mpos.lottery.te.gameimpl.lfn.sale.support.validator.LfnPmodeSelectedNumberValidator.customValidateAfter(LfnPmodeSelectedNumberValidator.java:41)
	at com.mpos.lottery.te.gamespec.sale.support.validator.AbstractSelectedNumberValidator.validate(AbstractSelectedNumberValidator.java:60)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validate(DefaultTicketValidator.java:42)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.validateTicketRequest(AbstractTicketService.java:386)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:140)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(LfnController.java:38)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest.testSell_PBetoptionGreaterThanK(LfnSaleIntegrationTest.java:544)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:19,986][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799946|Timestamp:20150529171319|Transaction-Type:4200|Transaction-Id:0115052900000000001017|Response-Code:306|):a8f6c3d30b0eafb122ad5472bef4861b
[2015-05-29 17:13:19,987][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=306,length=0): 
[2015-05-29 17:13:19,994][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:19,994][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:19,994][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@558d4f17) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:19,995][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:19,995][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:19,995][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnSaleIntegrationTest.testSell_MultiDraw_DefiniteCredit_VerifyBalanceLog_OK                                           |
[2015-05-29 17:13:19,995][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:19,999][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:20,000][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:20,001][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799999|Timestamp:20150529171319|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=-38556589), get digest:4999820cfab811a778ceae081261a160
[2015-05-29 17:13:20,001][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:20,001][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:20,001][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171319).
[2015-05-29 17:13:20,001][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:20,001][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890799999).
[2015-05-29 17:13:20,001][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:20,001][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:20,001][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=4999820cfab811a778ceae081261a160).
[2015-05-29 17:13:20,001][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:20,001][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:20,001][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:20,002][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9L2k05jXFbPjS1FsBBTLuWj4a8kJVsM72/YMzruGEM7DWPI5uQU+kvE7y74H12t4zbaRoUQTDb7n/h8zAxrh6Hn2mtyfU/CYtxKe3z/Py5RlIQZDC6AG8TrAvhb3G3SNDjlu4Vxm32uHjs7iClqnt2hDh9rhQSOHhB9K5LUL3NVo8dKwh6SCwM56BaXiK557zz5HaYz2004U1raT6OlReAP7pgHuknsbfxdYkwSI2v0wkzsQ/uHRPv01BVY1tFvgu1/1csAMYBq+O2tRLIhXeAoIJOVLJJPvPHAkozf5FsxcYBza1aivogG1+z8aPrO9uA0h0ScFgQ8LmCP5AX0mf6ruPkYWDcmUtW5ansd9eHP+N72iCfLshuhdBbTWGleRy.
[2015-05-29 17:13:20,003][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799999|Timestamp:20150529171319|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:20,003][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>
[2015-05-29 17:13:20,003][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799999|Timestamp:20150529171319|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=-38556589), get digest:4999820cfab811a778ceae081261a160
[2015-05-29 17:13:20,003][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:20,003][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:20,003][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:20,021][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_1.5.0).
[2015-05-29 17:13:20,021][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_).
[2015-05-29 17:13:20,021][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_200_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:20,029][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance) by(number=11002,gameId=LFN-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:20,034][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:20,034][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01111745519300006987
[2015-05-29 17:13:20,043][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:20,045][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMkvlTyxeOrog) as 80000
[2015-05-29 17:13:20,049][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMkvlTyxeOrog, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:20,049][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:20,049][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:20,055][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMkvlTyxeOrog) as 80000
[2015-05-29 17:13:20,058][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMkvlTyxeOrog, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:20,058][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:20,058][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:20,065][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:20,065][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:20,074][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:20,074][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:20,084][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:20,084][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:20,092][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:20,092][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:20,098][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:20,098][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:20,113][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:20,113][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:20,122][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:20,122][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:20,135][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:20,135][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:20,147][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:20,147][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:20,155][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:20,155][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:20,162][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:20,162][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:20,176][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:20,176][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:20,185][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:20,185][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:20,198][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:20,198][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:20,212][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:20,212][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:20,223][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:20,223][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:20,234][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:20,234][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:20,248][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:20,248][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:20,257][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:20,257][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:20,268][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMkvlTyxeOrog) as 80000
[2015-05-29 17:13:20,270][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMkvlTyxeOrog, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:20,270][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:20,270][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:20,281][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMkvlTyxeOrog) as 80000
[2015-05-29 17:13:20,285][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMkvlTyxeOrog, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:20,286][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:20,286][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:20,295][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:20,295][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:20,302][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:20,302][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:20,309][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:20,309][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:20,316][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:20,316][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:20,323][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:20,323][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:20,330][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:20,330][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:20,338][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:20,338][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:20,345][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:20,345][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:20,352][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:20,352][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:20,359][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:20,359][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:20,366][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:20,366][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:20,373][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:20,373][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:20,380][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:20,380][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:20,390][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:20,390][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:20,396][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:20,396][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:20,403][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:20,403][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:20,409][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:20,409][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:20,416][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:20,416][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:20,423][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:20,423][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:20,440][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:20,440][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:20,440][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199997400.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:20,453][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.15]: transaction {
  id: "0115052900000000001018"
  dev_id: "111"
  operator_id: "OPERATOR-111"
  merchant_id: "111"
  create_time: 1432890800000
  trans_type: 200
  game_id: "LFN-1"
  game_type: 15
  total_amount: "2600.0"
}
multi_draw: 2
total_amount: "2600.0"
serial_no: "y013eOifYgLRjcmw7N8vMkvlTyxeOrog"
game_instance {
  id: "GII-112"
}
entries {
  selected_number: "2,7,13,24,25,36"
  bet_option: 53
  total_bets: 20
  entry_amount: "1200.0"
  input_channel: "2"
}
entries {
  selected_number: "5"
  bet_option: 1
  total_bets: 1
  entry_amount: "100.0"
  input_channel: "2"
}

[2015-05-29 17:13:20,454][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:20,454][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:20,454][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket),mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml
[2015-05-29 17:13:20,454][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:20,455][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml).
[2015-05-29 17:13:20,455][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890799999|Timestamp:20150529171320|Transaction-Type:4200|Transaction-Id:0115052900000000001018|Response-Code:200|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300006987" type="1" lastDrawNo="11003" barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqL2MDwPMOCrE=" validationCode="185964" multipleDraws="2" totalBets="42" totalAmount="2600.0"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0"/></Ticket>):ae20cc59c0e7749dafbabb10dd90af31
[2015-05-29 17:13:20,455][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=672) succesfully.
[2015-05-29 17:13:20,456][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=672): <?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300006987" type="1" lastDrawNo="11003" barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqL2MDwPMOCrE=" validationCode="185964" multipleDraws="2" totalBets="42" totalAmount="2600.0"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0"/></Ticket>
[2015-05-29 17:13:20,456][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:20,476][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:20,477][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:20,477][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@3b5cb1cb) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:20,477][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:20,477][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:20,477][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnSaleIntegrationTest.testSell_Exceed_MerchantAllowedMaxMultiple                                                      |
[2015-05-29 17:13:20,477][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:20,478][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:20,478][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:20,479][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800477|Timestamp:20150529171320|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="79300.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="1,2,3,4,5,6,7,8,9,10,11,12" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=-237383258), get digest:3cb217d4fdcb6abe2b10f51087e49d19
[2015-05-29 17:13:20,479][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:20,479][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:20,479][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171320).
[2015-05-29 17:13:20,479][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:20,479][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890800477).
[2015-05-29 17:13:20,479][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:20,479][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:20,479][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=3cb217d4fdcb6abe2b10f51087e49d19).
[2015-05-29 17:13:20,479][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:20,479][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:20,479][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:20,481][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9MXBuAbPyAkvwxp8vEo2vGA1HhvY69UemHSGlui+FOjG9N4U4I7fJdT/QCrk5BGK5HZXHP0FrFXBlU/CclaBTy411v40ELQPniSWxEQ8ArMuO4IJQXMzYGZl5VnWc2OgR9C9gOfmizrkAWGXW2agXPnDUh1NvvrnAoamn/EnSKDjDftcgr5Mm7cezOrn7q0p4MkwYQdnNxXAxXKwwp2dNg8AYPjEYj2/ecnZd4tAO/AlnfSm6iRuUyche9iSvildLxgK4ixOU70K8D2Z1Ho9TIe6wWnmJ1FxhQ/nf49q5XUY6T+XE/qNuKDT5Vx/1E5LW8E4AOU1NRCZ+Fsxe4A/hekcesOD33XmQilW3UK5Sd5KLWcavr28pVohp8e5/iRIYykNAhu5BJih8yOC9Av/K8A==.
[2015-05-29 17:13:20,481][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800477|Timestamp:20150529171320|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:20,481][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="79300.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="1,2,3,4,5,6,7,8,9,10,11,12" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>
[2015-05-29 17:13:20,482][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800477|Timestamp:20150529171320|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="79300.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="1,2,3,4,5,6,7,8,9,10,11,12" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=-237383258), get digest:3cb217d4fdcb6abe2b10f51087e49d19
[2015-05-29 17:13:20,482][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:20,482][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:20,482][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:20,516][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_1.5.0).
[2015-05-29 17:13:20,517][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_).
[2015-05-29 17:13:20,517][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_200_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:20,524][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance) by(number=11002,gameId=LFN-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:20,529][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:20,529][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01111745519300007042
[2015-05-29 17:13:20,535][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:20,535][Test worker][ERROR][TEPortServlet] The total bets of selectd number:1,2,3,4,5,6,7,8,9,10,11,12 is 220, it exceeds the max allowed bets: 50 of merchant(id=111).
com.mpos.lottery.te.config.exception.ApplicationException: The total bets of selectd number:1,2,3,4,5,6,7,8,9,10,11,12 is 220, it exceeds the max allowed bets: 50 of merchant(id=111).
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validateMaxAllowedEntryBets(DefaultTicketValidator.java:100)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validate(DefaultTicketValidator.java:48)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.validateTicketRequest(AbstractTicketService.java:386)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:140)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(LfnController.java:38)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest.testSell_Exceed_MerchantAllowedMaxMultiple(LfnSaleIntegrationTest.java:461)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:20,536][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800477|Timestamp:20150529171320|Transaction-Type:4200|Transaction-Id:0115052900000000001065|Response-Code:348|):1b043e15647f88ac732daa180033b230
[2015-05-29 17:13:20,537][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=348,length=0): 
[2015-05-29 17:13:20,545][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:20,546][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:20,546][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@643a2335) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:20,546][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:20,546][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:20,546][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnSaleIntegrationTest.testSell_Exceed_MerchantAllowedMutiDraw                                                         |
[2015-05-29 17:13:20,546][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:20,547][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:20,547][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:20,548][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800547|Timestamp:20150529171320|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="4" totalAmount="5200.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=-709596780), get digest:08d8554e96f83ca1b8b3bf90bcc3dd00
[2015-05-29 17:13:20,548][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:20,548][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:20,548][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171320).
[2015-05-29 17:13:20,548][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:20,548][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890800547).
[2015-05-29 17:13:20,548][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:20,548][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:20,548][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=08d8554e96f83ca1b8b3bf90bcc3dd00).
[2015-05-29 17:13:20,548][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:20,548][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:20,548][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:20,550][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfneUV3sqK2BF9T8H6AFAlQWujaesdxUZ8uYSCQCkHjdwHP3+yXuAaDcEF1MNNIKoHkBsSBbjvZkngxurN+/18Qk2+SmNYvmW14VNqyisHlohVaGKwsDZUsogzZde6FsZH3t7lNjW6u9VCKRWgw3ZGrMdfBZTZmneqkwFDA7ju9/Wr33ulrvT8VH7V5HBwW+IG3Xn9beEOyAk7rx2k1N3fNWvotRaQ8lLTXKHe9gyv3Q7E+O1oF3itiGjtjJAHAVA52DC2HugmDcqGgVvGymGxVA6KltV895n5x7jHSZUTkxXL3tyFh55H+CQC1VgGmx3V+Eyy3V6QThPY8MRnqio6Y3Mr2RRvRtAHioK1mzE261gbyALZ8XV4LlsG+ann51rtYYQnE+v0DDEPCbUuX0dAtrp.
[2015-05-29 17:13:20,550][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800547|Timestamp:20150529171320|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:20,550][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="4" totalAmount="5200.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>
[2015-05-29 17:13:20,551][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800547|Timestamp:20150529171320|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="4" totalAmount="5200.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=-709596780), get digest:08d8554e96f83ca1b8b3bf90bcc3dd00
[2015-05-29 17:13:20,551][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:20,551][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:20,551][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:20,566][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_1.5.0).
[2015-05-29 17:13:20,566][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_).
[2015-05-29 17:13:20,566][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_200_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:20,574][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance) by(number=11002,gameId=LFN-1, multipleDraws=4, state=1||2):3
[2015-05-29 17:13:20,579][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:20,579][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01111745519300007125
[2015-05-29 17:13:20,585][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:20,585][Test worker][ERROR][TEPortServlet] THe multiple draw[4] is not in range of allowed multiple-draws[1,3] of game(id=LFN-1)
com.mpos.lottery.te.config.exception.ApplicationException: THe multiple draw[4] is not in range of allowed multiple-draws[1,3] of game(id=LFN-1)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validateMaxAllowedMultipleDraw(DefaultTicketValidator.java:80)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validate(DefaultTicketValidator.java:32)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.validateTicketRequest(AbstractTicketService.java:386)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:140)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(LfnController.java:38)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest.testSell_Exceed_MerchantAllowedMutiDraw(LfnSaleIntegrationTest.java:478)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:20,586][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800547|Timestamp:20150529171320|Transaction-Type:4200|Transaction-Id:0115052900000000001066|Response-Code:280|):e43161e796c2c746e2db459c8f10a503
[2015-05-29 17:13:20,586][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=280,length=0): 
[2015-05-29 17:13:20,592][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:20,592][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:20,592][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@4f9603aa) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:20,593][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:20,593][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:20,593][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnSaleIntegrationTest.testSell_AfterSettlement                                                                        |
[2015-05-29 17:13:20,593][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:20,597][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:20,598][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:20,598][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800597|Timestamp:20150529171320|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="1" totalAmount="1300.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=793968049), get digest:b719b96002fdaf807591dd53608a90a2
[2015-05-29 17:13:20,598][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:20,598][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:20,598][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171320).
[2015-05-29 17:13:20,598][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:20,598][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890800597).
[2015-05-29 17:13:20,598][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:20,598][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:20,598][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=b719b96002fdaf807591dd53608a90a2).
[2015-05-29 17:13:20,598][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:20,598][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:20,598][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:20,601][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfnfSvzUuvi5gIW+x7OzQghYnwXyabognesXFM+tQN6PmBbk3fSgyYq6ER4Mr0D9oAX5XX0CIUJ55wuyFGW/pJUyCpc/Opm/WtqiM+VAT8DFpap6jWN0Gu57ptGEXoF4lQjOLXNjImzkkzhUbutD50GycJJcsJ1T/T7d4TPEIMRC7RPz6Ak7b9Ou4XfT+5DrKFaFAuRRwInbx7OEXxAjlDAgEpNi3oG31C5PYdzV/Dkki0T0izqwl4/V55p5ff5zQl/BgijCil2a4j8TFfwZJ5y0t5EC/M96OQMDVEU0VOGnjjm6nKhDnYOXbrsnCOJZMEXBtHhQpyD2RGWqUlyyl/55J6JAi+l16SB8TONJDjGmPifgg/tfFpOts9PYj+ScKOInvEeH4J0cdP4gilXVaFa0y.
[2015-05-29 17:13:20,601][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800597|Timestamp:20150529171320|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:20,602][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="1" totalAmount="1300.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>
[2015-05-29 17:13:20,602][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800597|Timestamp:20150529171320|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="1" totalAmount="1300.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=793968049), get digest:b719b96002fdaf807591dd53608a90a2
[2015-05-29 17:13:20,602][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:20,602][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:20,602][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:20,614][Test worker][ERROR][TEPortServlet] Operator(id=OPERATOR-111 has done settlement, no transactions allowed today.
com.mpos.lottery.te.config.exception.ApplicationException: Operator(id=OPERATOR-111 has done settlement, no transactions allowed today.
	at com.mpos.lottery.te.port.service.CommonFacadeService.checkSettlement(CommonFacadeService.java:121)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:89)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest.testSell_AfterSettlement(LfnSaleIntegrationTest.java:594)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:20,615][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800597|Timestamp:20150529171320|Transaction-Type:4200|Transaction-Id:|Response-Code:354|):92320f500aeba21bf186748a349f4e55
[2015-05-29 17:13:20,616][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=354,length=0): 
[2015-05-29 17:13:20,623][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:20,623][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:20,623][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@42471563) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:20,624][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:20,624][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:20,624][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnSaleIntegrationTest.testSell_Under_EntryAmountLimit                                                                 |
[2015-05-29 17:13:20,624][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:20,624][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:20,625][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:20,625][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800624|Timestamp:20150529171320|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="99.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=-1695983058), get digest:2924dd01fa2634d5c1a4fd9a908bf18d
[2015-05-29 17:13:20,626][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:20,626][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:20,626][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171320).
[2015-05-29 17:13:20,626][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:20,626][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890800624).
[2015-05-29 17:13:20,626][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:20,626][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:20,626][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=2924dd01fa2634d5c1a4fd9a908bf18d).
[2015-05-29 17:13:20,626][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:20,626][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:20,626][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:20,627][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9L2k05jXFbPjS1FsBBTLuWj4a8kJVsM72/YMzruGEM7DWPI5uQU+kvE7y74H12t4zbaRoUQTDb7n/h8zAxrh6Hn2mtyfU/CYtxKe3z/Py5RlIQZDC6AG8TrAvhb3G3SNDjlu4Vxm32uHjs7iClqnt2hDh9rhQSOHhB9K5LUL3NVo8dKwh6SCwM/gn2qSE9uFUVugSNSTYY+RSjgbDrcs3xZHNc243d66pPTNiuUEoBu7Iq7NiXrdfBCQNFqhoqYhQNiQiqfKeV+Hxm9CQbiG6Nq6XMPalSVM7iyDA9aBeVp3L/5tvusWfODOmht+wFJkNmq+s8VV0WKGEasD2k0sCJvsEJ++vgG3MJA8RfKHY+38VBgWnAJ81wj/Cb5wg+Sty.
[2015-05-29 17:13:20,628][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800624|Timestamp:20150529171320|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:20,628][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="99.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>
[2015-05-29 17:13:20,628][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800624|Timestamp:20150529171320|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="99.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=-1695983058), get digest:2924dd01fa2634d5c1a4fd9a908bf18d
[2015-05-29 17:13:20,628][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:20,628][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:20,628][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:20,642][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_1.5.0).
[2015-05-29 17:13:20,642][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_).
[2015-05-29 17:13:20,642][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_200_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:20,649][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance) by(number=11002,gameId=LFN-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:20,654][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:20,654][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01111745519300007213
[2015-05-29 17:13:20,660][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:20,661][Test worker][ERROR][TEPortServlet] The entry amount[99.0] is less than base amount:100
com.mpos.lottery.te.config.exception.ApplicationException: The entry amount[99.0] is less than base amount:100
	at com.mpos.lottery.te.gameimpl.lfn.sale.support.validator.LfnNmodeSelectedNumberValidator.checkAmount(LfnNmodeSelectedNumberValidator.java:42)
	at com.mpos.lottery.te.gameimpl.lfn.sale.support.validator.LfnNmodeSelectedNumberValidator.customValidateAfter(LfnNmodeSelectedNumberValidator.java:53)
	at com.mpos.lottery.te.gamespec.sale.support.validator.AbstractSelectedNumberValidator.validate(AbstractSelectedNumberValidator.java:60)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validate(DefaultTicketValidator.java:42)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.validateTicketRequest(AbstractTicketService.java:386)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:140)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(LfnController.java:38)
	at sun.reflect.GeneratedMethodAccessor293.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleIntegrationTest.testSell_Under_EntryAmountLimit(LfnSaleIntegrationTest.java:558)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:20,662][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800624|Timestamp:20150529171320|Transaction-Type:4200|Transaction-Id:0115052900000000001067|Response-Code:307|):19678715e95dc237de30dc0cb6a5363c
[2015-05-29 17:13:20,663][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=307,length=0): 
[2015-05-29 17:13:20,670][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:20,670][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:20,670][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@3884db2d) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:20,671][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:20,671][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:20,671][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnSaleIntegrationTest.testEnquiryQP                                                                                   |
[2015-05-29 17:13:20,671][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:20,671][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/QPEnquiry_Req.xml) by key(15.transtype.211).
[2015-05-29 17:13:20,687][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gamespec.sale.web.QPEnquiryDto, mappingFile=xml-mapping/game/lfn/QPEnquiry_Req.xml).
[2015-05-29 17:13:20,688][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800671|Timestamp:20150529171320|Transaction-Type:211|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<QPGenerator countOfQPNumbers="4" countOfQP="3"><GameDraw number="11002" gameId="LFN-1"/></QPGenerator>,hash=-1116637218), get digest:a8e330c9661da8ab6c2e54a9b341148c
[2015-05-29 17:13:20,688][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=211).
[2015-05-29 17:13:20,688][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:20,688][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171320).
[2015-05-29 17:13:20,688][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:20,688][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890800671).
[2015-05-29 17:13:20,688][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:20,688][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:20,688][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=a8e330c9661da8ab6c2e54a9b341148c).
[2015-05-29 17:13:20,688][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:20,688][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:20,688][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:20,690][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6oJoDNAH1tpsPSfJkbDgGrKQERwUdCr7yMmWHsRIm8s9UXbB6YsLCcRJ2SxppoZVRuTtMQAPLAMgao93c4ZT+AtxapTT9OFYA+xHDKntRvooerw0VG9jBtk86tRdjWAWN0glkgEAoXr1.
[2015-05-29 17:13:20,690][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800671|Timestamp:20150529171320|Transaction-Type:211|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:20,691][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<QPGenerator countOfQPNumbers="4" countOfQP="3"><GameDraw number="11002" gameId="LFN-1"/></QPGenerator>
[2015-05-29 17:13:20,691][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800671|Timestamp:20150529171320|Transaction-Type:211|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<QPGenerator countOfQPNumbers="4" countOfQP="3"><GameDraw number="11002" gameId="LFN-1"/></QPGenerator>,hash=-1116637218), get digest:a8e330c9661da8ab6c2e54a9b341148c
[2015-05-29 17:13:20,691][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/QPEnquiry_Req.xml) by key(15.transtype.211).
[2015-05-29 17:13:20,691][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/QPEnquiry_Req.xml
[2015-05-29 17:13:20,691][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/QPEnquiry_Req.xml) by key(15.transtype.211).
[2015-05-29 17:13:20,706][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_211_1.5.0).
[2015-05-29 17:13:20,706][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_211_).
[2015-05-29 17:13:20,706][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_211_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.enquiryQP(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:20,713][Test worker][DEBUG][LfnSaleService] Ready to pick 4 from total 32 same numbers to form QP
[2015-05-29 17:13:20,719][Test worker][DEBUG][LfnSaleService] Generate QP number:3,8,20,28 of game instance(id=GII-112).
[2015-05-29 17:13:20,722][Test worker][DEBUG][LfnSaleService] Ready to pick 4 from total 32 same numbers to form QP
[2015-05-29 17:13:20,728][Test worker][DEBUG][LfnSaleService] Generate QP number:6,16,17,20 of game instance(id=GII-112).
[2015-05-29 17:13:20,731][Test worker][DEBUG][LfnSaleService] Ready to pick 4 from total 32 same numbers to form QP
[2015-05-29 17:13:20,736][Test worker][DEBUG][LfnSaleService] Generate QP number:1,2,8,22 of game instance(id=GII-112).
[2015-05-29 17:13:20,740][Test worker][DEBUG][CommonFacadeService] No need to publish AMQP message of transaction(ENQUIRY_QP_NUMBERS)
[2015-05-29 17:13:20,740][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/QPEnquiry_Req.xml) by key(15.transtype.4211).
[2015-05-29 17:13:20,740][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gamespec.sale.web.QPEnquiryDto),mappingFile=xml-mapping/game/lfn/QPEnquiry_Req.xml
[2015-05-29 17:13:20,740][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/QPEnquiry_Req.xml) by key(15.transtype.4211).
[2015-05-29 17:13:20,741][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gamespec.sale.web.QPEnquiryDto, mappingFile=xml-mapping/game/lfn/QPEnquiry_Req.xml).
[2015-05-29 17:13:20,741][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800671|Timestamp:20150529171320|Transaction-Type:4211|Transaction-Id:0115052900000000001068|Response-Code:200|<?xml version="1.0" encoding="UTF-8"?>
<QPGenerator countOfQPNumbers="4" countOfQP="3"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="3,8,20,28"/><Entry selectedNumber="6,16,17,20"/><Entry selectedNumber="1,2,8,22"/></QPGenerator>):8f6a64d2d797598f872dfd27d95ac5b9
[2015-05-29 17:13:20,742][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=332) succesfully.
[2015-05-29 17:13:20,742][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=332): <?xml version="1.0" encoding="UTF-8"?>
<QPGenerator countOfQPNumbers="4" countOfQP="3"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="3,8,20,28"/><Entry selectedNumber="6,16,17,20"/><Entry selectedNumber="1,2,8,22"/></QPGenerator>
[2015-05-29 17:13:20,742][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/QPEnquiry_Req.xml) by key(15.transtype.4211).
[2015-05-29 17:13:20,751][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:20,752][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:20,752][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@4b4ae506) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:20,752][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:20,752][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:20,752][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnSaleIntegrationTest.testSell_MultiDraw_OK                                                                           |
[2015-05-29 17:13:20,752][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:20,756][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:20,757][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:20,757][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800755|Timestamp:20150529171320|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=-1281403444), get digest:b3ad1ea16e718a1b9982d1c2e7268d29
[2015-05-29 17:13:20,757][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:20,757][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:20,758][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171320).
[2015-05-29 17:13:20,758][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:20,758][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890800755).
[2015-05-29 17:13:20,758][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:20,758][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:20,758][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=b3ad1ea16e718a1b9982d1c2e7268d29).
[2015-05-29 17:13:20,758][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:20,758][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:20,758][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:20,760][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9L2k05jXFbPjS1FsBBTLuWj4a8kJVsM72/YMzruGEM7DWPI5uQU+kvE7y74H12t4zbaRoUQTDb7n/h8zAxrh6Hn2mtyfU/CYtxKe3z/Py5RlIQZDC6AG8TrAvhb3G3SNDjlu4Vxm32uHjs7iClqnt2hDh9rhQSOHhB9K5LUL3NVo8dKwh6SCwM56BaXiK557zz5HaYz2004U1raT6OlReAP7pgHuknsbfxdYkwSI2v0wkzsQ/uHRPv01BVY1tFvgu1/1csAMYBq+O2tRLIhXeAoIJOVLJJPvPHAkozf5FsxcYBza1aivogG1+z8aPrO9uA0h0ScFgQ8LmCP5AX0mf6ruPkYWDcmUtW5ansd9eHP+N72iCfLshuhdBbTWGleRy.
[2015-05-29 17:13:20,760][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800755|Timestamp:20150529171320|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:20,760][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>
[2015-05-29 17:13:20,760][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800755|Timestamp:20150529171320|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0" countOfQPNumber="0"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0" countOfQPNumber="0"/></Ticket>,hash=-1281403444), get digest:b3ad1ea16e718a1b9982d1c2e7268d29
[2015-05-29 17:13:20,760][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:20,760][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:20,760][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:20,773][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_1.5.0).
[2015-05-29 17:13:20,773][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_).
[2015-05-29 17:13:20,773][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_200_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:20,780][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance) by(number=11002,gameId=LFN-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:20,785][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:20,785][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01111745519300007354
[2015-05-29 17:13:20,791][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:20,793][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMs+0zC37swrz) as 80000
[2015-05-29 17:13:20,797][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMs+0zC37swrz, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:20,797][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:20,797][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:20,803][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMs+0zC37swrz) as 80000
[2015-05-29 17:13:20,807][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMs+0zC37swrz, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:20,807][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:20,807][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:20,814][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:20,814][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:20,821][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:20,821][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:20,827][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:20,827][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:20,833][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:20,834][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:20,840][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:20,840][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:20,846][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:20,847][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:20,853][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:20,853][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:20,859][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:20,859][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:20,866][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:20,866][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:20,872][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:20,872][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:20,879][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:20,879][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:20,885][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:20,885][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:20,892][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:20,892][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:20,898][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:20,898][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:20,905][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:20,905][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:20,911][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:20,911][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:20,918][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:20,918][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:20,925][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:20,925][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:20,931][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:20,932][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:20,938][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMs+0zC37swrz) as 80000
[2015-05-29 17:13:20,940][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMs+0zC37swrz, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:20,940][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:20,940][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:20,947][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMs+0zC37swrz) as 80000
[2015-05-29 17:13:20,949][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMs+0zC37swrz, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:20,949][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:20,949][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:20,956][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:20,956][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:20,963][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:20,963][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:20,969][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:20,969][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:20,976][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:20,976][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:20,982][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:20,982][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:20,988][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:20,988][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:20,995][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:20,995][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:21,001][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:21,001][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:21,008][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:21,008][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:21,014][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:21,014][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:21,020][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:21,020][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:21,027][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:21,027][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:21,033][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:21,033][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:21,040][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:21,040][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:21,046][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:21,046][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:21,054][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:21,054][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:21,060][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:21,060][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:21,067][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:21,067][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:21,074][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:21,074][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:21,091][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:21,091][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:21,091][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199997400.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:21,107][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.15]: transaction {
  id: "0115052900000000001069"
  dev_id: "111"
  operator_id: "OPERATOR-111"
  merchant_id: "111"
  create_time: 1432890800000
  trans_type: 200
  game_id: "LFN-1"
  game_type: 15
  total_amount: "2600.0"
}
multi_draw: 2
total_amount: "2600.0"
serial_no: "y013eOifYgLRjcmw7N8vMs+0zC37swrz"
game_instance {
  id: "GII-112"
}
entries {
  selected_number: "2,7,13,24,25,36"
  bet_option: 53
  total_bets: 20
  entry_amount: "1200.0"
  input_channel: "2"
}
entries {
  selected_number: "5"
  bet_option: 1
  total_bets: 1
  entry_amount: "100.0"
  input_channel: "2"
}

[2015-05-29 17:13:21,107][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:21,108][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:21,108][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket),mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml
[2015-05-29 17:13:21,108][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:21,108][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml).
[2015-05-29 17:13:21,109][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890800755|Timestamp:20150529171320|Transaction-Type:4200|Transaction-Id:0115052900000000001069|Response-Code:200|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300007354" type="1" lastDrawNo="11003" barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIq5Y2XrJPchPo=" validationCode="198178" multipleDraws="2" totalBets="42" totalAmount="2600.0"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0"/></Ticket>):15adeaa67da7d0512d58cb187a623a8b
[2015-05-29 17:13:21,109][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=672) succesfully.
[2015-05-29 17:13:21,109][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=672): <?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300007354" type="1" lastDrawNo="11003" barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIq5Y2XrJPchPo=" validationCode="198178" multipleDraws="2" totalBets="42" totalAmount="2600.0"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="2,7,13,24,25,36" betOption="53" inputChannel="2" entryAmount="1200.0"/><Entry selectedNumber="5" betOption="1" inputChannel="2" entryAmount="100.0"/></Ticket>
[2015-05-29 17:13:21,110][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:21,146][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:21,146][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:21,146][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@510d4b23) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:21,147][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:21,147][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:21,147][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnSaleIntegrationTest.testSell_MultiDraw_QP_OK                                                                        |
[2015-05-29 17:13:21,147][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:21,152][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:21,153][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:21,154][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890801152|Timestamp:20150529171321|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry betOption="1" inputChannel="3" entryAmount="100.0" countOfQPNumber="0"/><Entry betOption="53" inputChannel="3" entryAmount="1200.0" countOfQPNumber="6"/></Ticket>,hash=-727208597), get digest:530da1bab5406ea447b181b2cd6dbd89
[2015-05-29 17:13:21,154][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:21,154][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:21,154][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171321).
[2015-05-29 17:13:21,154][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:21,154][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890801152).
[2015-05-29 17:13:21,154][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:21,154][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:21,154][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=530da1bab5406ea447b181b2cd6dbd89).
[2015-05-29 17:13:21,154][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:21,154][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:21,154][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:21,156][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9L2k05jXFbPjS1FsBBTLuWj4a8kJVsM72/YMzruGEM7DWPI5uQU+kvE7y74H12t4zbaRoUQTDb7n/h8zAxrh6Hn2mtyfU/CYtTEEtekGLEH0r7a8yFpfNCrS35T2N/+XS63NmPuvYp9HHENIO+EOsmjfAXmOu3pyB5vXmjK6eMNx4yd7NIeH+6acLXqVHwW2OKGC/6k27qPbxYVQ5T8jAXcAMnwfVAqc2PmjjlrKmLbmIDAI8YzpORtog1vUQwqKvpeyq/ZRYuZ/zcoAjh67m0T/N/EJIWqKxcC7aGCVc4HuTEdYmf3quf5t+IMSuW3ie.
[2015-05-29 17:13:21,156][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890801152|Timestamp:20150529171321|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:21,156][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry betOption="1" inputChannel="3" entryAmount="100.0" countOfQPNumber="0"/><Entry betOption="53" inputChannel="3" entryAmount="1200.0" countOfQPNumber="6"/></Ticket>
[2015-05-29 17:13:21,156][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890801152|Timestamp:20150529171321|Transaction-Type:200|Transaction-Id:|Response-Code:|<?xml version="1.0" encoding="UTF-8"?>
<Ticket multipleDraws="2" totalAmount="2600.0" PIN="!!!!"><GameDraw number="11002" gameId="LFN-1"/><Entry betOption="1" inputChannel="3" entryAmount="100.0" countOfQPNumber="0"/><Entry betOption="53" inputChannel="3" entryAmount="1200.0" countOfQPNumber="6"/></Ticket>,hash=-727208597), get digest:530da1bab5406ea447b181b2cd6dbd89
[2015-05-29 17:13:21,157][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:21,157][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:21,157][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:21,168][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_1.5.0).
[2015-05-29 17:13:21,168][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_).
[2015-05-29 17:13:21,168][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_200_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:21,176][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance) by(number=11002,gameId=LFN-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:21,181][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:21,181][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01111745519300007426
[2015-05-29 17:13:21,189][Test worker][DEBUG][LfnSaleService] Ready to pick 1 from total 30 same numbers to form QP
[2015-05-29 17:13:21,195][Test worker][DEBUG][LfnSaleService] Generate QP number:3 of game instance(id=GII-112).
[2015-05-29 17:13:21,195][Test worker][DEBUG][LfnSaleService] Ready to pick 6 from total 34 same numbers to form QP
[2015-05-29 17:13:21,200][Test worker][DEBUG][LfnSaleService] Generate QP number:1,3,10,21,22,27 of game instance(id=GII-112).
[2015-05-29 17:13:21,201][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:21,204][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMphK0wfeJI/n) as 80000
[2015-05-29 17:13:21,210][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMphK0wfeJI/n, selectNumber=3, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:21,210][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:21,210][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(3, amount=100.0) is 50
[2015-05-29 17:13:21,218][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMphK0wfeJI/n) as 80000
[2015-05-29 17:13:21,222][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMphK0wfeJI/n, selectNumber=1,3,10,21,22,27, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:21,222][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:21,222][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(1,3,10, amount=60.00) is 30
[2015-05-29 17:13:21,231][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=1,3,10]
[2015-05-29 17:13:21,231][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(1,3,21, amount=60.00) is 30
[2015-05-29 17:13:21,237][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=1,3,21]
[2015-05-29 17:13:21,237][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(1,3,22, amount=60.00) is 30
[2015-05-29 17:13:21,250][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=1,3,22]
[2015-05-29 17:13:21,250][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(1,3,27, amount=60.00) is 30
[2015-05-29 17:13:21,260][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=1,3,27]
[2015-05-29 17:13:21,260][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(1,10,21, amount=60.00) is 30
[2015-05-29 17:13:21,267][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=1,10,21]
[2015-05-29 17:13:21,267][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(1,10,22, amount=60.00) is 30
[2015-05-29 17:13:21,275][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=1,10,22]
[2015-05-29 17:13:21,275][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(1,10,27, amount=60.00) is 30
[2015-05-29 17:13:21,282][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=1,10,27]
[2015-05-29 17:13:21,282][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(1,21,22, amount=60.00) is 30
[2015-05-29 17:13:21,289][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=1,21,22]
[2015-05-29 17:13:21,289][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(1,21,27, amount=60.00) is 30
[2015-05-29 17:13:21,296][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=1,21,27]
[2015-05-29 17:13:21,296][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(1,22,27, amount=60.00) is 30
[2015-05-29 17:13:21,302][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=1,22,27]
[2015-05-29 17:13:21,302][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(3,10,21, amount=60.00) is 30
[2015-05-29 17:13:21,312][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=3,10,21]
[2015-05-29 17:13:21,312][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(3,10,22, amount=60.00) is 30
[2015-05-29 17:13:21,318][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=3,10,22]
[2015-05-29 17:13:21,318][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(3,10,27, amount=60.00) is 30
[2015-05-29 17:13:21,325][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=3,10,27]
[2015-05-29 17:13:21,326][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(3,21,22, amount=60.00) is 30
[2015-05-29 17:13:21,332][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=3,21,22]
[2015-05-29 17:13:21,332][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(3,21,27, amount=60.00) is 30
[2015-05-29 17:13:21,339][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=3,21,27]
[2015-05-29 17:13:21,339][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(3,22,27, amount=60.00) is 30
[2015-05-29 17:13:21,345][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=3,22,27]
[2015-05-29 17:13:21,345][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(10,21,22, amount=60.00) is 30
[2015-05-29 17:13:21,352][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=10,21,22]
[2015-05-29 17:13:21,352][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(10,21,27, amount=60.00) is 30
[2015-05-29 17:13:21,359][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=10,21,27]
[2015-05-29 17:13:21,359][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(10,22,27, amount=60.00) is 30
[2015-05-29 17:13:21,367][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=10,22,27]
[2015-05-29 17:13:21,367][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(21,22,27, amount=60.00) is 30
[2015-05-29 17:13:21,376][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMphK0wfeJI/n) as 80000
[2015-05-29 17:13:21,378][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMphK0wfeJI/n, selectNumber=3, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:21,378][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:21,378][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(3, amount=100.0) is 50
[2015-05-29 17:13:21,385][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMphK0wfeJI/n) as 80000
[2015-05-29 17:13:21,387][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMphK0wfeJI/n, selectNumber=1,3,10,21,22,27, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:21,388][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:21,388][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(1,3,10, amount=60.00) is 30
[2015-05-29 17:13:21,394][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=1,3,10]
[2015-05-29 17:13:21,394][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(1,3,21, amount=60.00) is 30
[2015-05-29 17:13:21,400][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=1,3,21]
[2015-05-29 17:13:21,400][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(1,3,22, amount=60.00) is 30
[2015-05-29 17:13:21,408][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=1,3,22]
[2015-05-29 17:13:21,408][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(1,3,27, amount=60.00) is 30
[2015-05-29 17:13:21,414][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=1,3,27]
[2015-05-29 17:13:21,414][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(1,10,21, amount=60.00) is 30
[2015-05-29 17:13:21,420][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=1,10,21]
[2015-05-29 17:13:21,421][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(1,10,22, amount=60.00) is 30
[2015-05-29 17:13:21,427][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=1,10,22]
[2015-05-29 17:13:21,427][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(1,10,27, amount=60.00) is 30
[2015-05-29 17:13:21,434][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=1,10,27]
[2015-05-29 17:13:21,434][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(1,21,22, amount=60.00) is 30
[2015-05-29 17:13:21,440][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=1,21,22]
[2015-05-29 17:13:21,440][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(1,21,27, amount=60.00) is 30
[2015-05-29 17:13:21,447][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=1,21,27]
[2015-05-29 17:13:21,447][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(1,22,27, amount=60.00) is 30
[2015-05-29 17:13:21,454][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=1,22,27]
[2015-05-29 17:13:21,454][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(3,10,21, amount=60.00) is 30
[2015-05-29 17:13:21,462][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=3,10,21]
[2015-05-29 17:13:21,462][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(3,10,22, amount=60.00) is 30
[2015-05-29 17:13:21,469][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=3,10,22]
[2015-05-29 17:13:21,469][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(3,10,27, amount=60.00) is 30
[2015-05-29 17:13:21,476][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=3,10,27]
[2015-05-29 17:13:21,476][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(3,21,22, amount=60.00) is 30
[2015-05-29 17:13:21,483][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=3,21,22]
[2015-05-29 17:13:21,483][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(3,21,27, amount=60.00) is 30
[2015-05-29 17:13:21,489][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=3,21,27]
[2015-05-29 17:13:21,489][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(3,22,27, amount=60.00) is 30
[2015-05-29 17:13:21,495][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=3,22,27]
[2015-05-29 17:13:21,496][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(10,21,22, amount=60.00) is 30
[2015-05-29 17:13:21,502][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=10,21,22]
[2015-05-29 17:13:21,502][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(10,21,27, amount=60.00) is 30
[2015-05-29 17:13:21,509][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=10,21,27]
[2015-05-29 17:13:21,509][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(10,22,27, amount=60.00) is 30
[2015-05-29 17:13:21,515][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=10,22,27]
[2015-05-29 17:13:21,515][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(21,22,27, amount=60.00) is 30
[2015-05-29 17:13:21,534][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:21,534][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:21,534][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199997400.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:21,553][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.15]: transaction {
  id: "0115052900000000001116"
  dev_id: "111"
  operator_id: "OPERATOR-111"
  merchant_id: "111"
  create_time: 1432890801000
  trans_type: 200
  game_id: "LFN-1"
  game_type: 15
  total_amount: "2600.0"
}
multi_draw: 2
total_amount: "2600.0"
serial_no: "y013eOifYgLRjcmw7N8vMphK0wfeJI/n"
game_instance {
  id: "GII-112"
}
entries {
  selected_number: "1,3,10,21,22,27"
  bet_option: 53
  total_bets: 20
  entry_amount: "1200.0"
  input_channel: "3"
}
entries {
  selected_number: "3"
  bet_option: 1
  total_bets: 1
  entry_amount: "100.0"
  input_channel: "3"
}

[2015-05-29 17:13:21,554][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:21,554][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:21,554][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket),mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml
[2015-05-29 17:13:21,554][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:21,555][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml).
[2015-05-29 17:13:21,555][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890801152|Timestamp:20150529171321|Transaction-Type:4200|Transaction-Id:0115052900000000001116|Response-Code:200|<?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300007426" type="1" lastDrawNo="11003" barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqvdlZanq+YY0=" validationCode="509211" multipleDraws="2" totalBets="42" totalAmount="2600.0"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="1,3,10,21,22,27" betOption="53" inputChannel="3" entryAmount="1200.0"/><Entry selectedNumber="3" betOption="1" inputChannel="3" entryAmount="100.0"/></Ticket>):17cee7418656acb7a81b65eed537ed77
[2015-05-29 17:13:21,555][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=672) succesfully.
[2015-05-29 17:13:21,556][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=672): <?xml version="1.0" encoding="UTF-8"?>
<Ticket serialNo="01111745519300007426" type="1" lastDrawNo="11003" barcode="15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqvdlZanq+YY0=" validationCode="509211" multipleDraws="2" totalBets="42" totalAmount="2600.0"><GameDraw number="11002" gameId="LFN-1"/><Entry selectedNumber="1,3,10,21,22,27" betOption="53" inputChannel="3" entryAmount="1200.0"/><Entry selectedNumber="3" betOption="1" inputChannel="3" entryAmount="100.0"/></Ticket>
[2015-05-29 17:13:21,556][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
]]></system-out>
  <system-err><![CDATA[]]></system-err>
</testsuite>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="zh">
<head>
<!-- Generated by javadoc (version 1.7.0_71) on Fri May 29 17:11:15 CST 2015 -->
<title>PrizeService (sourcecode 2.5.2-rc7 API)</title>
<meta name="date" content="2015-05-29">
<link rel="stylesheet" type="text/css" href="../../../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="PrizeService (sourcecode 2.5.2-rc7 API)";
    }
//-->
</script>
<noscript>
<div>您的浏览器已禁用 JavaScript。</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="跳过导航链接"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="导航">
<li><a href="../../../../../../../overview-summary.html">概览</a></li>
<li><a href="package-summary.html">程序包</a></li>
<li class="navBarCell1Rev">类</li>
<li><a href="package-tree.html">树</a></li>
<li><a href="../../../../../../../deprecated-list.html">已过时</a></li>
<li><a href="../../../../../../../index-all.html">索引</a></li>
<li><a href="../../../../../../../help-doc.html">帮助</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>上一个类</li>
<li><a href="../../../../../../../com/mpos/lottery/te/gamespec/prize/service/TaxService.html" title="com.mpos.lottery.te.gamespec.prize.service中的接口"><span class="strong">下一个类</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../../index.html?com/mpos/lottery/te/gamespec/prize/service/PrizeService.html" target="_top">框架</a></li>
<li><a href="PrizeService.html" target="_top">无框架</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../../allclasses-noframe.html">所有类</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>概要:&nbsp;</li>
<li>嵌套&nbsp;|&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method_summary">方法</a></li>
</ul>
<ul class="subNavList">
<li>详细资料:&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method_detail">方法</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.mpos.lottery.te.gamespec.prize.service</div>
<h2 title="接口 PrizeService" class="title">接口 PrizeService</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>所有超级接口:</dt>
<dd><a href="../../../../../../../com/mpos/lottery/te/gamespec/game/GameTypeAware.html" title="com.mpos.lottery.te.gamespec.game中的接口">GameTypeAware</a>, <a href="../../../../../../../com/mpos/lottery/te/trans/domain/logic/ReversalOrCancelStrategy.html" title="com.mpos.lottery.te.trans.domain.logic中的接口">ReversalOrCancelStrategy</a></dd>
</dl>
<dl>
<dt>所有已知实现类:</dt>
<dd><a href="../../../../../../../com/mpos/lottery/te/gamespec/prize/service/impl/AbstractPrizeService.html" title="com.mpos.lottery.te.gamespec.prize.service.impl中的类">AbstractPrizeService</a>, <a href="../../../../../../../com/mpos/lottery/te/gameimpl/bingo/prize/service/BingoPrizeService.html" title="com.mpos.lottery.te.gameimpl.bingo.prize.service中的类">BingoPrizeService</a>, <a href="../../../../../../../com/mpos/lottery/te/gameimpl/digital/prize/service/DigitalPrizeService.html" title="com.mpos.lottery.te.gameimpl.digital.prize.service中的类">DigitalPrizeService</a>, <a href="../../../../../../../com/mpos/lottery/te/gameimpl/lfn/prize/service/LfnPrizeService.html" title="com.mpos.lottery.te.gameimpl.lfn.prize.service中的类">LfnPrizeService</a>, <a href="../../../../../../../com/mpos/lottery/te/gameimpl/lotto/prize/service/impl/LottoPrizeServiceImpl.html" title="com.mpos.lottery.te.gameimpl.lotto.prize.service.impl中的类">LottoPrizeServiceImpl</a>, <a href="../../../../../../../com/mpos/lottery/te/gameimpl/magic100/prize/service/impl/Magic100PrizeServiceImpl.html" title="com.mpos.lottery.te.gameimpl.magic100.prize.service.impl中的类">Magic100PrizeServiceImpl</a>, <a href="../../../../../../../com/mpos/lottery/te/gameimpl/raffle/prize/service/RafflePrizeService.html" title="com.mpos.lottery.te.gameimpl.raffle.prize.service中的类">RafflePrizeService</a>, <a href="../../../../../../../com/mpos/lottery/te/gameimpl/toto/service/impl/ToToPayoutServiceImpl.html" title="com.mpos.lottery.te.gameimpl.toto.service.impl中的类">ToToPayoutServiceImpl</a>, <a href="../../../../../../../com/mpos/lottery/te/gameimpl/union/prize/service/UnionPrizeServiceImpl.html" title="com.mpos.lottery.te.gameimpl.union.prize.service中的类">UnionPrizeServiceImpl</a></dd>
</dl>
<hr>
<br>
<pre>public interface <span class="strong">PrizeService</span>
extends <a href="../../../../../../../com/mpos/lottery/te/trans/domain/logic/ReversalOrCancelStrategy.html" title="com.mpos.lottery.te.trans.domain.logic中的接口">ReversalOrCancelStrategy</a>, <a href="../../../../../../../com/mpos/lottery/te/gamespec/game/GameTypeAware.html" title="com.mpos.lottery.te.gamespec.game中的接口">GameTypeAware</a></pre>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>方法概要</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="方法概要表, 列表方法和解释">
<caption><span>方法</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">限定符和类型</th>
<th class="colLast" scope="col">方法和说明</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../com/mpos/lottery/te/gamespec/prize/service/PrizeService.html#confirmPayout(com.mpos.lottery.te.port.Context,%20com.mpos.lottery.te.gamespec.sale.BaseTicket)">confirmPayout</a></strong>(<a href="../../../../../../../com/mpos/lottery/te/port/Context.html" title="com.mpos.lottery.te.port中的类">Context</a>&lt;?&gt;&nbsp;respCtx,
             <a href="../../../../../../../com/mpos/lottery/te/gamespec/sale/BaseTicket.html" title="com.mpos.lottery.te.gamespec.sale中的类">BaseTicket</a>&nbsp;ticket)</code>
<div class="block">Why we need payout confirmation???</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../../../../com/mpos/lottery/te/gamespec/prize/web/PrizeDto.html" title="com.mpos.lottery.te.gamespec.prize.web中的类">PrizeDto</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../com/mpos/lottery/te/gamespec/prize/service/PrizeService.html#enquiry(com.mpos.lottery.te.port.Context,%20com.mpos.lottery.te.gamespec.sale.BaseTicket)">enquiry</a></strong>(<a href="../../../../../../../com/mpos/lottery/te/port/Context.html" title="com.mpos.lottery.te.port中的类">Context</a>&lt;?&gt;&nbsp;respCtx,
       <a href="../../../../../../../com/mpos/lottery/te/gamespec/sale/BaseTicket.html" title="com.mpos.lottery.te.gamespec.sale中的类">BaseTicket</a>&nbsp;clientTicket)</code>
<div class="block">Enquiry the prize of a ticket.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../../../../com/mpos/lottery/te/gamespec/prize/web/PrizeDto.html" title="com.mpos.lottery.te.gamespec.prize.web中的类">PrizeDto</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../com/mpos/lottery/te/gamespec/prize/service/PrizeService.html#payout(com.mpos.lottery.te.port.Context,%20com.mpos.lottery.te.gamespec.sale.BaseTicket)">payout</a></strong>(<a href="../../../../../../../com/mpos/lottery/te/port/Context.html" title="com.mpos.lottery.te.port中的类">Context</a>&lt;?&gt;&nbsp;respCtx,
      <a href="../../../../../../../com/mpos/lottery/te/gamespec/sale/BaseTicket.html" title="com.mpos.lottery.te.gamespec.sale中的类">BaseTicket</a>&nbsp;clientTicket)</code>
<div class="block">This operation will pay the winning ticket.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_com.mpos.lottery.te.trans.domain.logic.ReversalOrCancelStrategy">
<!--   -->
</a>
<h3>从接口继承的方法&nbsp;com.mpos.lottery.te.trans.domain.logic.<a href="../../../../../../../com/mpos/lottery/te/trans/domain/logic/ReversalOrCancelStrategy.html" title="com.mpos.lottery.te.trans.domain.logic中的接口">ReversalOrCancelStrategy</a></h3>
<code><a href="../../../../../../../com/mpos/lottery/te/trans/domain/logic/ReversalOrCancelStrategy.html#cancelOrReverse(com.mpos.lottery.te.port.Context,%20com.mpos.lottery.te.trans.domain.Transaction)">cancelOrReverse</a>, <a href="../../../../../../../com/mpos/lottery/te/trans/domain/logic/ReversalOrCancelStrategy.html#supportedReversalRoutineKey()">supportedReversalRoutineKey</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_com.mpos.lottery.te.gamespec.game.GameTypeAware">
<!--   -->
</a>
<h3>从接口继承的方法&nbsp;com.mpos.lottery.te.gamespec.game.<a href="../../../../../../../com/mpos/lottery/te/gamespec/game/GameTypeAware.html" title="com.mpos.lottery.te.gamespec.game中的接口">GameTypeAware</a></h3>
<code><a href="../../../../../../../com/mpos/lottery/te/gamespec/game/GameTypeAware.html#supportedGameType()">supportedGameType</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>方法详细资料</h3>
<a name="enquiry(com.mpos.lottery.te.port.Context, com.mpos.lottery.te.gamespec.sale.BaseTicket)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>enquiry</h4>
<pre><a href="../../../../../../../com/mpos/lottery/te/gamespec/prize/web/PrizeDto.html" title="com.mpos.lottery.te.gamespec.prize.web中的类">PrizeDto</a>&nbsp;enquiry(<a href="../../../../../../../com/mpos/lottery/te/port/Context.html" title="com.mpos.lottery.te.port中的类">Context</a>&lt;?&gt;&nbsp;respCtx,
               <a href="../../../../../../../com/mpos/lottery/te/gamespec/sale/BaseTicket.html" title="com.mpos.lottery.te.gamespec.sale中的类">BaseTicket</a>&nbsp;clientTicket)
                 throws <a href="../../../../../../../com/mpos/lottery/te/config/exception/ApplicationException.html" title="com.mpos.lottery.te.config.exception中的类">ApplicationException</a></pre>
<div class="block">Enquiry the prize of a ticket. A ticket may win both normal and sencond chance prize, the implementation must
 calculate both of them.
 <p>
 <b>Pre-Condition</b>
 <ul>
 <li>The sold draw must be 'payout started'.</li>
 </ul>
 <b>Post-Condition</b>
 <ul>
 <li>A successful call to this interface will return both normal and second chance prize information.</li>
 </ul>
 <b>Usage-Restriction</b>
 <ul>
 <li>Authorization - Can only be called by signed in clients.</li>
 <li>Concurrent Access - There isn't any limitation on the number of concurrent access of this interface. The
 service is indempotent and won't change any states.</li>
 </ul>
 Only when game draw is 'PAYOUT STARTED', the enquiry can get the prize response. To multlple-draw ticket, all
 'PAYOUT STARTED' game draw should be calculated, the other game draw(not 'payout started', such as 'new', \
 'active' etc) should be regarded as 'return'.</div>
<dl><dt><span class="strong">参数:</span></dt><dd><code>respCtx</code> - The context of transaction.</dd><dd><code>clientTicket</code> - The ticket which is claiming prize. The following components must not be null: serialNo.</dd>
<dt><span class="strong">返回:</span></dt><dd>both normal and second chance prize information.</dd>
<dt><span class="strong">抛出:</span></dt>
<dd><code><a href="../../../../../../../com/mpos/lottery/te/config/exception/ApplicationException.html" title="com.mpos.lottery.te.config.exception中的类">ApplicationException</a></code> - when encounter any business exception.</dd></dl>
</li>
</ul>
<a name="payout(com.mpos.lottery.te.port.Context, com.mpos.lottery.te.gamespec.sale.BaseTicket)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>payout</h4>
<pre><a href="../../../../../../../com/mpos/lottery/te/gamespec/prize/web/PrizeDto.html" title="com.mpos.lottery.te.gamespec.prize.web中的类">PrizeDto</a>&nbsp;payout(<a href="../../../../../../../com/mpos/lottery/te/port/Context.html" title="com.mpos.lottery.te.port中的类">Context</a>&lt;?&gt;&nbsp;respCtx,
              <a href="../../../../../../../com/mpos/lottery/te/gamespec/sale/BaseTicket.html" title="com.mpos.lottery.te.gamespec.sale中的类">BaseTicket</a>&nbsp;clientTicket)
                throws <a href="../../../../../../../com/mpos/lottery/te/config/exception/ApplicationException.html" title="com.mpos.lottery.te.config.exception中的类">ApplicationException</a></pre>
<div class="block">This operation will pay the winning ticket. One ticket can be paid only once, and operator will collect the
 winning ticket after payout. To a multiple-draw ticket, there will be multiple ticket records, also one ticket
 record will has one corresponding 'PAYOUT' record if this ticket record wins a prize(even return is a payout).
 <p>
 This operator will call <a href="../../../../../../../com/mpos/lottery/te/gamespec/prize/service/PrizeService.html#enquiry(com.mpos.lottery.te.port.Context,%20com.mpos.lottery.te.gamespec.sale.BaseTicket)"><code>enquiry(Context, BaseTicket)</code></a> to get prize information first.
 <p>
 Let's say there are a 3-draws ticket, in which ticket#1 associate draw#1(payout started), and ticket#2 associates
 with draw#2 which is active(or now, it doesn't matter).
 <table border="1">
 <tr>
 <td>TicketID</td>
 <td>Ticket SerialNO</td>
 <td>Ticket Status</td>
 <td>Is Count In Pool</td>
 <td>Game Instance ID</td>
 <td>GameInstance Status</td>
 </tr>
 <tr>
 <td>t1</td>
 <td>SN-OLD</td>
 <td>accepted</td>
 <td>true</td>
 <td>d1</td>
 <td>payout started</td>
 </tr>
 <tr>
 <td>t2</td>
 <td>SN-OLD</td>
 <td>accepted</td>
 <td>true</td>
 <td>d2</td>
 <td>active</td>
 </tr>
 <tr>
 <td>t3</td>
 <td>SN-OLD</td>
 <td>accepted</td>
 <td>true</td>
 <td>d3</td>
 <td>new</td>
 </tr>
 </table>
 <h1>Print New Ticket Mode</h1>
 After payout, only tickets belong to a payout-started game draw will be set as 'paid'(here is t1), all other
 ticket records will be remained as 'accepted' and count_in_pool.
 <p>
 Also new tickets will be generated for those tickets in future game instances, here they are t2 and t3.
 <p>
 <table border="1">
 <tr>
 <td>TicketID</td>
 <td>Ticket SerialNo</td>
 <td>Ticket Status</td>
 <td>Is Count In Pool</td>
 <td>Game Instance ID</td>
 <td>GameInstance Status</td>
 </tr>
 <tr>
 <td>t1</td>
 <td>SN-OLD</td>
 <td>paid</td>
 <td>true</td>
 <td>d1</td>
 <td>payout started</td>
 </tr>
 <tr>
 <td>t2</td>
 <td>SN-OLD</td>
 <td>accepted</td>
 <td>true</td>
 <td>d2</td>
 <td>active</td>
 </tr>
 <tr>
 <td>t3</td>
 <td>SN-OLD</td>
 <td>accepted</td>
 <td>true</td>
 <td>d3</td>
 <td>new</td>
 </tr>
 <tr>
 <td>t4</td>
 <td>SN-NEW</td>
 <td>accepted</td>
 <td>true</td>
 <td>d2</td>
 <td>active</td>
 </tr>
 <tr>
 <td>t5</td>
 <td>SN-NEW</td>
 <td>accepted</td>
 <td>true</td>
 <td>d3</td>
 <td>new</td>
 </tr>
 </table>
 And the log of new printed ticket will be:
 <table border="1">
 <tr>
 <td>ID</td>
 <td>SerialNo of OldTicket</td>
 <td>SerialNO of NewTicket</td>
 <td>Status</td>
 </tr>
 <tr>
 <td>1</td>
 <td>SN-OLD</td>
 <td>SN-NEW</td>
 <td>Wait Confirmation</td>
 </tr>
 </table>
 And payout entity will be:
 <table border="1">
 <tr>
 <td>ID</td>
 <td>Ticket SN</td>
 <td>Game Instance</td>
 <td>Type</td>
 <td>Status</td>
 </tr>
 <tr>
 <td>P1</td>
 <td>SN-OLD</td>
 <td>d1</td>
 <td>Winning</td>
 <td>Paid</td>
 </tr>
 </table>
 <p>
 Then a 'confirm payout(205)' request will be issued by client, when got this request, TE will be very sure that
 client has handled the 'payout' response successfully. After confirmation, the status will be:
 <table border="1">
 <tr>
 <td>TicketID</td>
 <td>Ticket SerialNo</td>
 <td>Ticket Status</td>
 <td>Is Count In Pool</td>
 <td>Transaction Type</td>
 <td>Game Instance ID</td>
 <td>GameInstance Status</td>
 </tr>
 <tr>
 <td>t1</td>
 <td>SN-OLD</td>
 <td>paid</td>
 <td>true</td>
 <td>200</td>
 <td>d1</td>
 <td>payout started</td>
 </tr>
 <tr>
 <td>t2</td>
 <td>SN-OLD</td>
 <td>invalid</td>
 <td>false</td>
 <td>200</td>
 <td>d2</td>
 <td>active</td>
 </tr>
 <tr>
 <td>t3</td>
 <td>SN-OLD</td>
 <td>invalid</td>
 <td>false</td>
 <td>200</td>
 <td>d3</td>
 <td>new</td>
 </tr>
 <tr>
 <td>t4</td>
 <td>SN-NEW</td>
 <td>accepted</td>
 <td>true</td>
 <td>302</td>
 <td>d2</td>
 <td>active</td>
 </tr>
 <tr>
 <td>t5</td>
 <td>SN-NEW</td>
 <td>accepted</td>
 <td>true</td>
 <td>302</td>
 <td>d3</td>
 <td>new</td>
 </tr>
 </table>
 And the log of new printed ticket will be:
 <table border="1">
 <tr>
 <td>ID</td>
 <td>SerialNo of OldTicket</td>
 <td>SerialNO of NewTicket</td>
 <td>Status</td>
 </tr>
 <tr>
 <td>1</td>
 <td>SN-OLD</td>
 <td>SN-NEW</td>
 <td>confirmed</td>
 </tr>
 </table>
 <p>
 If POS issue a reversal request instead of 'payout confirm', then after reversal:
 <table border="1">
 <tr>
 <td>TicketID</td>
 <td>Ticket SerialNo</td>
 <td>Ticket Status</td>
 <td>Is Count In Pool</td>
 <td>Transaction Type</td>
 <td>Game Instance ID</td>
 <td>GameInstance Status</td>
 </tr>
 <tr>
 <td>t1</td>
 <td>SN-OLD</td>
 <td>paid</td>
 <td>true</td>
 <td>200</td>
 <td>d1</td>
 <td>payout started</td>
 </tr>
 <tr>
 <td>t2</td>
 <td>SN-OLD</td>
 <td>accepted</td>
 <td>true</td>
 <td>200</td>
 <td>d2</td>
 <td>active</td>
 </tr>
 <tr>
 <td>t3</td>
 <td>SN-OLD</td>
 <td>accepted</td>
 <td>true</td>
 <td>200</td>
 <td>d3</td>
 <td>new</td>
 </tr>
 <tr>
 <td>t4</td>
 <td>SN-NEW</td>
 <td>invalid</td>
 <td>false</td>
 <td>302</td>
 <td>d2</td>
 <td>active</td>
 </tr>
 <tr>
 <td>t5</td>
 <td>SN-NEW</td>
 <td>invalid</td>
 <td>false</td>
 <td>302</td>
 <td>d3</td>
 <td>new</td>
 </tr>
 </table>
 And the log of new printed ticket will be:
 <table border="1">
 <tr>
 <td>ID</td>
 <td>SerialNo of OldTicket</td>
 <td>SerialNO of NewTicket</td>
 <td>Status</td>
 </tr>
 <tr>
 <td>1</td>
 <td>SN-OLD</td>
 <td>SN-NEW</td>
 <td>Reversed</td>
 </tr>
 </table>
 And the payout entity will be marked as 'reversed' too:
 <table border="1">
 <tr>
 <td>ID</td>
 <td>Ticket SN</td>
 <td>Game Instance</td>
 <td>Type</td>
 <td>Status</td>
 </tr>
 <tr>
 <td>P1</td>
 <td>SN-OLD</td>
 <td>d1</td>
 <td>Winning</td>
 <td>Reversed</td>
 </tr>
 </table>
 If it is a single draw ticket, 'payout confirm' can be simply ignored.
 <p>
 <h1>Refund Mode</h1>
 After payout, the ticket's status will be:
 <table border="1">
 <tr>
 <td>TicketID</td>
 <td>Ticket SerialNo</td>
 <td>Ticket Status</td>
 <td>Is Count In Pool</td>
 <td>Game Instance ID</td>
 <td>GameInstance Status</td>
 </tr>
 <tr>
 <td>t1</td>
 <td>SN-OLD</td>
 <td>paid</td>
 <td>true</td>
 <td>d1</td>
 <td>payout started</td>
 </tr>
 <tr>
 <td>t2</td>
 <td>SN-OLD</td>
 <td>returned</td>
 <td>false</td>
 <td>d2</td>
 <td>active</td>
 </tr>
 <tr>
 <td>t3</td>
 <td>SN-OLD</td>
 <td>returned</td>
 <td>false</td>
 <td>d3</td>
 <td>new</td>
 </tr>
 </table>
 And 1 payout entities will be generated(won't generate payout for 'returned' tickets):
 <table border="1">
 <tr>
 <td>ID</td>
 <td>Ticket SN</td>
 <td>Game Instance</td>
 <td>Type</td>
 <td>Status</td>
 </tr>
 <tr>
 <td>P1</td>
 <td>SN-OLD</td>
 <td>d1</td>
 <td>Winning</td>
 <td>Paid</td>
 </tr>
 </table>
 In this case, 'payout confirmation' will be ignored.
 
 <p>
 <b>Pre-Condition</b>
 <ul>
 <li>The sold draw must be 'payout started'</li>
 <li>The status of ticket(ticket record associate with sold draw) must be 'accepted'.</li>
 <li>Current time doesn't exceed last payout claim time.</li>
 <li>The PIN must be matched if client needs to input PIN.</li>
 </ul>
 <p>
 <b>Post-Condition</b>
 <ul>
 <li>Log the payout transaction.</li>
 <li>Update the ticket record of 'payout started' draw as 'paid'</li>
 <li>Generate 'NEW_PRIZE_TICKET' record(unconfirmed) if payout mode is 'print new ticket'.</li>
 <li>Generate 'TE_TICKET' from original winning ticket with a different serialNo, and status is 'accepted') if
 payout mode is 'print new ticket'.</li>
 <li>Generate 'PAYOUT' for each winning ticket record(type is winning, and only cash prize will be counted in
 prize amount and tax amount, etc)</li>
 <li>generate a return 'PAYOUT' if there are some unclaimed game instance and payout mode is 'refund'.</li>
 <li>Generate 'PAYOUT_DETAIL' for both cash and object prize.</li>
 <li>Retore merchant's credit level by actual amount.</li>
 </ul>
 <p>
 <b>Usage Restriction</b>
 <ul>
 <li>Authorization - Can only be called by signed in user.</li>
 <li>Concurrent Access - To a single device, this interface must be called sequentially. To multiple devices,
 there are no limitation on the number of concurrent accesses.</li>
 </ul></div>
<dl><dt><span class="strong">参数:</span></dt><dd><code>respCtx</code> - The context of transaction.</dd><dd><code>clientTicket</code> - The payout request. The following components of Ticket argument must not be null: serialNo,PIN(if the
            backend ask to verify PIN), inputChannel.</dd>
<dt><span class="strong">返回:</span></dt><dd>the payout result.</dd>
<dt><span class="strong">抛出:</span></dt>
<dd><code><a href="../../../../../../../com/mpos/lottery/te/config/exception/ApplicationException.html" title="com.mpos.lottery.te.config.exception中的类">ApplicationException</a></code> - when encounter any business exception.</dd></dl>
</li>
</ul>
<a name="confirmPayout(com.mpos.lottery.te.port.Context, com.mpos.lottery.te.gamespec.sale.BaseTicket)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>confirmPayout</h4>
<pre>void&nbsp;confirmPayout(<a href="../../../../../../../com/mpos/lottery/te/port/Context.html" title="com.mpos.lottery.te.port中的类">Context</a>&lt;?&gt;&nbsp;respCtx,
                 <a href="../../../../../../../com/mpos/lottery/te/gamespec/sale/BaseTicket.html" title="com.mpos.lottery.te.gamespec.sale中的类">BaseTicket</a>&nbsp;ticket)
                   throws <a href="../../../../../../../com/mpos/lottery/te/config/exception/ApplicationException.html" title="com.mpos.lottery.te.config.exception中的类">ApplicationException</a></pre>
<div class="block">Why we need payout confirmation??? The main goal of this transaction is to guarantee that all sold tickets will
 join winning analysis. If player buy a multiple-draw ticket, and this ticket win a prize. when player go to
 merchant to claim prize, merchant will do payout for all finished game draw, and do refund for all future game
 draw. If payout mode is 'print new ticket', there is possibility that 'conform' request can not reach TE. Does
 how TE handle this situation? If no confirm request reaches TE, client maybe encounter below 2 situations:
 <ul>
 <li>A: client has printed new ticket, and paid cash to player</li>
 <li>B: client didn't print new ticket, returned old physical ticket to player.</li>
 </ul>
 At TE, due to no confirm request received, both old tickets and new printed tickets are valid, they will both
 join winning analysis. Ultimately, either old or new printed tickets should be think as company absorption. To
 situation A, player has got prize and new printed ticket, he/she just thought the payout has finished
 successfully. Later he/she will maybe come back to claim prize with new printed tickets. So in this case, TE
 should think old tickets as company absorption. To situation B, player didn't got prize, he/she will get back the
 old tickets, so TE should think new printed tickets as company absorption.</div>
<dl><dt><span class="strong">抛出:</span></dt>
<dd><code><a href="../../../../../../../com/mpos/lottery/te/config/exception/ApplicationException.html" title="com.mpos.lottery.te.config.exception中的类">ApplicationException</a></code></dd><dt><span class="strong">另请参阅:</span></dt><dd><a href="../../../../../../../com/mpos/lottery/te/gamespec/prize/service/PrizeService.html#payout(com.mpos.lottery.te.port.Context,%20com.mpos.lottery.te.gamespec.sale.BaseTicket)"><code>payout(Context, BaseTicket)</code></a></dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="跳过导航链接"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="导航">
<li><a href="../../../../../../../overview-summary.html">概览</a></li>
<li><a href="package-summary.html">程序包</a></li>
<li class="navBarCell1Rev">类</li>
<li><a href="package-tree.html">树</a></li>
<li><a href="../../../../../../../deprecated-list.html">已过时</a></li>
<li><a href="../../../../../../../index-all.html">索引</a></li>
<li><a href="../../../../../../../help-doc.html">帮助</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>上一个类</li>
<li><a href="../../../../../../../com/mpos/lottery/te/gamespec/prize/service/TaxService.html" title="com.mpos.lottery.te.gamespec.prize.service中的接口"><span class="strong">下一个类</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../../index.html?com/mpos/lottery/te/gamespec/prize/service/PrizeService.html" target="_top">框架</a></li>
<li><a href="PrizeService.html" target="_top">无框架</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../../allclasses-noframe.html">所有类</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>概要:&nbsp;</li>
<li>嵌套&nbsp;|&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method_summary">方法</a></li>
</ul>
<ul class="subNavList">
<li>详细资料:&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method_detail">方法</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="zh">
<head>
<!-- Generated by javadoc (version 1.7.0_71) on Fri May 29 17:11:35 CST 2015 -->
<title>RiskControlService (sourcecode 2.5.2-rc7 API)</title>
<meta name="date" content="2015-05-29">
<link rel="stylesheet" type="text/css" href="../../../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="RiskControlService (sourcecode 2.5.2-rc7 API)";
    }
//-->
</script>
<noscript>
<div>您的浏览器已禁用 JavaScript。</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="跳过导航链接"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="导航">
<li><a href="../../../../../../../overview-summary.html">概览</a></li>
<li><a href="package-summary.html">程序包</a></li>
<li class="navBarCell1Rev">类</li>
<li><a href="package-tree.html">树</a></li>
<li><a href="../../../../../../../deprecated-list.html">已过时</a></li>
<li><a href="../../../../../../../index-all.html">索引</a></li>
<li><a href="../../../../../../../help-doc.html">帮助</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../../com/mpos/lottery/te/gamespec/sale/service/RiskControlLogServiceAsyn.html" title="com.mpos.lottery.te.gamespec.sale.service中的接口"><span class="strong">上一个类</span></a></li>
<li><a href="../../../../../../../com/mpos/lottery/te/gamespec/sale/service/TicketEnquiryService.html" title="com.mpos.lottery.te.gamespec.sale.service中的接口"><span class="strong">下一个类</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../../index.html?com/mpos/lottery/te/gamespec/sale/service/RiskControlService.html" target="_top">框架</a></li>
<li><a href="RiskControlService.html" target="_top">无框架</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../../allclasses-noframe.html">所有类</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>概要:&nbsp;</li>
<li>嵌套&nbsp;|&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method_summary">方法</a></li>
</ul>
<ul class="subNavList">
<li>详细资料:&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method_detail">方法</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.mpos.lottery.te.gamespec.sale.service</div>
<h2 title="接口 RiskControlService" class="title">接口 RiskControlService</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>所有已知实现类:</dt>
<dd><a href="../../../../../../../com/mpos/lottery/te/gamespec/sale/service/AbstractRiskControlService.html" title="com.mpos.lottery.te.gamespec.sale.service中的类">AbstractRiskControlService</a>, <a href="../../../../../../../com/mpos/lottery/te/gameimpl/digital/sale/support/DigitalRiskControlService.html" title="com.mpos.lottery.te.gameimpl.digital.sale.support中的类">DigitalRiskControlService</a>, <a href="../../../../../../../com/mpos/lottery/te/gameimpl/lfn/sale/support/LfnRiskControlService.html" title="com.mpos.lottery.te.gameimpl.lfn.sale.support中的类">LfnRiskControlService</a>, <a href="../../../../../../../com/mpos/lottery/te/gamespec/sale/service/NoRiskControlService.html" title="com.mpos.lottery.te.gamespec.sale.service中的类">NoRiskControlService</a></dd>
</dl>
<hr>
<br>
<pre>public interface <span class="strong">RiskControlService</span></pre>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>方法概要</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="方法概要表, 列表方法和解释">
<caption><span>方法</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">限定符和类型</th>
<th class="colLast" scope="col">方法和说明</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../com/mpos/lottery/te/gamespec/sale/service/RiskControlService.html#cancelRiskControl(com.mpos.lottery.te.port.Context,%20java.util.List)">cancelRiskControl</a></strong>(<a href="../../../../../../../com/mpos/lottery/te/port/Context.html" title="com.mpos.lottery.te.port中的类">Context</a>&nbsp;respCtx,
                 java.util.List&lt;? extends <a href="../../../../../../../com/mpos/lottery/te/gamespec/sale/BaseTicket.html" title="com.mpos.lottery.te.gamespec.sale中的类">BaseTicket</a>&gt;&nbsp;hostTickets)</code>
<div class="block">If client request to cancel the sale, the risk statistics(
 <a href="../../../../../../../com/mpos/lottery/te/gamespec/sale/RiskControlLog.html" title="com.mpos.lottery.te.gamespec.sale中的类"><code>RiskControlLog</code></a>) must be rolled back as well.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../com/mpos/lottery/te/gamespec/sale/service/RiskControlService.html#riskControl(com.mpos.lottery.te.port.Context,%20com.mpos.lottery.te.gamespec.sale.BaseTicket,%20java.util.List)">riskControl</a></strong>(<a href="../../../../../../../com/mpos/lottery/te/port/Context.html" title="com.mpos.lottery.te.port中的类">Context</a>&nbsp;respCtx,
           <a href="../../../../../../../com/mpos/lottery/te/gamespec/sale/BaseTicket.html" title="com.mpos.lottery.te.gamespec.sale中的类">BaseTicket</a>&nbsp;ticket,
           java.util.List&lt;? extends <a href="../../../../../../../com/mpos/lottery/te/gamespec/game/BaseGameInstance.html" title="com.mpos.lottery.te.gamespec.game中的类">BaseGameInstance</a>&gt;&nbsp;gameInstances)</code>
<div class="block">The basic idea of risk control is to check whether the total prize amount of a given selected number will exceed
 the ability to pay of operation company.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>方法详细资料</h3>
<a name="riskControl(com.mpos.lottery.te.port.Context, com.mpos.lottery.te.gamespec.sale.BaseTicket, java.util.List)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>riskControl</h4>
<pre>void&nbsp;riskControl(<a href="../../../../../../../com/mpos/lottery/te/port/Context.html" title="com.mpos.lottery.te.port中的类">Context</a>&nbsp;respCtx,
               <a href="../../../../../../../com/mpos/lottery/te/gamespec/sale/BaseTicket.html" title="com.mpos.lottery.te.gamespec.sale中的类">BaseTicket</a>&nbsp;ticket,
               java.util.List&lt;? extends <a href="../../../../../../../com/mpos/lottery/te/gamespec/game/BaseGameInstance.html" title="com.mpos.lottery.te.gamespec.game中的类">BaseGameInstance</a>&gt;&nbsp;gameInstances)
                 throws <a href="../../../../../../../com/mpos/lottery/te/config/exception/ApplicationException.html" title="com.mpos.lottery.te.config.exception中的类">ApplicationException</a></pre>
<div class="block">The basic idea of risk control is to check whether the total prize amount of a given selected number will exceed
 the ability to pay of operation company. That says once the given selected number wins, and many people buy that
 selected number, operation company may have to pay too much prize amount and fall in loss situation.
 <p>
 <b>The prize amount of a given selected number means the max prize amount a selected number may win, in general
 it is the 1st prize. </b>
 <p>
 System should support 2 kinds of risk control methods:
 
 <h2>1. Maximum LOSS Method</h2>
 <p>
 Operation company will set a limit, once the prize amount of a given selected number exceeds this limit, the sale
 request will be rejected.
 <p>
 For example, the bet amount of a selected number(single bet option) of '1,2,3,4,5' is 50, its odd is 40 times,
 and the limit is 2060.
 <ol>
 <li>A sale of this selected number comes, the bet amount is 1, the prize amount will be 51*40=2040, it is ok, the
 sale will be accepted.</li>
 <li>One more sale of this selected number comes, the bet amount is 1 too, the prize amount will be 52*40=2080
 which is greater than the limit 2060, this sale will be rejected.</li>
 </ol>
 
 <h2>2. Dynamic Method</h2>
 <p>
 Operation company will set a limit of allowed prize amount of a single selected number ,same with the 1st method
 'Maximum LOSS Method', and also will set a percentage of turnover. The final limit will be
 <b>max(preconfigured_limit, turnover*percentage)</b>, once the final limit is confirmed, the possible max prize
 amount of a given selected number will be compared with this limit, just like the 1st method.
 <p>
 Lets say the pre-configured prize limit is 2060, the turnover of current game instance is 5000, the percentage is
 42%,(5000*0.42=2100), the bet amount of a given selected number is 50 now, and the odd is 40 times.
 <ol>
 <li>New sale comes, its bet amount is 2, the limit of turnover percentage is (5000+2)*0.42=2100.84 which is
 greater than the pre-configured limit 2060, so the final limit will be 2100.84. The possible prize amount is
 (50+2)*40=2080, it is less than the final limit, sale is accepted.</li>
 <li>New sale comes, its bet amount is 10, the limit of turnover percentage is (5000+2+10)*0.42=2105.04 which is
 greater than the pre-configured limit 2060, so the final limit will be 2105.04. The possible prize amount is
 (50+2+10)*40=2480, it is greater than the final limit, sale is rejected.
 <p>
 Note that in this step the bet amount 10 is the amount of ticket, not a entry.</li>
 </ol></div>
<dl><dt><span class="strong">参数:</span></dt><dd><code>respCtx</code> - The context of current transaction.</dd><dd><code>ticket</code> - The sale instance.</dd><dd><code>gameInstances</code> - The game instances associate with the sold ticket, maybe multiple-draw ticket.</dd>
<dt><span class="strong">抛出:</span></dt>
<dd><code><a href="../../../../../../../com/mpos/lottery/te/config/exception/ApplicationException.html" title="com.mpos.lottery.te.config.exception中的类">ApplicationException</a></code> - when fail to pass risk control checking.</dd></dl>
</li>
</ul>
<a name="cancelRiskControl(com.mpos.lottery.te.port.Context, java.util.List)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>cancelRiskControl</h4>
<pre>void&nbsp;cancelRiskControl(<a href="../../../../../../../com/mpos/lottery/te/port/Context.html" title="com.mpos.lottery.te.port中的类">Context</a>&nbsp;respCtx,
                     java.util.List&lt;? extends <a href="../../../../../../../com/mpos/lottery/te/gamespec/sale/BaseTicket.html" title="com.mpos.lottery.te.gamespec.sale中的类">BaseTicket</a>&gt;&nbsp;hostTickets)
                       throws <a href="../../../../../../../com/mpos/lottery/te/config/exception/ApplicationException.html" title="com.mpos.lottery.te.config.exception中的类">ApplicationException</a></pre>
<div class="block">If client request to cancel the sale, the risk statistics(
 <a href="../../../../../../../com/mpos/lottery/te/gamespec/sale/RiskControlLog.html" title="com.mpos.lottery.te.gamespec.sale中的类"><code>RiskControlLog</code></a>) must be rolled back as well.</div>
<dl><dt><span class="strong">参数:</span></dt><dd><code>respCtx</code> - The context of current transaction</dd><dd><code>hostTickets</code> - The list of cancelled tickets.</dd>
<dt><span class="strong">抛出:</span></dt>
<dd><code><a href="../../../../../../../com/mpos/lottery/te/config/exception/ApplicationException.html" title="com.mpos.lottery.te.config.exception中的类">ApplicationException</a></code> - if any exception</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="跳过导航链接"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="导航">
<li><a href="../../../../../../../overview-summary.html">概览</a></li>
<li><a href="package-summary.html">程序包</a></li>
<li class="navBarCell1Rev">类</li>
<li><a href="package-tree.html">树</a></li>
<li><a href="../../../../../../../deprecated-list.html">已过时</a></li>
<li><a href="../../../../../../../index-all.html">索引</a></li>
<li><a href="../../../../../../../help-doc.html">帮助</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../../com/mpos/lottery/te/gamespec/sale/service/RiskControlLogServiceAsyn.html" title="com.mpos.lottery.te.gamespec.sale.service中的接口"><span class="strong">上一个类</span></a></li>
<li><a href="../../../../../../../com/mpos/lottery/te/gamespec/sale/service/TicketEnquiryService.html" title="com.mpos.lottery.te.gamespec.sale.service中的接口"><span class="strong">下一个类</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../../index.html?com/mpos/lottery/te/gamespec/sale/service/RiskControlService.html" target="_top">框架</a></li>
<li><a href="RiskControlService.html" target="_top">无框架</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../../allclasses-noframe.html">所有类</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>概要:&nbsp;</li>
<li>嵌套&nbsp;|&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method_summary">方法</a></li>
</ul>
<ul class="subNavList">
<li>详细资料:&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method_detail">方法</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>

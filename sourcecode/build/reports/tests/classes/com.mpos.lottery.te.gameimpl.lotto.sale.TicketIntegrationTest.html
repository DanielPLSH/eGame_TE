<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=edge"/>
<title>Test results - Class com.mpos.lottery.te.gameimpl.lotto.sale.TicketIntegrationTest</title>
<link href="../css/base-style.css" rel="stylesheet" type="text/css"/>
<link href="../css/style.css" rel="stylesheet" type="text/css"/>
<script src="../js/report.js" type="text/javascript"></script>
</head>
<body>
<div id="content">
<h1>Class com.mpos.lottery.te.gameimpl.lotto.sale.TicketIntegrationTest</h1>
<div class="breadcrumbs">
<a href="../index.html">all</a> &gt; 
<a href="../packages/com.mpos.lottery.te.gameimpl.lotto.sale.html">com.mpos.lottery.te.gameimpl.lotto.sale</a> &gt; TicketIntegrationTest</div>
<div id="summary">
<table>
<tr>
<td>
<div class="summaryGroup">
<table>
<tr>
<td>
<div class="infoBox" id="tests">
<div class="counter">17</div>
<p>tests</p>
</div>
</td>
<td>
<div class="infoBox" id="failures">
<div class="counter">0</div>
<p>failures</p>
</div>
</td>
<td>
<div class="infoBox" id="ignored">
<div class="counter">0</div>
<p>ignored</p>
</div>
</td>
<td>
<div class="infoBox" id="duration">
<div class="counter">1.793s</div>
<p>duration</p>
</div>
</td>
</tr>
</table>
</div>
</td>
<td>
<div class="infoBox success" id="successRate">
<div class="percent">100%</div>
<p>successful</p>
</div>
</td>
</tr>
</table>
</div>
<div id="tabs">
<ul class="tabLinks">
<li>
<a href="#tab0">Tests</a>
</li>
<li>
<a href="#tab1">Standard output</a>
</li>
</ul>
<div id="tab0" class="tab">
<h2>Tests</h2>
<table>
<thead>
<tr>
<th>Test</th>
<th>Duration</th>
<th>Result</th>
</tr>
</thead>
<tr>
<td class="success">testSell_GameInstanceSuspendSale</td>
<td>0.080s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testSell_MultiDraw_OK</td>
<td>0.093s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testSell_MultiDraw_SaleOnNewGameInstanceOK</td>
<td>0.092s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testSell_Multiple_ExceedAllowedMaxDraw_1</td>
<td>0.049s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testSell_Multiple_ExceedAllowedMaxDraw_2</td>
<td>0.049s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testSell_Multiple_Max_Fail</td>
<td>0.045s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testSell_Multiple_Max_NoLimit</td>
<td>0.080s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testSell_Multiple_Max_OK</td>
<td>0.138s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testSell_NoSaleAllowed</td>
<td>0.054s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testSell_ROLL_OK</td>
<td>0.075s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testSell_Single_NoValidationCode_OK</td>
<td>0.076s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testSell_Single_OK</td>
<td>0.615s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testSell_Single_PlayerSpecifyEntryAmount_ExceedMaxMultipleCount_OK</td>
<td>0.055s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testSell_Single_PlayerSpecifyEntryAmount_NotIntegerTimes_OK</td>
<td>0.061s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testSell_Single_PlayerSpecifyEntryAmount_OK</td>
<td>0.094s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testSell_Single_SaleOnNewGameInstance_Fail</td>
<td>0.039s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testSell_Single_SaleOnNewGameInstance_OK</td>
<td>0.098s</td>
<td class="success">passed</td>
</tr>
</table>
</div>
<div id="tab1" class="tab">
<h2>Standard output</h2>
<span class="code">
<pre>[2015-05-29 17:13:23,613][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:23,614][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:23,614][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@526dcbc2) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:23,614][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:23,614][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:23,614][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:23,614][Test worker][INFO ][BaseTransactionalIntegrationTest] | TicketIntegrationTest.testSell_Multiple_Max_OK                                                                         |
[2015-05-29 17:13:23,614][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:23,618][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:23,636][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml).
[2015-05-29 17:13:23,637][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803618|Timestamp:20150529171323|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;21000&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,4,5,6,7,8,9,11&quot; betOption=&quot;2&quot; inputChannel=&quot;0&quot; boostAmount=&quot;100&quot;/&gt;&lt;/Ticket&gt;,hash=60785616), get digest:c4cb1c44d51f4ab2dabf016b10c22387
[2015-05-29 17:13:23,637][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:23,637][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:23,637][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171323).
[2015-05-29 17:13:23,637][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:23,637][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890803618).
[2015-05-29 17:13:23,637][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:23,637][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:23,637][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=c4cb1c44d51f4ab2dabf016b10c22387).
[2015-05-29 17:13:23,637][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=1).
[2015-05-29 17:13:23,637][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:23,637][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:23,639][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfnfSvzUuvi5gIW+x7OzQghYn7q3Tli+UM7ayhdm9J2jVoPO9GbJ0rAwHrpjwLhHY9Hf+PcJvM2mycKSvIH50op2KIbKEfPYcW2zgKmswS5Pc3C+eekWSz+DFdqeZ1RxNxX7n+fFt8U2mAYXCZ9EFoSMQ0Ehf6NDimIrlgK1Z3qz2zS4RLUFLI1MwFRlg71UX6v/0p3ZL7Wly16wgAkq6XjlKboWUx55AJ1KfjuUU1ZAN4lqweLwMwd3pl9PzGjU/PDeLiNblGC7iLw==.
[2015-05-29 17:13:23,639][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803618|Timestamp:20150529171323|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:23,640][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;21000&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,4,5,6,7,8,9,11&quot; betOption=&quot;2&quot; inputChannel=&quot;0&quot; boostAmount=&quot;100&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:23,640][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803618|Timestamp:20150529171323|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;21000&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,4,5,6,7,8,9,11&quot; betOption=&quot;2&quot; inputChannel=&quot;0&quot; boostAmount=&quot;100&quot;/&gt;&lt;/Ticket&gt;,hash=60785616), get digest:c4cb1c44d51f4ab2dabf016b10c22387
[2015-05-29 17:13:23,640][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:23,640][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml
[2015-05-29 17:13:23,640][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:23,654][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_1.5.0).
[2015-05-29 17:13:23,654][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_).
[2015-05-29 17:13:23,654][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(1_200_), found controller(com.mpos.lottery.te.gameimpl.lotto.LottoController@388c6589) and method(public void com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:23,675][Test worker][DEBUG][AbstractGameInstanceService] Use channel game instance time definition(IGPE-1).
[2015-05-29 17:13:23,675][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745119300008327
[2015-05-29 17:13:23,681][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:23,681][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.MultipleSelectedNumberValidator@3f6e7574) for bet option:2
[2015-05-29 17:13:23,694][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:23,694][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:23,694][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199979000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:23,703][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.1]: transaction {
  id: &quot;0115052900000000001339&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890803000
  trans_type: 200
  game_id: &quot;GAME-111&quot;
  game_type: 1
  total_amount: &quot;21000&quot;
}
multi_draw: 1
total_amount: &quot;21000&quot;
serial_no: &quot;aHhDkgTyIu435nz4N2Otv2IzSqgbVOe/&quot;
game_instance {
  id: &quot;GII-113&quot;
}
entries {
  selected_number: &quot;1,2,3,4,5,6,7,8,9,11&quot;
  bet_option: 2
  total_bets: 210
  entry_amount: &quot;21000&quot;
  input_channel: &quot;0&quot;
}

[2015-05-29 17:13:23,704][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:23,704][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:23,704][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket),mappingFile=xml-mapping/game/lotto/SellTicket_Res.xml
[2015-05-29 17:13:23,704][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:23,725][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Res.xml).
[2015-05-29 17:13:23,725][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803618|Timestamp:20150529171323|Transaction-Type:4200|Transaction-Id:0115052900000000001339|Response-Code:200|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01110745119300008327&quot; type=&quot;1&quot; lastDrawNo=&quot;20090408&quot; barcode=&quot;01cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcpaAg0Y/Qh2mgwfOrj5/hBE=&quot; validationCode=&quot;095212&quot; multipleDraws=&quot;1&quot; totalBets=&quot;210&quot; totalAmount=&quot;21000&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,4,5,6,7,8,9,11&quot; betOption=&quot;2&quot; inputChannel=&quot;0&quot; entryAmount=&quot;21000&quot; boostAmount=&quot;100&quot;/&gt;&lt;/Ticket&gt;):f1dc0369c2a694e9617b3db4a5120a1b
[2015-05-29 17:13:23,726][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=608) succesfully.
[2015-05-29 17:13:23,726][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=608): &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01110745119300008327&quot; type=&quot;1&quot; lastDrawNo=&quot;20090408&quot; barcode=&quot;01cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcpaAg0Y/Qh2mgwfOrj5/hBE=&quot; validationCode=&quot;095212&quot; multipleDraws=&quot;1&quot; totalBets=&quot;210&quot; totalAmount=&quot;21000&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,4,5,6,7,8,9,11&quot; betOption=&quot;2&quot; inputChannel=&quot;0&quot; entryAmount=&quot;21000&quot; boostAmount=&quot;100&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:23,727][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:23,745][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:23,745][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:23,745][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@4401cad2) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:23,746][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:23,746][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:23,746][Test worker][INFO ][BaseTransactionalIntegrationTest] | TicketIntegrationTest.testSell_GameInstanceSuspendSale                                                                 |
[2015-05-29 17:13:23,746][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:23,747][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:23,748][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml).
[2015-05-29 17:13:23,749][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803747|Timestamp:20150529171323|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;1600&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=-2133888931), get digest:21c6ec581f453510d45c1800a68e6c12
[2015-05-29 17:13:23,749][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:23,749][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:23,749][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171323).
[2015-05-29 17:13:23,750][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:23,750][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890803747).
[2015-05-29 17:13:23,750][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:23,750][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:23,750][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=21c6ec581f453510d45c1800a68e6c12).
[2015-05-29 17:13:23,750][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=1).
[2015-05-29 17:13:23,750][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:23,750][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:23,753][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9pDpTDScnIWI62pEFB0SGtKkhmSVtwRhObbaRtENvsKgd1vgEj9cakrUbLVxBSMJqciae7U9vnZ9gkPZ+TiqwdRl/00lYrPXIRF649XUAfZ/u7Ik8R7r7YZCfSM8Dq3Lk3E+I+8dy5FMq1JBSOx+CBYDZ3n4iWwIrRwN3i9ic9EHYxaBXmh5eMdb+eYfmG3rw7BmwCbT+5YlwzT8o+qK8+x+tCRF0yCaqlMPxlqr0c+eFde9h31TBTgqMtIWk2Ux1nb1TPJ2uDK+Ee2oZ5RgoEzb/nuc9f7RCFw4/R0o1FObopbRaJ9qpV2PI6XK6rtTl1lpL4o22ySC7lKR344K/b+MKthKWb3jb.
[2015-05-29 17:13:23,753][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803747|Timestamp:20150529171323|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:23,754][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;1600&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:23,754][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803747|Timestamp:20150529171323|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;1600&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=-2133888931), get digest:21c6ec581f453510d45c1800a68e6c12
[2015-05-29 17:13:23,754][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:23,754][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml
[2015-05-29 17:13:23,754][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:23,780][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_1.5.0).
[2015-05-29 17:13:23,780][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_).
[2015-05-29 17:13:23,780][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(1_200_), found controller(com.mpos.lottery.te.gameimpl.lotto.LottoController@388c6589) and method(public void com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:23,805][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lotto.draw.domain.LottoGameInstance) by(number=20090408,gameId=GAME-111, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:23,813][Test worker][DEBUG][AbstractGameInstanceService] Use channel game instance time definition(IGPE-1).
[2015-05-29 17:13:23,813][Test worker][ERROR][AbstractGameInstanceService] The game instance(number=20090408,game.type=1,status=2,startSellintTime=2015-05-28 17:12:14.0,stopSellTime=Sat May 30 17:11:14 CST 2015,suspendSale=true) doesn't accept sale.
[2015-05-29 17:13:23,813][Test worker][ERROR][TEPortServlet] Game instance has suspended sale.
com.mpos.lottery.te.config.exception.ApplicationException: Game instance has suspended sale.
	at com.mpos.lottery.te.gamespec.game.service.impl.AbstractGameInstanceService.allowSale(AbstractGameInstanceService.java:242)
	at com.mpos.lottery.te.gamespec.game.service.impl.AbstractGameInstanceService.doEnquiryMultiDraw(AbstractGameInstanceService.java:182)
	at com.mpos.lottery.te.gamespec.game.service.impl.AbstractGameInstanceService.enquirySaleReady(AbstractGameInstanceService.java:98)
	at sun.reflect.GeneratedMethodAccessor131.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy54.enquirySaleReady(Unknown Source)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.lookupSaleReadyGameInstance(AbstractTicketService.java:348)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:123)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(LottoController.java:32)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.lotto.sale.TicketIntegrationTest.testSell_GameInstanceSuspendSale(TicketIntegrationTest.java:597)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:23,815][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803747|Timestamp:20150529171323|Transaction-Type:4200|Transaction-Id:0115052900000000001342|Response-Code:310|):dce382622b12380266dd8d437b5168c0
[2015-05-29 17:13:23,816][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=310,length=0): 
[2015-05-29 17:13:23,826][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:23,827][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:23,827][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@47c8d05a) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:23,827][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:23,828][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:23,828][Test worker][INFO ][BaseTransactionalIntegrationTest] | TicketIntegrationTest.testSell_Single_PlayerSpecifyEntryAmount_NotIntegerTimes_OK                                      |
[2015-05-29 17:13:23,828][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:23,828][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:23,830][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml).
[2015-05-29 17:13:23,831][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803828|Timestamp:20150529171323|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;2500.1&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;300.0&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;1400.1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=-1734161568), get digest:1c723416b1970933d0310c292a80e45c
[2015-05-29 17:13:23,831][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:23,831][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:23,831][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171323).
[2015-05-29 17:13:23,831][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:23,831][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890803828).
[2015-05-29 17:13:23,831][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:23,831][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:23,831][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=1c723416b1970933d0310c292a80e45c).
[2015-05-29 17:13:23,831][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=1).
[2015-05-29 17:13:23,831][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:23,831][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:23,833][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfnfSvzUuvi5gIW+x7OzQghYnehIGuRXV/L/UYuBeBfbq5ehucdfmlm82XYUSySFpC59TfsJXIZEz20HBG6z5bnJlACgcXlXkiv3cz1fP7QVG2NPgoNoFckPBuqXjgPiB2oll3u9pPZR5f3KAJlfsg0YnN9pVhPoeDWj2Sx5R0lRb/FEp3f3E/OzxNs+2lg4bop1wv2XrDcnReUUGbBl/NPwt5FIM/BA/WurahMf+PZ9N6pv+gZDNz2ttlLcyi4TnPu89CE6ma34JEdmgm2nayhlYYBC7/WgR4c04B2hdm+wVAygYAxgtrouUFTd2RrFrT8rXAneMjoBeExFKmz1RO+P6vLCVCPG+6u052Xax5RrcdDAdzfrC4k2j+0+R4+aIwJjSL5HNP/N9ZH+TOJYETf4tsV31kLKNkw1CuqIBy08o8vIr34z+9RzNAg3w7q1Myu0d4vjc5EmGo4lZwjnjAlpqYoZnrKy/zAZCNKDdfn+EYAfFjcqVIj602J4KwWNF/1SuOGCi/lGkoQKX6O4Zs9Q0PmU7cXUgT+woASQZ3rz26fkLJ76qCz/md2o0eMiwBEY/iiXFgkgq/0LmydOpwoJ2soIKX7vD/kIgseH1FDafy3wMz1BEufup/Fr0H67uvlqmN6lbP9qaExTDQwcgHpD2WKBcz5bdi44=.
[2015-05-29 17:13:23,833][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803828|Timestamp:20150529171323|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:23,834][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;2500.1&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;300.0&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;1400.1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:23,834][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803828|Timestamp:20150529171323|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;2500.1&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;300.0&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;1400.1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=-1734161568), get digest:1c723416b1970933d0310c292a80e45c
[2015-05-29 17:13:23,834][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:23,834][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml
[2015-05-29 17:13:23,834][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:23,858][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_1.5.0).
[2015-05-29 17:13:23,858][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_).
[2015-05-29 17:13:23,858][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(1_200_), found controller(com.mpos.lottery.te.gameimpl.lotto.LottoController@388c6589) and method(public void com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:23,868][Test worker][DEBUG][AbstractGameInstanceService] Use channel game instance time definition(IGPE-1).
[2015-05-29 17:13:23,868][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745119300008466
[2015-05-29 17:13:23,875][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:23,875][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.SingleSelectedNumberValidator@191b3547) for bet option:1
[2015-05-29 17:13:23,875][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.MultipleSelectedNumberValidator@4946d531) for bet option:2
[2015-05-29 17:13:23,875][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.SingleSelectedNumberValidator@4956a98c) for bet option:1
[2015-05-29 17:13:23,876][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.MultipleSelectedNumberValidator@58954bf1) for bet option:2
[2015-05-29 17:13:23,876][Test worker][ERROR][TEPortServlet] The entry amount(1400.1) of entry(3,11,14,16,22,25,36) isn't integer multiple times of base amount(100
com.mpos.lottery.te.config.exception.ApplicationException: The entry amount(1400.1) of entry(3,11,14,16,22,25,36) isn't integer multiple times of base amount(100
	at com.mpos.lottery.te.gameimpl.lotto.sale.support.LottoTicketValidator.calculateEntryAmount(LottoTicketValidator.java:42)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validate(DefaultTicketValidator.java:47)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.validateTicketRequest(AbstractTicketService.java:386)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:140)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(LottoController.java:32)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.lotto.sale.TicketIntegrationTest.testSell_Single_PlayerSpecifyEntryAmount_NotIntegerTimes_OK(TicketIntegrationTest.java:285)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:23,877][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803828|Timestamp:20150529171323|Transaction-Type:4200|Transaction-Id:0115052900000000001343|Response-Code:307|):3f3223e433f1ab14d3265d4f0f186c09
[2015-05-29 17:13:23,878][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=307,length=0): 
[2015-05-29 17:13:23,886][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:23,887][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:23,887][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@e59f54d) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:23,887][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:23,887][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:23,887][Test worker][INFO ][BaseTransactionalIntegrationTest] | TicketIntegrationTest.testSell_Single_SaleOnNewGameInstance_OK                                                         |
[2015-05-29 17:13:23,887][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:23,892][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:23,893][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml).
[2015-05-29 17:13:23,893][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803892|Timestamp:20150529171323|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;800&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090416&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=825774571), get digest:048839f9f6b37e44fabd912d8050ff8a
[2015-05-29 17:13:23,893][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:23,893][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:23,893][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171323).
[2015-05-29 17:13:23,893][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:23,893][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890803892).
[2015-05-29 17:13:23,894][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:23,894][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:23,894][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=048839f9f6b37e44fabd912d8050ff8a).
[2015-05-29 17:13:23,894][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=1).
[2015-05-29 17:13:23,894][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:23,894][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:23,895][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfnfSvzUuvi5gIW+x7OzQghYnImZvTQ1xCUUG6+eUQPoWv7dGtkcUmbKplpcI3SAtQHMEUt6rVVkwSEIl8TZT7F/jiYIaXamlV6UBBEDVKxW+hPc+bUwmA7A70NEv0ZzMRiKHg82ny6QjArOL9rHIxlXqc0FC7ZuOaqrG3PYHkJ/O7htXvvan/VwPI5rkwkX1y2659gMT4V9KlklgDO678FKn4hrieK8lVsPyBlyX0PZMAv/Bvuc/uAxOicDTqkljsF5hUq6Uq2O/IRT9CRMbC3lgSedfHeA6hYcgSAtAEi6e0zbEMsSposgFe0K4CYzoR3z7des7ShndWKAqrq5ZEnTIAkVsTXkcuQ7wOhmHiTjh2+N2cWYBX2Qx.
[2015-05-29 17:13:23,895][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803892|Timestamp:20150529171323|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:23,896][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;800&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090416&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:23,896][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803892|Timestamp:20150529171323|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;800&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090416&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=825774571), get digest:048839f9f6b37e44fabd912d8050ff8a
[2015-05-29 17:13:23,896][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:23,896][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml
[2015-05-29 17:13:23,896][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:23,908][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_1.5.0).
[2015-05-29 17:13:23,908][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_).
[2015-05-29 17:13:23,908][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(1_200_), found controller(com.mpos.lottery.te.gameimpl.lotto.LottoController@388c6589) and method(public void com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:23,916][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745119300008537
[2015-05-29 17:13:23,922][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:23,922][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.SingleSelectedNumberValidator@29b61ebf) for bet option:1
[2015-05-29 17:13:23,922][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.MultipleSelectedNumberValidator@739ca2fd) for bet option:2
[2015-05-29 17:13:23,936][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:23,936][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:23,936][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199999200, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:23,946][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.1]: transaction {
  id: &quot;0115052900000000001344&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890803000
  trans_type: 200
  game_id: &quot;GAME-111&quot;
  game_type: 1
  total_amount: &quot;800&quot;
}
multi_draw: 1
total_amount: &quot;800&quot;
serial_no: &quot;aHhDkgTyIu435nz4N2Otv3xrI3RVoypA&quot;
game_instance {
  id: &quot;GII-114&quot;
}
entries {
  selected_number: &quot;1,2,3,6,7,13&quot;
  bet_option: 1
  total_bets: 1
  entry_amount: &quot;100&quot;
  input_channel: &quot;1&quot;
}
entries {
  selected_number: &quot;3,11,14,16,22,25,36&quot;
  bet_option: 2
  total_bets: 7
  entry_amount: &quot;700&quot;
  input_channel: &quot;1&quot;
}

[2015-05-29 17:13:23,947][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:23,947][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:23,947][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket),mappingFile=xml-mapping/game/lotto/SellTicket_Res.xml
[2015-05-29 17:13:23,947][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:23,948][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Res.xml).
[2015-05-29 17:13:23,948][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803892|Timestamp:20150529171323|Transaction-Type:4200|Transaction-Id:0115052900000000001344|Response-Code:200|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01110745119300008537&quot; type=&quot;1&quot; lastDrawNo=&quot;20090416&quot; barcode=&quot;01cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcpaAg0Y/Qh2mApl7I5KWQ5o=&quot; validationCode=&quot;074375&quot; multipleDraws=&quot;1&quot; totalBets=&quot;8&quot; totalAmount=&quot;800&quot;&gt;&lt;GameDraw number=&quot;20090416&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;100&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;700&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;):bc67ddcb62f460ce18fdf0752a70f758
[2015-05-29 17:13:23,949][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=736) succesfully.
[2015-05-29 17:13:23,949][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=736): &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01110745119300008537&quot; type=&quot;1&quot; lastDrawNo=&quot;20090416&quot; barcode=&quot;01cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcpaAg0Y/Qh2mApl7I5KWQ5o=&quot; validationCode=&quot;074375&quot; multipleDraws=&quot;1&quot; totalBets=&quot;8&quot; totalAmount=&quot;800&quot;&gt;&lt;GameDraw number=&quot;20090416&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;100&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;700&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:23,949][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:23,985][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:23,985][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:23,985][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@406e9a59) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:23,986][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:23,986][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:23,986][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:23,986][Test worker][INFO ][BaseTransactionalIntegrationTest] | TicketIntegrationTest.testSell_Multiple_Max_NoLimit                                                                    |
[2015-05-29 17:13:23,986][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:23,987][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:23,988][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml).
[2015-05-29 17:13:23,989][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803987|Timestamp:20150529171323|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;46200&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,4,5,6,7,8,9,11,12&quot; betOption=&quot;2&quot; inputChannel=&quot;0&quot; boostAmount=&quot;100&quot;/&gt;&lt;/Ticket&gt;,hash=1178970295), get digest:d7c56429f1f2c41aa9c20fb70542653b
[2015-05-29 17:13:23,989][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:23,989][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:23,989][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171323).
[2015-05-29 17:13:23,989][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:23,989][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890803987).
[2015-05-29 17:13:23,989][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:23,989][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:23,989][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=d7c56429f1f2c41aa9c20fb70542653b).
[2015-05-29 17:13:23,989][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=1).
[2015-05-29 17:13:23,989][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:23,989][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:23,991][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfnfSvzUuvi5gIW+x7OzQghYnfBGRMNA8wv/4CfboRrDifVx/RkEa8wtR6Gv04TSHlpuY/rSnYXmeJ3qMcqrSkBOf4djDXPaeLVTx0Iev72M1hM/XLe8ycRxkPCtyrfSCbIJkRs3utL4JGtDjZqZ770HbJgiOaIcBE2xSfqRTxE9kMmPg+66sgD6poYcijxhgV/CObHdaS2XJ0ZTqoWxZDDty2BJqIhbtDargdN9V/ivrOJo2n/Y18bJOi1B1eKBltQnQUqh8C7Ptlg==.
[2015-05-29 17:13:23,991][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803987|Timestamp:20150529171323|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:23,991][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;46200&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,4,5,6,7,8,9,11,12&quot; betOption=&quot;2&quot; inputChannel=&quot;0&quot; boostAmount=&quot;100&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:23,991][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803987|Timestamp:20150529171323|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;46200&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,4,5,6,7,8,9,11,12&quot; betOption=&quot;2&quot; inputChannel=&quot;0&quot; boostAmount=&quot;100&quot;/&gt;&lt;/Ticket&gt;,hash=1178970295), get digest:d7c56429f1f2c41aa9c20fb70542653b
[2015-05-29 17:13:23,991][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:23,991][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml
[2015-05-29 17:13:23,991][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:24,005][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_1.5.0).
[2015-05-29 17:13:24,005][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_).
[2015-05-29 17:13:24,005][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(1_200_), found controller(com.mpos.lottery.te.gameimpl.lotto.LottoController@388c6589) and method(public void com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:24,014][Test worker][DEBUG][AbstractGameInstanceService] Use channel game instance time definition(IGPE-1).
[2015-05-29 17:13:24,015][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745119300008656
[2015-05-29 17:13:24,021][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:24,021][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.MultipleSelectedNumberValidator@ef0e388) for bet option:2
[2015-05-29 17:13:24,039][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:24,039][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:24,039][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199953800, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:24,049][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.1]: transaction {
  id: &quot;0115052900000000001348&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890803000
  trans_type: 200
  game_id: &quot;GAME-111&quot;
  game_type: 1
  total_amount: &quot;46200&quot;
}
multi_draw: 1
total_amount: &quot;46200&quot;
serial_no: &quot;aHhDkgTyIu435nz4N2OtvyfokaMxXgJY&quot;
game_instance {
  id: &quot;GII-113&quot;
}
entries {
  selected_number: &quot;1,2,3,4,5,6,7,8,9,11,12&quot;
  bet_option: 2
  total_bets: 462
  entry_amount: &quot;46200&quot;
  input_channel: &quot;0&quot;
}

[2015-05-29 17:13:24,050][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:24,050][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:24,050][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket),mappingFile=xml-mapping/game/lotto/SellTicket_Res.xml
[2015-05-29 17:13:24,050][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:24,051][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Res.xml).
[2015-05-29 17:13:24,051][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890803987|Timestamp:20150529171323|Transaction-Type:4200|Transaction-Id:0115052900000000001348|Response-Code:200|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01110745119300008656&quot; type=&quot;1&quot; lastDrawNo=&quot;20090408&quot; barcode=&quot;01cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcpaAg0Y/Qh2m4cVbn9vGvtI=&quot; validationCode=&quot;623868&quot; multipleDraws=&quot;1&quot; totalBets=&quot;462&quot; totalAmount=&quot;46200&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,4,5,6,7,8,9,11,12&quot; betOption=&quot;2&quot; inputChannel=&quot;0&quot; entryAmount=&quot;46200&quot; boostAmount=&quot;100&quot;/&gt;&lt;/Ticket&gt;):96b4f3b5033c884ce8215443757979bf
[2015-05-29 17:13:24,051][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=608) succesfully.
[2015-05-29 17:13:24,052][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=608): &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01110745119300008656&quot; type=&quot;1&quot; lastDrawNo=&quot;20090408&quot; barcode=&quot;01cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcpaAg0Y/Qh2m4cVbn9vGvtI=&quot; validationCode=&quot;623868&quot; multipleDraws=&quot;1&quot; totalBets=&quot;462&quot; totalAmount=&quot;46200&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,4,5,6,7,8,9,11,12&quot; betOption=&quot;2&quot; inputChannel=&quot;0&quot; entryAmount=&quot;46200&quot; boostAmount=&quot;100&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:24,052][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:24,065][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:24,065][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:24,065][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@12a83730) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:24,065][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:24,067][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:24,067][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:24,067][Test worker][INFO ][BaseTransactionalIntegrationTest] | TicketIntegrationTest.testSell_Multiple_Max_Fail                                                                       |
[2015-05-29 17:13:24,067][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:24,067][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:24,068][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml).
[2015-05-29 17:13:24,068][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804067|Timestamp:20150529171324|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;199&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,4,5,6,7,8,9,11,12&quot; betOption=&quot;2&quot; inputChannel=&quot;0&quot; boostAmount=&quot;100&quot;/&gt;&lt;/Ticket&gt;,hash=1809957037), get digest:e30c45625f25a74867b3fc252ef9d763
[2015-05-29 17:13:24,068][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:24,068][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:24,068][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171324).
[2015-05-29 17:13:24,068][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:24,068][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890804067).
[2015-05-29 17:13:24,068][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:24,069][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:24,069][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=e30c45625f25a74867b3fc252ef9d763).
[2015-05-29 17:13:24,069][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=1).
[2015-05-29 17:13:24,069][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:24,069][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:24,070][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfnfSvzUuvi5gIW+x7OzQghYnQX+wagGqYAB65Ib/iTbedTkIY5iEf5JtzMxURcEwvjI7lH0ylKdZQezjEP50Vf3GT2fLw6UokW8mpa1obCMLahzVnjZLo8VI63MOp3dLOEt2A/VmLLp88x6wyXut1DH0iMKj7dpvdPpuy5St/04207YRS/EPM/Vu5XPlNg3RQHRmM6OX/1ni6+ximycaE6fQ/Dxh5Q8JqL0ybDB++sL9C8CpszILAQszwaSQdwhK5RqkW8OQ+I/lUg==.
[2015-05-29 17:13:24,070][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804067|Timestamp:20150529171324|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:24,071][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;199&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,4,5,6,7,8,9,11,12&quot; betOption=&quot;2&quot; inputChannel=&quot;0&quot; boostAmount=&quot;100&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:24,071][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804067|Timestamp:20150529171324|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;199&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,4,5,6,7,8,9,11,12&quot; betOption=&quot;2&quot; inputChannel=&quot;0&quot; boostAmount=&quot;100&quot;/&gt;&lt;/Ticket&gt;,hash=1809957037), get digest:e30c45625f25a74867b3fc252ef9d763
[2015-05-29 17:13:24,071][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:24,071][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml
[2015-05-29 17:13:24,071][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:24,085][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_1.5.0).
[2015-05-29 17:13:24,085][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_).
[2015-05-29 17:13:24,085][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(1_200_), found controller(com.mpos.lottery.te.gameimpl.lotto.LottoController@388c6589) and method(public void com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:24,093][Test worker][DEBUG][AbstractGameInstanceService] Use channel game instance time definition(IGPE-1).
[2015-05-29 17:13:24,095][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745119300008790
[2015-05-29 17:13:24,101][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:24,101][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.MultipleSelectedNumberValidator@191f5509) for bet option:2
[2015-05-29 17:13:24,101][Test worker][ERROR][TEPortServlet] The total bets of selectd number:1,2,3,4,5,6,7,8,9,11,12 is 462, it exceeds the max allowed bets: 10 of merchant(id=111).
com.mpos.lottery.te.config.exception.ApplicationException: The total bets of selectd number:1,2,3,4,5,6,7,8,9,11,12 is 462, it exceeds the max allowed bets: 10 of merchant(id=111).
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validateMaxAllowedEntryBets(DefaultTicketValidator.java:100)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validate(DefaultTicketValidator.java:48)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.validateTicketRequest(AbstractTicketService.java:386)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:140)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(LottoController.java:32)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.lotto.sale.TicketIntegrationTest.testSell_Multiple_Max_Fail(TicketIntegrationTest.java:491)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:24,102][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804067|Timestamp:20150529171324|Transaction-Type:4200|Transaction-Id:0115052900000000001351|Response-Code:348|):e81ce70e1b041d27b44f5319fb859afe
[2015-05-29 17:13:24,103][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=348,length=0): 
[2015-05-29 17:13:24,115][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:24,115][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:24,115][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@5fce04c1) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:24,116][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:24,116][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:24,116][Test worker][INFO ][BaseTransactionalIntegrationTest] | TicketIntegrationTest.testSell_Single_PlayerSpecifyEntryAmount_ExceedMaxMultipleCount_OK                               |
[2015-05-29 17:13:24,117][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:24,118][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:24,119][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml).
[2015-05-29 17:13:24,120][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804118|Timestamp:20150529171324|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;2500.0&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;300.0&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;1400.0&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=360751222), get digest:3697c56c79b14303c67afe6698505a26
[2015-05-29 17:13:24,120][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:24,120][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:24,120][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171324).
[2015-05-29 17:13:24,120][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:24,120][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890804118).
[2015-05-29 17:13:24,120][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:24,120][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:24,120][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=3697c56c79b14303c67afe6698505a26).
[2015-05-29 17:13:24,120][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=1).
[2015-05-29 17:13:24,120][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:24,120][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:24,123][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfnfSvzUuvi5gIW+x7OzQghYnehIGuRXV/L81/phvhu7gTIvUKb7CAaoC886riIiA+w/cQoe+Y+Bwa8vhC53/d7a3wHJFQB1lly8TTmj5TqEIJoL2duDxsS9nmZAsXzjX9XZLhu+TYjCXhJ+3ardTSdrfdhvkx1f2uan9lA+epF+DbtiY6pmoeVzQ2FFF8kVS77bQQfR0SOnEoezdQ3I01Qm1tJfgFJBWAjTAeG2eFCgL4BW2SXs9MJOGS2cpSEnN7oAF64RaVoxVs9MLGMlZMb5fI28GMJXUISHV3owtLKMY00T/g5jNNLcxZadwl5Tm1GSUkRTX1mQr/N/kOwjep7bP9oL9EPn7h3zQnEDGUh7bhP8Y7epJCaAuaYOxmeqG4vn165KMPssxS3ExhrufbsGTJTgL7i4vfhbKVptfMUW/QwUrYVqeK+hEqUHBikSpOMvt86INtH/iSjqTTf5uwi1ItGXyk8PP/n+4qTZAZRDQAO2ZnN3y3UnWBadHlcaCU7aK9HY3Z3yYIIJH60j61VA0bThcXykf/rEOLya+7ETXDVg3VHk/TgDaPlWlRZpiLv7U1vrMxAum/B8mC4/+bPK+lyrNYMJpjVsrE+oQhQqL0IcYqmWq2M1EyX2Tef99jtPIVqY7BZmCue6/hdd6NWtRI5C3XBsXH0E=.
[2015-05-29 17:13:24,124][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804118|Timestamp:20150529171324|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:24,124][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;2500.0&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;300.0&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;1400.0&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:24,124][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804118|Timestamp:20150529171324|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;2500.0&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;300.0&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;1400.0&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=360751222), get digest:3697c56c79b14303c67afe6698505a26
[2015-05-29 17:13:24,124][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:24,124][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml
[2015-05-29 17:13:24,124][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:24,138][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_1.5.0).
[2015-05-29 17:13:24,138][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_).
[2015-05-29 17:13:24,138][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(1_200_), found controller(com.mpos.lottery.te.gameimpl.lotto.LottoController@388c6589) and method(public void com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:24,146][Test worker][DEBUG][AbstractGameInstanceService] Use channel game instance time definition(IGPE-1).
[2015-05-29 17:13:24,146][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745119300008867
[2015-05-29 17:13:24,153][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:24,153][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.SingleSelectedNumberValidator@1d2a5506) for bet option:1
[2015-05-29 17:13:24,153][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.MultipleSelectedNumberValidator@46340bdf) for bet option:2
[2015-05-29 17:13:24,153][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.SingleSelectedNumberValidator@2f7817b) for bet option:1
[2015-05-29 17:13:24,154][Test worker][ERROR][TEPortServlet] THe multiple count(3) of entry(1,2,3,6,7,13) is either greater than max setting(2) or less than 1
com.mpos.lottery.te.config.exception.ApplicationException: THe multiple count(3) of entry(1,2,3,6,7,13) is either greater than max setting(2) or less than 1
	at com.mpos.lottery.te.gameimpl.lotto.sale.support.LottoTicketValidator.calculateEntryAmount(LottoTicketValidator.java:34)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validate(DefaultTicketValidator.java:47)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.validateTicketRequest(AbstractTicketService.java:386)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:140)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(LottoController.java:32)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.lotto.sale.TicketIntegrationTest.testSell_Single_PlayerSpecifyEntryAmount_ExceedMaxMultipleCount_OK(TicketIntegrationTest.java:312)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:24,155][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804118|Timestamp:20150529171324|Transaction-Type:4200|Transaction-Id:0115052900000000001352|Response-Code:307|):8632235be144e8ae571c3f7f90f75dd3
[2015-05-29 17:13:24,155][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=307,length=0): 
[2015-05-29 17:13:24,165][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:24,165][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:24,165][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@13283317) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:24,165][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:24,166][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:24,166][Test worker][INFO ][BaseTransactionalIntegrationTest] | TicketIntegrationTest.testSell_Multiple_ExceedAllowedMaxDraw_1                                                         |
[2015-05-29 17:13:24,166][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:24,167][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:24,168][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml).
[2015-05-29 17:13:24,168][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804167|Timestamp:20150529171324|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;1600&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=-1133072429), get digest:50ff10cb150fe2760b1d5318c4d8f234
[2015-05-29 17:13:24,168][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:24,168][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:24,169][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171324).
[2015-05-29 17:13:24,169][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:24,169][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890804167).
[2015-05-29 17:13:24,169][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:24,169][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:24,169][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=50ff10cb150fe2760b1d5318c4d8f234).
[2015-05-29 17:13:24,169][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=1).
[2015-05-29 17:13:24,169][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:24,169][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:24,170][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9pDpTDScnIWI62pEFB0SGtKkhmSVtwRhObbaRtENvsKgd1vgEj9cakrUbLVxBSMJqciae7U9vnZ9gkPZ+TiqwdRl/00lYrPXIRF649XUAfZ/u7Ik8R7r7YZCfSM8Dq3Lk3E+I+8dy5FMq1JBSOx+CBYDZ3n4iWwIrRwN3i9ic9EHYxaBXmh5eMdb+eYfmG3rw7BmwCbT+5YlwzT8o+qK8+x+tCRF0yCaqlMPxlqr0c+eFde9h31TBTgqMtIWk2Ux1nb1TPJ2uDK+Ee2oZ5RgoEzb/nuc9f7RCFw4/R0o1FObopbRaJ9qpV2PI6XK6rtTl1lpL4o22ySC7lKR344K/b+MKthKWb3jb.
[2015-05-29 17:13:24,170][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804167|Timestamp:20150529171324|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:24,171][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;1600&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:24,171][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804167|Timestamp:20150529171324|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;1600&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=-1133072429), get digest:50ff10cb150fe2760b1d5318c4d8f234
[2015-05-29 17:13:24,171][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:24,171][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml
[2015-05-29 17:13:24,171][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:24,185][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_1.5.0).
[2015-05-29 17:13:24,185][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_).
[2015-05-29 17:13:24,185][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(1_200_), found controller(com.mpos.lottery.te.gameimpl.lotto.LottoController@388c6589) and method(public void com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:24,192][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lotto.draw.domain.LottoGameInstance) by(number=20090408,gameId=GAME-111, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:24,197][Test worker][DEBUG][AbstractGameInstanceService] Use channel game instance time definition(IGPE-1).
[2015-05-29 17:13:24,197][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745119300008980
[2015-05-29 17:13:24,203][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 1, merchant limit to 3, the smaller 1 will be used.
[2015-05-29 17:13:24,203][Test worker][ERROR][TEPortServlet] THe multiple draw[2] is not in range of allowed multiple-draws[1,1] of game(id=GAME-111)
com.mpos.lottery.te.config.exception.ApplicationException: THe multiple draw[2] is not in range of allowed multiple-draws[1,1] of game(id=GAME-111)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validateMaxAllowedMultipleDraw(DefaultTicketValidator.java:80)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validate(DefaultTicketValidator.java:32)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.validateTicketRequest(AbstractTicketService.java:386)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:140)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(LottoController.java:32)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.lotto.sale.TicketIntegrationTest.testSell_Multiple_ExceedAllowedMaxDraw_1(TicketIntegrationTest.java:510)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:24,205][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804167|Timestamp:20150529171324|Transaction-Type:4200|Transaction-Id:0115052900000000001353|Response-Code:280|):6cb01c06b6c000670bf775444ca67e93
[2015-05-29 17:13:24,205][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=280,length=0): 
[2015-05-29 17:13:24,214][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:24,214][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:24,214][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@66e893a6) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:24,214][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:24,215][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:24,215][Test worker][INFO ][BaseTransactionalIntegrationTest] | TicketIntegrationTest.testSell_Multiple_ExceedAllowedMaxDraw_2                                                         |
[2015-05-29 17:13:24,215][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:24,216][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:24,217][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml).
[2015-05-29 17:13:24,217][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804216|Timestamp:20150529171324|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;1600&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=1512468152), get digest:8fb2bcb3ed24032e60f512415e5346d7
[2015-05-29 17:13:24,217][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:24,217][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:24,217][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171324).
[2015-05-29 17:13:24,218][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:24,218][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890804216).
[2015-05-29 17:13:24,218][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:24,218][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:24,218][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=8fb2bcb3ed24032e60f512415e5346d7).
[2015-05-29 17:13:24,218][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=1).
[2015-05-29 17:13:24,218][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:24,218][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:24,220][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9pDpTDScnIWI62pEFB0SGtKkhmSVtwRhObbaRtENvsKgd1vgEj9cakrUbLVxBSMJqciae7U9vnZ9gkPZ+TiqwdRl/00lYrPXIRF649XUAfZ/u7Ik8R7r7YZCfSM8Dq3Lk3E+I+8dy5FMq1JBSOx+CBYDZ3n4iWwIrRwN3i9ic9EHYxaBXmh5eMdb+eYfmG3rw7BmwCbT+5YlwzT8o+qK8+x+tCRF0yCaqlMPxlqr0c+eFde9h31TBTgqMtIWk2Ux1nb1TPJ2uDK+Ee2oZ5RgoEzb/nuc9f7RCFw4/R0o1FObopbRaJ9qpV2PI6XK6rtTl1lpL4o22ySC7lKR344K/b+MKthKWb3jb.
[2015-05-29 17:13:24,220][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804216|Timestamp:20150529171324|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:24,220][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;1600&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:24,220][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804216|Timestamp:20150529171324|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;1600&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=1512468152), get digest:8fb2bcb3ed24032e60f512415e5346d7
[2015-05-29 17:13:24,221][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:24,221][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml
[2015-05-29 17:13:24,221][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:24,234][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_1.5.0).
[2015-05-29 17:13:24,234][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_).
[2015-05-29 17:13:24,234][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(1_200_), found controller(com.mpos.lottery.te.gameimpl.lotto.LottoController@388c6589) and method(public void com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:24,241][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lotto.draw.domain.LottoGameInstance) by(number=20090408,gameId=GAME-111, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:24,246][Test worker][DEBUG][AbstractGameInstanceService] Use channel game instance time definition(IGPE-1).
[2015-05-29 17:13:24,247][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745119300009089
[2015-05-29 17:13:24,253][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 1, the smaller 1 will be used.
[2015-05-29 17:13:24,253][Test worker][ERROR][TEPortServlet] THe multiple draw[2] is not in range of allowed multiple-draws[1,1] of game(id=GAME-111)
com.mpos.lottery.te.config.exception.ApplicationException: THe multiple draw[2] is not in range of allowed multiple-draws[1,1] of game(id=GAME-111)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validateMaxAllowedMultipleDraw(DefaultTicketValidator.java:80)
	at com.mpos.lottery.te.gamespec.sale.support.validator.DefaultTicketValidator.validate(DefaultTicketValidator.java:32)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.validateTicketRequest(AbstractTicketService.java:386)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:140)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(LottoController.java:32)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.lotto.sale.TicketIntegrationTest.testSell_Multiple_ExceedAllowedMaxDraw_2(TicketIntegrationTest.java:533)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:24,254][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804216|Timestamp:20150529171324|Transaction-Type:4200|Transaction-Id:0115052900000000001354|Response-Code:280|):5085bc14d232de840b89d21376994757
[2015-05-29 17:13:24,254][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=280,length=0): 
[2015-05-29 17:13:24,263][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:24,264][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:24,264][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@41ede8c1) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:24,264][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:24,264][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:24,264][Test worker][INFO ][BaseTransactionalIntegrationTest] | TicketIntegrationTest.testSell_ROLL_OK                                                                                 |
[2015-05-29 17:13:24,264][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:24,265][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:24,265][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml).
[2015-05-29 17:13:24,266][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804265|Timestamp:20150529171324|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;3100&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,4,5&quot; betOption=&quot;4&quot; inputChannel=&quot;0&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=-1573176688), get digest:e78c5b81351ba63df06f2f12368344a5
[2015-05-29 17:13:24,266][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:24,266][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:24,266][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171324).
[2015-05-29 17:13:24,266][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:24,266][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890804265).
[2015-05-29 17:13:24,266][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:24,266][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:24,266][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=e78c5b81351ba63df06f2f12368344a5).
[2015-05-29 17:13:24,266][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=1).
[2015-05-29 17:13:24,266][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:24,266][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:24,268][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfnfSvzUuvi5gIW+x7OzQghYnjCqABYdyJsE3KQamMMqmroQs6UzuEHJSybS0L2O1NDMnhu3zNTHMYDEGtQ7+EKMNs9y0yfdzAGnDTKpSQhN1DVJ3kQEZ+VWY7/C7wl5Bf+6+xbsbSmUkP18QFKPlt+pkdbVRS3TA6TVnY2FCZWpOJPgX8JeT8wfJ0MkbL6FLKaet9iweiDJhBjmDO9ZBv4TZh9YYhqN7oFRN8LCnmZZz2tarxJbYfmJ2.
[2015-05-29 17:13:24,268][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804265|Timestamp:20150529171324|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:24,268][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;3100&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,4,5&quot; betOption=&quot;4&quot; inputChannel=&quot;0&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:24,268][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804265|Timestamp:20150529171324|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;3100&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,4,5&quot; betOption=&quot;4&quot; inputChannel=&quot;0&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=-1573176688), get digest:e78c5b81351ba63df06f2f12368344a5
[2015-05-29 17:13:24,268][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:24,268][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml
[2015-05-29 17:13:24,268][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:24,282][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_1.5.0).
[2015-05-29 17:13:24,282][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_).
[2015-05-29 17:13:24,282][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(1_200_), found controller(com.mpos.lottery.te.gameimpl.lotto.LottoController@388c6589) and method(public void com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:24,290][Test worker][DEBUG][AbstractGameInstanceService] Use channel game instance time definition(IGPE-1).
[2015-05-29 17:13:24,291][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745119300009198
[2015-05-29 17:13:24,297][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:24,297][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.RollSelectedNumberValidator@49d826f0) for bet option:4
[2015-05-29 17:13:24,310][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:24,310][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:24,310][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199996900, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:24,320][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.1]: transaction {
  id: &quot;0115052900000000001355&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890804000
  trans_type: 200
  game_id: &quot;GAME-111&quot;
  game_type: 1
  total_amount: &quot;3100&quot;
}
multi_draw: 1
total_amount: &quot;3100&quot;
serial_no: &quot;aHhDkgTyIu435nz4N2OtvzGFCrOucrBj&quot;
game_instance {
  id: &quot;GII-113&quot;
}
entries {
  selected_number: &quot;1,2,3,4,5&quot;
  bet_option: 4
  total_bets: 31
  entry_amount: &quot;3100&quot;
  input_channel: &quot;0&quot;
}

[2015-05-29 17:13:24,320][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:24,321][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:24,321][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket),mappingFile=xml-mapping/game/lotto/SellTicket_Res.xml
[2015-05-29 17:13:24,321][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:24,321][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Res.xml).
[2015-05-29 17:13:24,322][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804265|Timestamp:20150529171324|Transaction-Type:4200|Transaction-Id:0115052900000000001355|Response-Code:200|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01110745119300009198&quot; type=&quot;1&quot; lastDrawNo=&quot;20090408&quot; barcode=&quot;01cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcpaAg0Y/Qh2mOkCYb+3Q+hY=&quot; validationCode=&quot;664023&quot; multipleDraws=&quot;1&quot; totalBets=&quot;31&quot; totalAmount=&quot;3100&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,4,5&quot; betOption=&quot;4&quot; inputChannel=&quot;0&quot; entryAmount=&quot;3100&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;):868671b1265720842bb599b7475fd0b5
[2015-05-29 17:13:24,322][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=588) succesfully.
[2015-05-29 17:13:24,322][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=588): &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01110745119300009198&quot; type=&quot;1&quot; lastDrawNo=&quot;20090408&quot; barcode=&quot;01cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcpaAg0Y/Qh2mOkCYb+3Q+hY=&quot; validationCode=&quot;664023&quot; multipleDraws=&quot;1&quot; totalBets=&quot;31&quot; totalAmount=&quot;3100&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,4,5&quot; betOption=&quot;4&quot; inputChannel=&quot;0&quot; entryAmount=&quot;3100&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:24,322][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:24,342][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:24,342][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:24,342][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@78d3b4b6) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:24,343][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:24,343][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:24,343][Test worker][INFO ][BaseTransactionalIntegrationTest] | TicketIntegrationTest.testSell_Single_OK                                                                               |
[2015-05-29 17:13:24,343][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:24,346][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:24,347][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml).
[2015-05-29 17:13:24,348][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804346|Timestamp:20150529171324|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;800&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=-1617324858), get digest:f31b7ad134e70f12d7cfca83ead51219
[2015-05-29 17:13:24,348][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:24,348][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:24,348][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171324).
[2015-05-29 17:13:24,348][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:24,348][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890804346).
[2015-05-29 17:13:24,348][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:24,348][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:24,348][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=f31b7ad134e70f12d7cfca83ead51219).
[2015-05-29 17:13:24,348][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=1).
[2015-05-29 17:13:24,348][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:24,348][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:24,350][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfnfSvzUuvi5gIW+x7OzQghYnImZvTQ1xCUUG6+eUQPoWv7dGtkcUmbKplpcI3SAtQHMEUt6rVVkwSEIl8TZT7F/jIcpT2cbgXW95C0Kv7KkyEcgaAgC0orFb0Rm+gat+fBlltfjWeXP/kEzgv773apUE+mmDyJ2vDenVUOkMzAT6kW+a6aWtTsM3/KiTMB9AWrAp8IFC+xQ8mbjLZfLBcbylozVWm4U5LaqQAZxD9ST4pgVDlypEGPVqXlN6yDNK9j+0Hs9xa7Y0guM0pY0fBeI56Ecc5ftP1D4sYVnHfqRkz5tSz06Ye77SVXtN/rxQTSZVzLc+kvsaxvBYpgl4Oiu+RomlL8tert4q4o5n3TKeSXcrwZ4dnFbc.
[2015-05-29 17:13:24,350][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804346|Timestamp:20150529171324|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:24,350][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;800&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:24,351][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804346|Timestamp:20150529171324|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;800&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=-1617324858), get digest:f31b7ad134e70f12d7cfca83ead51219
[2015-05-29 17:13:24,351][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:24,351][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml
[2015-05-29 17:13:24,351][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:24,363][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_1.5.0).
[2015-05-29 17:13:24,363][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_).
[2015-05-29 17:13:24,363][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(1_200_), found controller(com.mpos.lottery.te.gameimpl.lotto.LottoController@388c6589) and method(public void com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:24,371][Test worker][DEBUG][AbstractGameInstanceService] Use channel game instance time definition(IGPE-1).
[2015-05-29 17:13:24,371][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745119300009289
[2015-05-29 17:13:24,377][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:24,377][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.SingleSelectedNumberValidator@1f09e5b3) for bet option:1
[2015-05-29 17:13:24,377][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.MultipleSelectedNumberValidator@42c75ab0) for bet option:2
[2015-05-29 17:13:24,390][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:24,390][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:24,390][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199999200, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:24,400][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.1]: transaction {
  id: &quot;0115052900000000001358&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890804000
  trans_type: 200
  game_id: &quot;GAME-111&quot;
  game_type: 1
  total_amount: &quot;800&quot;
}
multi_draw: 1
total_amount: &quot;800&quot;
serial_no: &quot;aHhDkgTyIu435nz4N2Otvz9ecKdtJ914&quot;
game_instance {
  id: &quot;GII-113&quot;
}
entries {
  selected_number: &quot;1,2,3,6,7,13&quot;
  bet_option: 1
  total_bets: 1
  entry_amount: &quot;100&quot;
  input_channel: &quot;1&quot;
}
entries {
  selected_number: &quot;3,11,14,16,22,25,36&quot;
  bet_option: 2
  total_bets: 7
  entry_amount: &quot;700&quot;
  input_channel: &quot;1&quot;
}

[2015-05-29 17:13:24,400][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:24,400][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:24,400][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket),mappingFile=xml-mapping/game/lotto/SellTicket_Res.xml
[2015-05-29 17:13:24,400][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:24,923][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Res.xml).
[2015-05-29 17:13:24,923][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804346|Timestamp:20150529171324|Transaction-Type:4200|Transaction-Id:0115052900000000001358|Response-Code:200|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01110745119300009289&quot; type=&quot;1&quot; lastDrawNo=&quot;20090408&quot; barcode=&quot;01cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcpaAg0Y/Qh2mTU2qqfyAbmM=&quot; validationCode=&quot;688291&quot; multipleDraws=&quot;1&quot; totalBets=&quot;8&quot; totalAmount=&quot;800&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;100&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;700&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;):382fbcd113cef90b99df125f281429b4
[2015-05-29 17:13:24,923][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=736) succesfully.
[2015-05-29 17:13:24,924][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=736): &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01110745119300009289&quot; type=&quot;1&quot; lastDrawNo=&quot;20090408&quot; barcode=&quot;01cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcpaAg0Y/Qh2mTU2qqfyAbmM=&quot; validationCode=&quot;688291&quot; multipleDraws=&quot;1&quot; totalBets=&quot;8&quot; totalAmount=&quot;800&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;100&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;700&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:24,924][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:24,955][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:24,955][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:24,955][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@309b28a) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:24,955][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:24,956][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:24,956][Test worker][INFO ][BaseTransactionalIntegrationTest] | TicketIntegrationTest.testSell_Single_PlayerSpecifyEntryAmount_OK                                                      |
[2015-05-29 17:13:24,956][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:24,959][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:24,960][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml).
[2015-05-29 17:13:24,960][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804959|Timestamp:20150529171324|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;2500&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;300.0&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;1400.0&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=89316089), get digest:d027fb870a7e34bdad0668d01ce66e03
[2015-05-29 17:13:24,960][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:24,960][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:24,960][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171324).
[2015-05-29 17:13:24,960][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:24,960][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890804959).
[2015-05-29 17:13:24,960][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:24,960][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:24,960][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=d027fb870a7e34bdad0668d01ce66e03).
[2015-05-29 17:13:24,960][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=1).
[2015-05-29 17:13:24,961][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:24,961][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:24,963][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfnfSvzUuvi5gIW+x7OzQghYnehIGuRXV/L97x486X5Du92YX589R0pgxAIgtw+XImFczcJKHYeuMA1knrWpOrda1guQVnCq1srzmluOfvZHgl6swkx4lXR2VnbEAhayTgM4lZQw6YNHr9axztqwW/00NZEXSGRg9uP3eYbU8GJ/AlPRzMH0ajgz8R5i97UhIdsI9sK72Klmyq/rHYPVg/X0usErIL8lOuk4YmIGC0kgavV2nvF+TxnSIF7OdxXsLptE77+8OmwCOMzG3BhAxiZ5Ph+dci/568WjiDknC/rWdTPVZggO21SaMlpZTSUjwqLAKWrrZmESgO5D5sfwDpCPch5QEkLEHClOULrBDFbAtes9PMS6ouY+24+L3TH/bJ7XwiIvs/eRrUguh6plaNm+gPbd/Q2Ycv0UZHBkVc/MUeSrVvjE3ZhmZBF0jeJ23RD/V1oprH8Wx2OP0vs1XPh3QP3iZvZdeK92T5yiBbk5onmgqxdeYTa+/n94Kvy+UWGOKxLrK2wi6BsLakHC2XRzIn2i2NBY0XznfkgE4o7szLAzKR5l8e9VVMeRbj6PbwUaKjKOogUIHvXgAK/NeM2LPeQ36YcXP3G2s2qZnhVQ0202jn/w1HFeqwbD0JEQhaYeojM6c9QaFzzumKvQWEEasbOcxGhL7QwA=.
[2015-05-29 17:13:24,963][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804959|Timestamp:20150529171324|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:24,963][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;2500&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;300.0&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;1400.0&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:24,963][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804959|Timestamp:20150529171324|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;2500&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;300.0&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;1400.0&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=89316089), get digest:d027fb870a7e34bdad0668d01ce66e03
[2015-05-29 17:13:24,964][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:24,964][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml
[2015-05-29 17:13:24,964][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:24,975][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_1.5.0).
[2015-05-29 17:13:24,975][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_).
[2015-05-29 17:13:24,975][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(1_200_), found controller(com.mpos.lottery.te.gameimpl.lotto.LottoController@388c6589) and method(public void com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:24,985][Test worker][DEBUG][AbstractGameInstanceService] Use channel game instance time definition(IGPE-1).
[2015-05-29 17:13:24,985][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745119300009323
[2015-05-29 17:13:24,990][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:24,991][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.SingleSelectedNumberValidator@4d49a2ef) for bet option:1
[2015-05-29 17:13:24,991][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.MultipleSelectedNumberValidator@1d68208d) for bet option:2
[2015-05-29 17:13:24,991][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.SingleSelectedNumberValidator@1f311810) for bet option:1
[2015-05-29 17:13:24,991][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.MultipleSelectedNumberValidator@5022d26f) for bet option:2
[2015-05-29 17:13:25,007][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:25,007][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:25,007][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199997500, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:25,017][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.1]: transaction {
  id: &quot;0115052900000000001362&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890804000
  trans_type: 200
  game_id: &quot;GAME-111&quot;
  game_type: 1
  total_amount: &quot;2500&quot;
}
multi_draw: 1
total_amount: &quot;2500&quot;
serial_no: &quot;aHhDkgTyIu435nz4N2OtvyNU84YGFFKl&quot;
game_instance {
  id: &quot;GII-113&quot;
}
entries {
  selected_number: &quot;1,2,3,6,7,13&quot;
  bet_option: 1
  total_bets: 1
  entry_amount: &quot;100&quot;
  input_channel: &quot;1&quot;
}
entries {
  selected_number: &quot;3,11,14,16,22,25,36&quot;
  bet_option: 2
  total_bets: 7
  entry_amount: &quot;700&quot;
  input_channel: &quot;1&quot;
}
entries {
  selected_number: &quot;1,2,3,6,7,13&quot;
  bet_option: 1
  total_bets: 3
  entry_amount: &quot;300.0&quot;
  input_channel: &quot;1&quot;
}
entries {
  selected_number: &quot;3,11,14,16,22,25,36&quot;
  bet_option: 2
  total_bets: 14
  entry_amount: &quot;1400.0&quot;
  input_channel: &quot;1&quot;
}

[2015-05-29 17:13:25,018][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:25,018][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:25,018][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket),mappingFile=xml-mapping/game/lotto/SellTicket_Res.xml
[2015-05-29 17:13:25,018][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:25,019][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Res.xml).
[2015-05-29 17:13:25,019][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890804959|Timestamp:20150529171324|Transaction-Type:4200|Transaction-Id:0115052900000000001362|Response-Code:200|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01110745119300009323&quot; type=&quot;1&quot; lastDrawNo=&quot;20090408&quot; barcode=&quot;01cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcpaAg0Y/Qh2mZAFDOf10eXI=&quot; validationCode=&quot;985652&quot; multipleDraws=&quot;1&quot; totalBets=&quot;25&quot; totalAmount=&quot;2500&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;100&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;700&quot; boostAmount=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;300.0&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;1400.0&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;):ad7d13c8cadeea4a76e024347ad78e56
[2015-05-29 17:13:25,019][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=1024) succesfully.
[2015-05-29 17:13:25,020][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=1024): &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01110745119300009323&quot; type=&quot;1&quot; lastDrawNo=&quot;20090408&quot; barcode=&quot;01cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcpaAg0Y/Qh2mZAFDOf10eXI=&quot; validationCode=&quot;985652&quot; multipleDraws=&quot;1&quot; totalBets=&quot;25&quot; totalAmount=&quot;2500&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;100&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;700&quot; boostAmount=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;300.0&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;1400.0&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:25,020][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:25,040][Test worker][DEBUG][TicketIntegrationTest] entry.multipleCount=1
[2015-05-29 17:13:25,040][Test worker][DEBUG][TicketIntegrationTest] entry.multipleCount=1
[2015-05-29 17:13:25,040][Test worker][DEBUG][TicketIntegrationTest] entry.multipleCount=3
[2015-05-29 17:13:25,040][Test worker][DEBUG][TicketIntegrationTest] entry.multipleCount=0
[2015-05-29 17:13:25,040][Test worker][DEBUG][TicketIntegrationTest] entry.multipleCount=0
[2015-05-29 17:13:25,040][Test worker][DEBUG][TicketIntegrationTest] entry.multipleCount=2
[2015-05-29 17:13:25,040][Test worker][DEBUG][TicketIntegrationTest] entry.multipleCount=0
[2015-05-29 17:13:25,049][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:25,049][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:25,049][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@448077a9) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:25,050][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:25,050][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:25,050][Test worker][INFO ][BaseTransactionalIntegrationTest] | TicketIntegrationTest.testSell_NoSaleAllowed                                                                           |
[2015-05-29 17:13:25,050][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:25,052][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:25,053][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml).
[2015-05-29 17:13:25,053][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890805052|Timestamp:20150529171325|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;1600&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=1880976364), get digest:14a152040a0496dd904cd576c2745a6f
[2015-05-29 17:13:25,053][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:25,054][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:25,054][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171325).
[2015-05-29 17:13:25,054][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:25,054][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890805052).
[2015-05-29 17:13:25,054][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:25,054][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:25,054][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=14a152040a0496dd904cd576c2745a6f).
[2015-05-29 17:13:25,054][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=1).
[2015-05-29 17:13:25,054][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:25,054][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:25,055][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9pDpTDScnIWI62pEFB0SGtKkhmSVtwRhObbaRtENvsKgd1vgEj9cakrUbLVxBSMJqciae7U9vnZ9gkPZ+TiqwdRl/00lYrPXIRF649XUAfZ/u7Ik8R7r7YZCfSM8Dq3Lk3E+I+8dy5FMq1JBSOx+CBYDZ3n4iWwIrRwN3i9ic9EHYxaBXmh5eMdb+eYfmG3rw7BmwCbT+5YlwzT8o+qK8+x+tCRF0yCaqlMPxlqr0c+eFde9h31TBTgqMtIWk2Ux1nb1TPJ2uDK+Ee2oZ5RgoEzb/nuc9f7RCFw4/R0o1FObopbRaJ9qpV2PI6XK6rtTl1lpL4o22ySC7lKR344K/b+MKthKWb3jb.
[2015-05-29 17:13:25,056][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890805052|Timestamp:20150529171325|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:25,056][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;1600&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:25,056][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890805052|Timestamp:20150529171325|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;1600&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=1880976364), get digest:14a152040a0496dd904cd576c2745a6f
[2015-05-29 17:13:25,056][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:25,056][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml
[2015-05-29 17:13:25,056][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:25,069][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_1.5.0).
[2015-05-29 17:13:25,069][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_).
[2015-05-29 17:13:25,070][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(1_200_), found controller(com.mpos.lottery.te.gameimpl.lotto.LottoController@388c6589) and method(public void com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:25,076][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lotto.draw.domain.LottoGameInstance) by(number=20090408,gameId=GAME-111, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:25,083][Test worker][DEBUG][AbstractGameInstanceService] Use channel game instance time definition(IGPE-1).
[2015-05-29 17:13:25,083][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745119300009484
[2015-05-29 17:13:25,089][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:25,089][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.SingleSelectedNumberValidator@5537d70f) for bet option:1
[2015-05-29 17:13:25,089][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.MultipleSelectedNumberValidator@4508457e) for bet option:2
[2015-05-29 17:13:25,091][Test worker][ERROR][TEPortServlet] operator(id=OPERATOR-111) has no priviledge to sell ticket of game 'GAME-111', allocate the game to its merchant first.
com.mpos.lottery.te.config.exception.SystemException: operator(id=OPERATOR-111) has no priviledge to sell ticket of game 'GAME-111', allocate the game to its merchant first.
	at com.mpos.lottery.te.merchant.service.impl.MerchantServiceImpl.allowSale(MerchantServiceImpl.java:78)
	at sun.reflect.GeneratedMethodAccessor172.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy53.allowSale(Unknown Source)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:142)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(LottoController.java:32)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.lotto.sale.TicketIntegrationTest.testSell_NoSaleAllowed(TicketIntegrationTest.java:617)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:25,093][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890805052|Timestamp:20150529171325|Transaction-Type:4200|Transaction-Id:0115052900000000001371|Response-Code:225|):10be6c548b957610ea66501da0300828
[2015-05-29 17:13:25,093][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=225,length=0): 
[2015-05-29 17:13:25,103][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:25,103][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:25,103][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@3bd1046c) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:25,104][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:25,104][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:25,104][Test worker][INFO ][BaseTransactionalIntegrationTest] | TicketIntegrationTest.testSell_Single_NoValidationCode_OK                                                              |
[2015-05-29 17:13:25,104][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:25,105][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:25,106][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml).
[2015-05-29 17:13:25,107][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890805105|Timestamp:20150529171325|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;1600&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=1450487253), get digest:031420133a2bc7477ff94700da14edbf
[2015-05-29 17:13:25,107][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:25,107][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:25,107][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171325).
[2015-05-29 17:13:25,107][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:25,107][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890805105).
[2015-05-29 17:13:25,107][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:25,107][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:25,108][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=031420133a2bc7477ff94700da14edbf).
[2015-05-29 17:13:25,108][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=1).
[2015-05-29 17:13:25,108][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:25,108][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:25,109][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9pDpTDScnIWI62pEFB0SGtKkhmSVtwRhObbaRtENvsKgd1vgEj9cakrUbLVxBSMJqciae7U9vnZ9gkPZ+TiqwdRl/00lYrPXIRF649XUAfZ/u7Ik8R7r7YZCfSM8Dq3Lk3E+I+8dy5FMq1JBSOx+CBYDZ3n4iWwIrRwN3i9ic9EHYxaBXmh5eMdb+eYfmG3rw7BmwCbT+5YlwzT8o+qK8+x+tCRF0yCaqlMPxlqr0c+eFde9h31TBTgqMtIWk2Ux1nb1TPJ2uDK+Ee2oZ5RgoEzb/nuc9f7RCFw4/R0o1FObopbRaJ9qpV2PI6XK6rtTl1lpL4o22ySC7lKR344K/b+MKthKWb3jb.
[2015-05-29 17:13:25,109][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890805105|Timestamp:20150529171325|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:25,110][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;1600&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:25,110][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890805105|Timestamp:20150529171325|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;1600&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=1450487253), get digest:031420133a2bc7477ff94700da14edbf
[2015-05-29 17:13:25,110][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:25,110][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml
[2015-05-29 17:13:25,110][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:25,124][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_1.5.0).
[2015-05-29 17:13:25,124][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_).
[2015-05-29 17:13:25,124][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(1_200_), found controller(com.mpos.lottery.te.gameimpl.lotto.LottoController@388c6589) and method(public void com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:25,131][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lotto.draw.domain.LottoGameInstance) by(number=20090408,gameId=GAME-111, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:25,136][Test worker][DEBUG][AbstractGameInstanceService] Use channel game instance time definition(IGPE-1).
[2015-05-29 17:13:25,136][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745119300009563
[2015-05-29 17:13:25,142][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:25,142][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.SingleSelectedNumberValidator@650441dd) for bet option:1
[2015-05-29 17:13:25,143][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.MultipleSelectedNumberValidator@7a8047fa) for bet option:2
[2015-05-29 17:13:25,156][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:25,156][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:25,156][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199998400, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:25,166][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.1]: transaction {
  id: &quot;0115052900000000001372&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890805000
  trans_type: 200
  game_id: &quot;GAME-111&quot;
  game_type: 1
  total_amount: &quot;1600&quot;
}
multi_draw: 2
total_amount: &quot;1600&quot;
serial_no: &quot;aHhDkgTyIu435nz4N2OtvyYxw3L1aicU&quot;
game_instance {
  id: &quot;GII-113&quot;
}
entries {
  selected_number: &quot;1,2,3,6,7,13&quot;
  bet_option: 1
  total_bets: 1
  entry_amount: &quot;100&quot;
  input_channel: &quot;1&quot;
}
entries {
  selected_number: &quot;3,11,14,16,22,25,36&quot;
  bet_option: 2
  total_bets: 7
  entry_amount: &quot;700&quot;
  input_channel: &quot;1&quot;
}

[2015-05-29 17:13:25,166][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:25,166][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:25,166][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket),mappingFile=xml-mapping/game/lotto/SellTicket_Res.xml
[2015-05-29 17:13:25,166][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:25,167][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Res.xml).
[2015-05-29 17:13:25,167][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890805105|Timestamp:20150529171325|Transaction-Type:4200|Transaction-Id:0115052900000000001372|Response-Code:200|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01110745119300009563&quot; type=&quot;1&quot; lastDrawNo=&quot;20090416&quot; barcode=&quot;01cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcpaAg0Y/Qh2mKSMWf78b5RE=&quot; validationCode=&quot;FFFFFF&quot; multipleDraws=&quot;2&quot; totalBets=&quot;16&quot; totalAmount=&quot;1600&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;100&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;700&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;):638c13ae865483b89bf78a41ecf50f8d
[2015-05-29 17:13:25,167][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=736) succesfully.
[2015-05-29 17:13:25,168][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=736): &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01110745119300009563&quot; type=&quot;1&quot; lastDrawNo=&quot;20090416&quot; barcode=&quot;01cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcpaAg0Y/Qh2mKSMWf78b5RE=&quot; validationCode=&quot;FFFFFF&quot; multipleDraws=&quot;2&quot; totalBets=&quot;16&quot; totalAmount=&quot;1600&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;100&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;700&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:25,168][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:25,179][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:25,180][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:25,180][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@26532d35) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:25,180][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:25,180][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:25,180][Test worker][INFO ][BaseTransactionalIntegrationTest] | TicketIntegrationTest.testSell_MultiDraw_OK                                                                            |
[2015-05-29 17:13:25,180][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:25,183][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:25,184][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml).
[2015-05-29 17:13:25,184][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890805183|Timestamp:20150529171325|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;1600&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=-894261429), get digest:1c603a561113f2a7030579dc8edea771
[2015-05-29 17:13:25,185][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:25,185][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:25,185][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171325).
[2015-05-29 17:13:25,185][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:25,185][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890805183).
[2015-05-29 17:13:25,185][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:25,185][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:25,185][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=1c603a561113f2a7030579dc8edea771).
[2015-05-29 17:13:25,185][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=1).
[2015-05-29 17:13:25,185][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:25,185][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:25,186][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9pDpTDScnIWI62pEFB0SGtKkhmSVtwRhObbaRtENvsKgd1vgEj9cakrUbLVxBSMJqciae7U9vnZ9gkPZ+TiqwdRl/00lYrPXIRF649XUAfZ/u7Ik8R7r7YZCfSM8Dq3Lk3E+I+8dy5FMq1JBSOx+CBYDZ3n4iWwIrRwN3i9ic9EHYxaBXmh5eMdb+eYfmG3rw7BmwCbT+5YlwzT8o+qK8+x+tCRF0yCaqlMPxlqr0c+eFde9h31TBTgqMtIWk2Ux1nb1TPJ2uDK+Ee2oZ5RgoEzb/nuc9f7RCFw4/R0o1FObopbRaJ9qpV2PI6XK6rtTl1lpL4o22ySC7lKR344K/b+MKthKWb3jb.
[2015-05-29 17:13:25,187][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890805183|Timestamp:20150529171325|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:25,187][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;1600&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:25,187][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890805183|Timestamp:20150529171325|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;1600&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=-894261429), get digest:1c603a561113f2a7030579dc8edea771
[2015-05-29 17:13:25,187][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:25,187][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml
[2015-05-29 17:13:25,187][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:25,198][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_1.5.0).
[2015-05-29 17:13:25,198][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_).
[2015-05-29 17:13:25,198][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(1_200_), found controller(com.mpos.lottery.te.gameimpl.lotto.LottoController@388c6589) and method(public void com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:25,206][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lotto.draw.domain.LottoGameInstance) by(number=20090408,gameId=GAME-111, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:25,210][Test worker][DEBUG][AbstractGameInstanceService] Use channel game instance time definition(IGPE-1).
[2015-05-29 17:13:25,211][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745119300009621
[2015-05-29 17:13:25,216][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:25,216][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.SingleSelectedNumberValidator@30a25857) for bet option:1
[2015-05-29 17:13:25,216][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.MultipleSelectedNumberValidator@7255d0b2) for bet option:2
[2015-05-29 17:13:25,230][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:25,230][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:25,230][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199998400, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:25,239][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.1]: transaction {
  id: &quot;0115052900000000001377&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890805000
  trans_type: 200
  game_id: &quot;GAME-111&quot;
  game_type: 1
  total_amount: &quot;1600&quot;
}
multi_draw: 2
total_amount: &quot;1600&quot;
serial_no: &quot;aHhDkgTyIu435nz4N2OtvyUJiiTBOzhk&quot;
game_instance {
  id: &quot;GII-113&quot;
}
entries {
  selected_number: &quot;1,2,3,6,7,13&quot;
  bet_option: 1
  total_bets: 1
  entry_amount: &quot;100&quot;
  input_channel: &quot;1&quot;
}
entries {
  selected_number: &quot;3,11,14,16,22,25,36&quot;
  bet_option: 2
  total_bets: 7
  entry_amount: &quot;700&quot;
  input_channel: &quot;1&quot;
}

[2015-05-29 17:13:25,240][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:25,240][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:25,240][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket),mappingFile=xml-mapping/game/lotto/SellTicket_Res.xml
[2015-05-29 17:13:25,240][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:25,241][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Res.xml).
[2015-05-29 17:13:25,241][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890805183|Timestamp:20150529171325|Transaction-Type:4200|Transaction-Id:0115052900000000001377|Response-Code:200|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01110745119300009621&quot; type=&quot;1&quot; lastDrawNo=&quot;20090416&quot; barcode=&quot;01cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcpaAg0Y/Qh2mc2IV+b81INQ=&quot; validationCode=&quot;568125&quot; multipleDraws=&quot;2&quot; totalBets=&quot;16&quot; totalAmount=&quot;1600&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;100&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;700&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;):a6f630493016222d0e6dc12d63978681
[2015-05-29 17:13:25,242][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=736) succesfully.
[2015-05-29 17:13:25,243][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=736): &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01110745119300009621&quot; type=&quot;1&quot; lastDrawNo=&quot;20090416&quot; barcode=&quot;01cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcpaAg0Y/Qh2mc2IV+b81INQ=&quot; validationCode=&quot;568125&quot; multipleDraws=&quot;2&quot; totalBets=&quot;16&quot; totalAmount=&quot;1600&quot;&gt;&lt;GameDraw number=&quot;20090408&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;100&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;700&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:25,243][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:25,274][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:25,275][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:25,275][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@3acb31d8) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:25,275][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:25,275][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:25,275][Test worker][INFO ][BaseTransactionalIntegrationTest] | TicketIntegrationTest.testSell_Single_SaleOnNewGameInstance_Fail                                                       |
[2015-05-29 17:13:25,275][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:25,277][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:25,278][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml).
[2015-05-29 17:13:25,278][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890805277|Timestamp:20150529171325|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;800&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090416&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=580574414), get digest:a462080075d018f3cad8abce69131900
[2015-05-29 17:13:25,278][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:25,278][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:25,278][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171325).
[2015-05-29 17:13:25,278][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:25,278][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890805277).
[2015-05-29 17:13:25,278][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:25,278][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:25,278][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=a462080075d018f3cad8abce69131900).
[2015-05-29 17:13:25,278][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=1).
[2015-05-29 17:13:25,279][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:25,279][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:25,280][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfnfSvzUuvi5gIW+x7OzQghYnImZvTQ1xCUUG6+eUQPoWv7dGtkcUmbKplpcI3SAtQHMEUt6rVVkwSEIl8TZT7F/jiYIaXamlV6UBBEDVKxW+hPc+bUwmA7A70NEv0ZzMRiKHg82ny6QjArOL9rHIxlXqc0FC7ZuOaqrG3PYHkJ/O7htXvvan/VwPI5rkwkX1y2659gMT4V9KlklgDO678FKn4hrieK8lVsPyBlyX0PZMAv/Bvuc/uAxOicDTqkljsF5hUq6Uq2O/IRT9CRMbC3lgSedfHeA6hYcgSAtAEi6e0zbEMsSposgFe0K4CYzoR3z7des7ShndWKAqrq5ZEnTIAkVsTXkcuQ7wOhmHiTjh2+N2cWYBX2Qx.
[2015-05-29 17:13:25,281][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890805277|Timestamp:20150529171325|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:25,281][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;800&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090416&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:25,281][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890805277|Timestamp:20150529171325|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;1&quot; totalAmount=&quot;800&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090416&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=580574414), get digest:a462080075d018f3cad8abce69131900
[2015-05-29 17:13:25,281][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:25,281][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml
[2015-05-29 17:13:25,281][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:25,294][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_1.5.0).
[2015-05-29 17:13:25,294][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_).
[2015-05-29 17:13:25,294][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(1_200_), found controller(com.mpos.lottery.te.gameimpl.lotto.LottoController@388c6589) and method(public void com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:25,303][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:25,303][Test worker][ERROR][AbstractGameInstanceService] The game instance(number=20090416,game.type=1,status=1,startSellintTime=2015-05-30 17:12:14.0,stopSellTime=2015-06-01 17:12:14.0,suspendSale=false) doesn't accept sale.
[2015-05-29 17:13:25,303][Test worker][ERROR][TEPortServlet] Game instance(id=GII-114) isn't active.
com.mpos.lottery.te.config.exception.ApplicationException: Game instance(id=GII-114) isn't active.
	at com.mpos.lottery.te.gamespec.game.service.impl.AbstractGameInstanceService.allowSale(AbstractGameInstanceService.java:234)
	at com.mpos.lottery.te.gamespec.game.service.impl.AbstractGameInstanceService.doEnquiryMultiDraw(AbstractGameInstanceService.java:182)
	at com.mpos.lottery.te.gamespec.game.service.impl.AbstractGameInstanceService.enquirySaleReady(AbstractGameInstanceService.java:98)
	at sun.reflect.GeneratedMethodAccessor131.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy54.enquirySaleReady(Unknown Source)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.lookupSaleReadyGameInstance(AbstractTicketService.java:348)
	at com.mpos.lottery.te.gamespec.sale.service.AbstractTicketService.sell(AbstractTicketService.java:123)
	at sun.reflect.GeneratedMethodAccessor130.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy58.sell(Unknown Source)
	at com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(LottoController.java:32)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.lotto.sale.TicketIntegrationTest.testSell_Single_SaleOnNewGameInstance_Fail(TicketIntegrationTest.java:637)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:25,305][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890805277|Timestamp:20150529171325|Transaction-Type:4200|Transaction-Id:0115052900000000001382|Response-Code:304|):db70644d27f7c0368c977e1b4479dc7f
[2015-05-29 17:13:25,305][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=304,length=0): 
[2015-05-29 17:13:25,314][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:25,314][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:25,314][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@4d7f4bab) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:25,314][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:25,315][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:25,315][Test worker][INFO ][BaseTransactionalIntegrationTest] | TicketIntegrationTest.testSell_MultiDraw_SaleOnNewGameInstanceOK                                                       |
[2015-05-29 17:13:25,315][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:25,319][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:25,319][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml).
[2015-05-29 17:13:25,320][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890805319|Timestamp:20150529171325|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;1600&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090416&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=-1340758339), get digest:61318c01d0b726e0f2befc946993af6e
[2015-05-29 17:13:25,320][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:25,320][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:25,320][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171325).
[2015-05-29 17:13:25,320][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:25,320][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890805319).
[2015-05-29 17:13:25,320][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:25,320][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:25,320][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=61318c01d0b726e0f2befc946993af6e).
[2015-05-29 17:13:25,320][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=1).
[2015-05-29 17:13:25,320][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:25,320][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:25,322][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9pDpTDScnIWI62pEFB0SGtKkhmSVtwRhObbaRtENvsKgd1vgEj9cakrUbLVxBSMJqSXrGhKWSS2rzpewm3MCmYvRoVU9H2JhSQybFBuez8AgQLj4IeMfpW71E1PtzW8IYUPW6Izn0qe/h9+5a9lF6DwWd4ydEqtsS/LodxYdn10Ak4yiplePAnMqMpbcU+A/NZN1jQrWNTmkdbt/dr2iYyleeD64QR41sI750M+SblrbUKTDMFtvB3G5/vhhiSGbsgE/qwxubXA4mpj21tD33s7XKhgsURLFsVaFEa8pvljxl24VWUjjHtlo6zlYgiNuKDGFdiBRvaYgzgxY70C1FokYcidT84BrC.
[2015-05-29 17:13:25,322][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890805319|Timestamp:20150529171325|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:25,322][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;1600&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090416&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:25,323][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890805319|Timestamp:20150529171325|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;1600&quot; PIN=&quot;123456&quot;&gt;&lt;GameDraw number=&quot;20090416&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=-1340758339), get digest:61318c01d0b726e0f2befc946993af6e
[2015-05-29 17:13:25,323][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:25,323][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lotto/SellTicket_Req.xml
[2015-05-29 17:13:25,323][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Req.xml) by key(1.transtype.200).
[2015-05-29 17:13:25,334][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_1.5.0).
[2015-05-29 17:13:25,334][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(1_200_).
[2015-05-29 17:13:25,334][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(1_200_), found controller(com.mpos.lottery.te.gameimpl.lotto.LottoController@388c6589) and method(public void com.mpos.lottery.te.gameimpl.lotto.LottoController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:25,341][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lotto.draw.domain.LottoGameInstance) by(number=20090416,gameId=GAME-111, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:25,345][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01110745119300009761
[2015-05-29 17:13:25,350][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:25,351][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.SingleSelectedNumberValidator@5ac45a8b) for bet option:1
[2015-05-29 17:13:25,351][Test worker][DEBUG][DefaultSelectedNumberValidatorFactory] Found ticket validator(com.mpos.lottery.te.gamespec.sale.support.validator.MultipleSelectedNumberValidator@11148a3b) for bet option:2
[2015-05-29 17:13:25,364][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:25,364][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:25,364][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199998400, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:25,374][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.1]: transaction {
  id: &quot;0115052900000000001383&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890805000
  trans_type: 200
  game_id: &quot;GAME-111&quot;
  game_type: 1
  total_amount: &quot;1600&quot;
}
multi_draw: 2
total_amount: &quot;1600&quot;
serial_no: &quot;aHhDkgTyIu435nz4N2Otv2y0vC2ZsGI8&quot;
game_instance {
  id: &quot;GII-114&quot;
}
entries {
  selected_number: &quot;1,2,3,6,7,13&quot;
  bet_option: 1
  total_bets: 1
  entry_amount: &quot;100&quot;
  input_channel: &quot;1&quot;
}
entries {
  selected_number: &quot;3,11,14,16,22,25,36&quot;
  bet_option: 2
  total_bets: 7
  entry_amount: &quot;700&quot;
  input_channel: &quot;1&quot;
}

[2015-05-29 17:13:25,374][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:25,374][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:25,374][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket),mappingFile=xml-mapping/game/lotto/SellTicket_Res.xml
[2015-05-29 17:13:25,374][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
[2015-05-29 17:13:25,375][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lotto.sale.domain.LottoTicket, mappingFile=xml-mapping/game/lotto/SellTicket_Res.xml).
[2015-05-29 17:13:25,375][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890805319|Timestamp:20150529171325|Transaction-Type:4200|Transaction-Id:0115052900000000001383|Response-Code:200|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01110745119300009761&quot; type=&quot;1&quot; lastDrawNo=&quot;20090508&quot; barcode=&quot;01cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcpaAg0Y/Qh2mhy/C/L5viCQ=&quot; validationCode=&quot;389004&quot; multipleDraws=&quot;2&quot; totalBets=&quot;16&quot; totalAmount=&quot;1600&quot;&gt;&lt;GameDraw number=&quot;20090416&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;100&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;700&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;):e9d892e78e19ad9c2b1f861079762f67
[2015-05-29 17:13:25,376][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=736) succesfully.
[2015-05-29 17:13:25,376][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=736): &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01110745119300009761&quot; type=&quot;1&quot; lastDrawNo=&quot;20090508&quot; barcode=&quot;01cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt8eRiXxElYKcpaAg0Y/Qh2mhy/C/L5viCQ=&quot; validationCode=&quot;389004&quot; multipleDraws=&quot;2&quot; totalBets=&quot;16&quot; totalAmount=&quot;1600&quot;&gt;&lt;GameDraw number=&quot;20090416&quot; gameId=&quot;GAME-111&quot;/&gt;&lt;Entry selectedNumber=&quot;1,2,3,6,7,13&quot; betOption=&quot;1&quot; inputChannel=&quot;1&quot; entryAmount=&quot;100&quot; boostAmount=&quot;100&quot;/&gt;&lt;Entry selectedNumber=&quot;3,11,14,16,22,25,36&quot; betOption=&quot;2&quot; inputChannel=&quot;1&quot; entryAmount=&quot;700&quot; boostAmount=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:25,376][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lotto/SellTicket_Res.xml) by key(1.transtype.4200).
</pre>
</span>
</div>
</div>
<div id="footer">
<p>Generated by 
<a href="http://www.gradle.org">Gradle 2.2.1</a> at 2015-5-29 17:14:47</p>
</div>
</div>
</body>
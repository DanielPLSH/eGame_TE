<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=edge"/>
<title>Test results - Class com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleCancellationIntegrationTest</title>
<link href="../css/base-style.css" rel="stylesheet" type="text/css"/>
<link href="../css/style.css" rel="stylesheet" type="text/css"/>
<script src="../js/report.js" type="text/javascript"></script>
</head>
<body>
<div id="content">
<h1>Class com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleCancellationIntegrationTest</h1>
<div class="breadcrumbs">
<a href="../index.html">all</a> &gt; 
<a href="../packages/com.mpos.lottery.te.gameimpl.lfn.sale.html">com.mpos.lottery.te.gameimpl.lfn.sale</a> &gt; LfnSaleCancellationIntegrationTest</div>
<div id="summary">
<table>
<tr>
<td>
<div class="summaryGroup">
<table>
<tr>
<td>
<div class="infoBox" id="tests">
<div class="counter">6</div>
<p>tests</p>
</div>
</td>
<td>
<div class="infoBox" id="failures">
<div class="counter">0</div>
<p>failures</p>
</div>
</td>
<td>
<div class="infoBox" id="ignored">
<div class="counter">0</div>
<p>ignored</p>
</div>
</td>
<td>
<div class="infoBox" id="duration">
<div class="counter">4.086s</div>
<p>duration</p>
</div>
</td>
</tr>
</table>
</div>
</td>
<td>
<div class="infoBox success" id="successRate">
<div class="percent">100%</div>
<p>successful</p>
</div>
</td>
</tr>
</table>
</div>
<div id="tabs">
<ul class="tabLinks">
<li>
<a href="#tab0">Tests</a>
</li>
<li>
<a href="#tab1">Standard output</a>
</li>
</ul>
<div id="tab0" class="tab">
<h2>Tests</h2>
<table>
<thead>
<tr>
<th>Test</th>
<th>Duration</th>
<th>Result</th>
</tr>
</thead>
<tr>
<td class="success">testCancelByTicket_Manually_OK</td>
<td>0.522s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testCancelByTicket_OK</td>
<td>0.688s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testCancelByTicket_Repeatedly</td>
<td>0.854s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testCancelByTransaction_OK</td>
<td>0.684s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testCancel_DefiniteCredit_VerifyBalanceLog_OK</td>
<td>0.653s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testCancel_UseParentCredit_VerifyBalanceLog_OK</td>
<td>0.685s</td>
<td class="success">passed</td>
</tr>
</table>
</div>
<div id="tab1" class="tab">
<h2>Standard output</h2>
<span class="code">
<pre>[2015-05-29 17:13:14,067][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:14,068][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:14,068][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@6f255853) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:14,068][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:14,069][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:14,069][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnSaleCancellationIntegrationTest.testCancelByTicket_Repeatedly                                                       |
[2015-05-29 17:13:14,069][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:14,073][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:14,092][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:14,093][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890794073|Timestamp:20150529171314|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;2600.0&quot; PIN=&quot;!!!!&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=1938681014), get digest:321a6fb5c655ce6223bf73a6b3caa721
[2015-05-29 17:13:14,093][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:14,093][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:14,093][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171314).
[2015-05-29 17:13:14,093][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:14,093][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890794073).
[2015-05-29 17:13:14,093][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:14,093][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:14,093][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=321a6fb5c655ce6223bf73a6b3caa721).
[2015-05-29 17:13:14,093][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:14,093][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:14,093][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:14,095][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9L2k05jXFbPjS1FsBBTLuWj4a8kJVsM72/YMzruGEM7DWPI5uQU+kvE7y74H12t4zbaRoUQTDb7n/h8zAxrh6Hn2mtyfU/CYtxKe3z/Py5RlIQZDC6AG8TrAvhb3G3SNDjlu4Vxm32uHjs7iClqnt2hDh9rhQSOHhB9K5LUL3NVo8dKwh6SCwM56BaXiK557zz5HaYz2004U1raT6OlReAP7pgHuknsbfxdYkwSI2v0wkzsQ/uHRPv01BVY1tFvgu1/1csAMYBq+O2tRLIhXeAoIJOVLJJPvPHAkozf5FsxcYBza1aivogG1+z8aPrO9uA0h0ScFgQ8LmCP5AX0mf6ruPkYWDcmUtW5ansd9eHP+N72iCfLshuhdBbTWGleRy.
[2015-05-29 17:13:14,095][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890794073|Timestamp:20150529171314|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:14,096][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;2600.0&quot; PIN=&quot;!!!!&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:14,096][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890794073|Timestamp:20150529171314|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;2600.0&quot; PIN=&quot;!!!!&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=1938681014), get digest:321a6fb5c655ce6223bf73a6b3caa721
[2015-05-29 17:13:14,096][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:14,096][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:14,096][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:14,111][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_1.5.0).
[2015-05-29 17:13:14,111][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_).
[2015-05-29 17:13:14,111][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_200_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:14,149][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance) by(number=11002,gameId=LFN-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:14,158][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:14,158][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01111745519300005797
[2015-05-29 17:13:14,167][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:14,170][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMmnPkVcB+A4s) as 80000
[2015-05-29 17:13:14,176][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMmnPkVcB+A4s, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:14,176][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:14,176][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:14,189][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMmnPkVcB+A4s) as 80000
[2015-05-29 17:13:14,192][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMmnPkVcB+A4s, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:14,192][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:14,192][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:14,204][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:14,204][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:14,213][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:14,213][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:14,224][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:14,224][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:14,234][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:14,234][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:14,241][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:14,241][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:14,251][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:14,251][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:14,260][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:14,260][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:14,270][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:14,270][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:14,279][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:14,279][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:14,287][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:14,287][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:14,294][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:14,294][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:14,302][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:14,302][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:14,309][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:14,309][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:14,316][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:14,316][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:14,323][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:14,323][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:14,329][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:14,329][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:14,337][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:14,337][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:14,344][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:14,344][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:14,353][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:14,353][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:14,360][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMmnPkVcB+A4s) as 80000
[2015-05-29 17:13:14,362][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMmnPkVcB+A4s, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:14,362][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:14,362][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:14,370][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMmnPkVcB+A4s) as 80000
[2015-05-29 17:13:14,376][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMmnPkVcB+A4s, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:14,376][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:14,376][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:14,387][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:14,387][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:14,394][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:14,394][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:14,403][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:14,403][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:14,410][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:14,410][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:14,420][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:14,420][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:14,430][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:14,430][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:14,451][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:14,451][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:14,466][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:14,466][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:14,480][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:14,480][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:14,494][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:14,494][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:14,503][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:14,503][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:14,516][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:14,516][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:14,529][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:14,529][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:14,539][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:14,539][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:14,547][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:14,548][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:14,556][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:14,556][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:14,567][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:14,568][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:14,576][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:14,576][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:14,590][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:14,590][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:14,620][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:14,620][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:14,620][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199997400.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:14,639][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.15]: transaction {
  id: &quot;0115052900000000000558&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890794000
  trans_type: 200
  game_id: &quot;LFN-1&quot;
  game_type: 15
  total_amount: &quot;2600.0&quot;
}
multi_draw: 2
total_amount: &quot;2600.0&quot;
serial_no: &quot;y013eOifYgLRjcmw7N8vMmnPkVcB+A4s&quot;
game_instance {
  id: &quot;GII-112&quot;
}
entries {
  selected_number: &quot;2,7,13,24,25,36&quot;
  bet_option: 53
  total_bets: 20
  entry_amount: &quot;1200.0&quot;
  input_channel: &quot;2&quot;
}
entries {
  selected_number: &quot;5&quot;
  bet_option: 1
  total_bets: 1
  entry_amount: &quot;100.0&quot;
  input_channel: &quot;2&quot;
}

[2015-05-29 17:13:14,640][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:14,640][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:14,640][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket),mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml
[2015-05-29 17:13:14,640][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:14,661][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml).
[2015-05-29 17:13:14,662][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890794073|Timestamp:20150529171314|Transaction-Type:4200|Transaction-Id:0115052900000000000558|Response-Code:200|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300005797&quot; type=&quot;1&quot; lastDrawNo=&quot;11003&quot; barcode=&quot;15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqzwBhIMM2mB0=&quot; validationCode=&quot;940069&quot; multipleDraws=&quot;2&quot; totalBets=&quot;42&quot; totalAmount=&quot;2600.0&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot;/&gt;&lt;/Ticket&gt;):cae9f45c71c2a62067bd8c65da956a08
[2015-05-29 17:13:14,662][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=672) succesfully.
[2015-05-29 17:13:14,663][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=672): &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300005797&quot; type=&quot;1&quot; lastDrawNo=&quot;11003&quot; barcode=&quot;15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqzwBhIMM2mB0=&quot; validationCode=&quot;940069&quot; multipleDraws=&quot;2&quot; totalBets=&quot;42&quot; totalAmount=&quot;2600.0&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:14,663][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:14,673][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.201).
[2015-05-29 17:13:14,686][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/CancelTicket_Req.xml).
[2015-05-29 17:13:14,687][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890794673|Timestamp:20150529171314|Transaction-Type:201|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300005797&quot; isMannul=&quot;0&quot;/&gt;,hash=1860535710), get digest:fac12623415bd184e7b747cd0e26aa59
[2015-05-29 17:13:14,687][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=201).
[2015-05-29 17:13:14,687][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:14,687][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171314).
[2015-05-29 17:13:14,687][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:14,687][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890794673).
[2015-05-29 17:13:14,687][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:14,687][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:14,687][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=fac12623415bd184e7b747cd0e26aa59).
[2015-05-29 17:13:14,687][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:14,687][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:14,688][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:14,690][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6ttFDFcpmi1MamgAomcAmY77ZmH0pucSJt0uEHFSyYt5ce77nCUB0dU/6D0t0q335DGarYFQeFe5.
[2015-05-29 17:13:14,690][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890794673|Timestamp:20150529171314|Transaction-Type:201|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:14,690][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300005797&quot; isMannul=&quot;0&quot;/&gt;
[2015-05-29 17:13:14,691][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890794673|Timestamp:20150529171314|Transaction-Type:201|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300005797&quot; isMannul=&quot;0&quot;/&gt;,hash=1860535710), get digest:fac12623415bd184e7b747cd0e26aa59
[2015-05-29 17:13:14,691][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.201).
[2015-05-29 17:13:14,691][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/CancelTicket_Req.xml
[2015-05-29 17:13:14,691][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.201).
[2015-05-29 17:13:14,712][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_201_1.5.0).
[2015-05-29 17:13:14,712][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_201_).
[2015-05-29 17:13:14,712][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_201_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.cancelByTicket(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:14,723][Test worker][DEBUG][ReversalOrCancelStrategyFactory] Found ReversalStrategy(class com.mpos.lottery.te.gameimpl.lfn.sale.service.LfnSaleService) to cancel transaction(gameType=15,terminalId=111,transType=200,protocolVersion=1.5.0).
[2015-05-29 17:13:14,742][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199997400, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=520]
[2015-05-29 17:13:14,742][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:14,743][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=520]
[2015-05-29 17:13:14,863][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.CANCEL.200.15]: origTrans {
  id: &quot;0115052900000000000558&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890794000
  trans_type: 200
  game_id: &quot;LFN-1&quot;
  game_type: 15
  total_amount: &quot;2600&quot;
}
cancelTrans {
  id: &quot;0115052900000000000605&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890794000
  trans_type: 201
  game_id: &quot;LFN-1&quot;
  game_type: 15
  total_amount: &quot;2600&quot;
}

[2015-05-29 17:13:14,864][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:14,864][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890794673|Timestamp:20150529171314|Transaction-Type:4201|Transaction-Id:0115052900000000000605|Response-Code:200|):97d3ae691cba43d144b115bedcb0b029
[2015-05-29 17:13:14,864][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=0): 
[2015-05-29 17:13:14,865][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.201).
[2015-05-29 17:13:14,866][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/CancelTicket_Req.xml).
[2015-05-29 17:13:14,866][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890794865|Timestamp:20150529171314|Transaction-Type:201|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300005797&quot; isMannul=&quot;0&quot;/&gt;,hash=-602275559), get digest:94e11366048e2714b0355a9170d5f579
[2015-05-29 17:13:14,867][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=201).
[2015-05-29 17:13:14,867][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:14,867][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171314).
[2015-05-29 17:13:14,867][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:14,867][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890794865).
[2015-05-29 17:13:14,867][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:14,867][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:14,867][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=94e11366048e2714b0355a9170d5f579).
[2015-05-29 17:13:14,867][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:14,867][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:14,867][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:14,870][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6ttFDFcpmi1MamgAomcAmY77ZmH0pucSJt0uEHFSyYt5ce77nCUB0dU/6D0t0q335DGarYFQeFe5.
[2015-05-29 17:13:14,870][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890794865|Timestamp:20150529171314|Transaction-Type:201|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:14,871][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300005797&quot; isMannul=&quot;0&quot;/&gt;
[2015-05-29 17:13:14,871][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890794865|Timestamp:20150529171314|Transaction-Type:201|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300005797&quot; isMannul=&quot;0&quot;/&gt;,hash=-602275559), get digest:94e11366048e2714b0355a9170d5f579
[2015-05-29 17:13:14,871][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.201).
[2015-05-29 17:13:14,871][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/CancelTicket_Req.xml
[2015-05-29 17:13:14,871][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.201).
[2015-05-29 17:13:14,889][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_201_1.5.0).
[2015-05-29 17:13:14,889][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_201_).
[2015-05-29 17:13:14,889][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_201_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.cancelByTicket(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:14,893][Test worker][INFO ][TransactionServiceImpl] NO need to rollback transaction(id=0115052900000000000558), it has been rollbacked.
[2015-05-29 17:13:14,893][Test worker][ERROR][TEPortServlet] The transaction(id=0115052900000000000558) has been reversed, no need to reverse repeatedly.
com.mpos.lottery.te.config.exception.ApplicationException: The transaction(id=0115052900000000000558) has been reversed, no need to reverse repeatedly.
	at com.mpos.lottery.te.trans.service.impl.TransactionServiceImpl.reverseOrCancel(TransactionServiceImpl.java:166)
	at com.mpos.lottery.te.trans.service.impl.TransactionServiceImpl.reverseOrCancel(TransactionServiceImpl.java:227)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy55.reverseOrCancel(Unknown Source)
	at com.mpos.lottery.te.gameimpl.lfn.LfnController.cancelByTicket(LfnController.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at com.mpos.lottery.common.router.RoutineRegistry.route(RoutineRegistry.java:57)
	at com.mpos.lottery.te.port.service.CommonFacadeService.routeRequest(CommonFacadeService.java:237)
	at com.mpos.lottery.te.port.service.CommonFacadeService.facade(CommonFacadeService.java:96)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:98)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:262)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:95)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:207)
	at com.sun.proxy.$Proxy85.facade(Unknown Source)
	at com.mpos.lottery.te.port.TEPortServlet.doPost(TEPortServlet.java:121)
	at com.mpos.lottery.te.test.integration.BaseServletIntegrationTest.doPost(BaseServletIntegrationTest.java:80)
	at com.mpos.lottery.te.gameimpl.lfn.sale.LfnSaleCancellationIntegrationTest.testCancelByTicket_Repeatedly(LfnSaleCancellationIntegrationTest.java:205)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:233)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:87)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:176)
	at org.junit.runners.Suite.runChild(Suite.java:127)
	at org.junit.runners.Suite.runChild(Suite.java:26)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:86)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:49)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:69)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:48)
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.messaging.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy2.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:105)
	at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.messaging.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.messaging.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:360)
	at org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:64)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
[2015-05-29 17:13:14,895][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890794865|Timestamp:20150529171314|Transaction-Type:4201|Transaction-Id:0115052900000000000606|Response-Code:321|):01f08e2642200d10070ee900509a6d5b
[2015-05-29 17:13:14,895][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=321,length=0): 
[2015-05-29 17:13:14,917][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:14,917][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:14,917][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@971df1e) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:14,918][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:14,918][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:14,918][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnSaleCancellationIntegrationTest.testCancelByTicket_OK                                                               |
[2015-05-29 17:13:14,919][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:14,925][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:14,926][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:14,927][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890794925|Timestamp:20150529171314|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;2600.0&quot; PIN=&quot;!!!!&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=-701421178), get digest:9214652e56dcb2e1fe02235b299fd5eb
[2015-05-29 17:13:14,927][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:14,927][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:14,927][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171314).
[2015-05-29 17:13:14,927][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:14,927][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890794925).
[2015-05-29 17:13:14,927][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:14,927][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:14,927][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=9214652e56dcb2e1fe02235b299fd5eb).
[2015-05-29 17:13:14,927][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:14,927][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:14,927][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:14,929][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9L2k05jXFbPjS1FsBBTLuWj4a8kJVsM72/YMzruGEM7DWPI5uQU+kvE7y74H12t4zbaRoUQTDb7n/h8zAxrh6Hn2mtyfU/CYtxKe3z/Py5RlIQZDC6AG8TrAvhb3G3SNDjlu4Vxm32uHjs7iClqnt2hDh9rhQSOHhB9K5LUL3NVo8dKwh6SCwM56BaXiK557zz5HaYz2004U1raT6OlReAP7pgHuknsbfxdYkwSI2v0wkzsQ/uHRPv01BVY1tFvgu1/1csAMYBq+O2tRLIhXeAoIJOVLJJPvPHAkozf5FsxcYBza1aivogG1+z8aPrO9uA0h0ScFgQ8LmCP5AX0mf6ruPkYWDcmUtW5ansd9eHP+N72iCfLshuhdBbTWGleRy.
[2015-05-29 17:13:14,929][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890794925|Timestamp:20150529171314|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:14,929][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;2600.0&quot; PIN=&quot;!!!!&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:14,930][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890794925|Timestamp:20150529171314|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;2600.0&quot; PIN=&quot;!!!!&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=-701421178), get digest:9214652e56dcb2e1fe02235b299fd5eb
[2015-05-29 17:13:14,930][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:14,930][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:14,930][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:14,947][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_1.5.0).
[2015-05-29 17:13:14,947][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_).
[2015-05-29 17:13:14,947][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_200_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:14,960][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance) by(number=11002,gameId=LFN-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:14,969][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:14,969][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01111745519300005830
[2015-05-29 17:13:14,978][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:14,981][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMiQ400blj3mp) as 80000
[2015-05-29 17:13:14,986][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMiQ400blj3mp, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:14,986][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:14,986][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:14,995][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMiQ400blj3mp) as 80000
[2015-05-29 17:13:14,997][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMiQ400blj3mp, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:14,998][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:14,998][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:15,006][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:15,006][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:15,015][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:15,015][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:15,023][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:15,023][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:15,030][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:15,030][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:15,038][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:15,038][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:15,045][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:15,045][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:15,054][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:15,054][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:15,062][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:15,062][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:15,071][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:15,071][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:15,078][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:15,078][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:15,086][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:15,086][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:15,096][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:15,096][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:15,110][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:15,110][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:15,118][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:15,118][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:15,126][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:15,127][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:15,137][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:15,137][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:15,146][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:15,146][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:15,158][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:15,158][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:15,166][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:15,166][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:15,193][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMiQ400blj3mp) as 80000
[2015-05-29 17:13:15,198][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMiQ400blj3mp, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:15,198][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:15,198][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:15,206][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMiQ400blj3mp) as 80000
[2015-05-29 17:13:15,208][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMiQ400blj3mp, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:15,209][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:15,209][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:15,216][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:15,216][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:15,225][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:15,225][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:15,231][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:15,232][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:15,240][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:15,240][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:15,248][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:15,248][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:15,256][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:15,256][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:15,263][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:15,263][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:15,274][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:15,274][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:15,284][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:15,284][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:15,297][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:15,297][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:15,304][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:15,304][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:15,313][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:15,314][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:15,321][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:15,321][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:15,330][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:15,330][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:15,336][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:15,336][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:15,348][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:15,348][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:15,356][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:15,356][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:15,365][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:15,366][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:15,375][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:15,375][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:15,400][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:15,400][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:15,400][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199997400.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:15,424][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.15]: transaction {
  id: &quot;0115052900000000000607&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890794000
  trans_type: 200
  game_id: &quot;LFN-1&quot;
  game_type: 15
  total_amount: &quot;2600.0&quot;
}
multi_draw: 2
total_amount: &quot;2600.0&quot;
serial_no: &quot;y013eOifYgLRjcmw7N8vMiQ400blj3mp&quot;
game_instance {
  id: &quot;GII-112&quot;
}
entries {
  selected_number: &quot;2,7,13,24,25,36&quot;
  bet_option: 53
  total_bets: 20
  entry_amount: &quot;1200.0&quot;
  input_channel: &quot;2&quot;
}
entries {
  selected_number: &quot;5&quot;
  bet_option: 1
  total_bets: 1
  entry_amount: &quot;100.0&quot;
  input_channel: &quot;2&quot;
}

[2015-05-29 17:13:15,425][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:15,425][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:15,425][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket),mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml
[2015-05-29 17:13:15,425][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:15,426][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml).
[2015-05-29 17:13:15,426][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890794925|Timestamp:20150529171314|Transaction-Type:4200|Transaction-Id:0115052900000000000607|Response-Code:200|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300005830&quot; type=&quot;1&quot; lastDrawNo=&quot;11003&quot; barcode=&quot;15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqT1k7HhvJd1Y=&quot; validationCode=&quot;302997&quot; multipleDraws=&quot;2&quot; totalBets=&quot;42&quot; totalAmount=&quot;2600.0&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot;/&gt;&lt;/Ticket&gt;):3c8f3d738b48566359e8ab2f0d7dd2ca
[2015-05-29 17:13:15,427][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=672) succesfully.
[2015-05-29 17:13:15,427][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=672): &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300005830&quot; type=&quot;1&quot; lastDrawNo=&quot;11003&quot; barcode=&quot;15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqT1k7HhvJd1Y=&quot; validationCode=&quot;302997&quot; multipleDraws=&quot;2&quot; totalBets=&quot;42&quot; totalAmount=&quot;2600.0&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:15,427][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:15,435][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.201).
[2015-05-29 17:13:15,435][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/CancelTicket_Req.xml).
[2015-05-29 17:13:15,436][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890795435|Timestamp:20150529171315|Transaction-Type:201|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300005830&quot; isMannul=&quot;0&quot;/&gt;,hash=1203035676), get digest:0e2da4c687b8652cd34d3b7b41c99e97
[2015-05-29 17:13:15,436][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=201).
[2015-05-29 17:13:15,436][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:15,436][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171315).
[2015-05-29 17:13:15,436][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:15,436][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890795435).
[2015-05-29 17:13:15,436][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:15,436][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:15,436][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=0e2da4c687b8652cd34d3b7b41c99e97).
[2015-05-29 17:13:15,436][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:15,436][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:15,436][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:15,439][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6ttFDFcpmi1MamgAomcAmY77ZmH0pucSJt0uEHFSyYt5etEvU23z1IpcPVAedo/YNUmxfebxxjMW.
[2015-05-29 17:13:15,439][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890795435|Timestamp:20150529171315|Transaction-Type:201|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:15,439][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300005830&quot; isMannul=&quot;0&quot;/&gt;
[2015-05-29 17:13:15,439][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890795435|Timestamp:20150529171315|Transaction-Type:201|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300005830&quot; isMannul=&quot;0&quot;/&gt;,hash=1203035676), get digest:0e2da4c687b8652cd34d3b7b41c99e97
[2015-05-29 17:13:15,439][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.201).
[2015-05-29 17:13:15,440][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/CancelTicket_Req.xml
[2015-05-29 17:13:15,440][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.201).
[2015-05-29 17:13:15,455][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_201_1.5.0).
[2015-05-29 17:13:15,455][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_201_).
[2015-05-29 17:13:15,455][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_201_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.cancelByTicket(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:15,463][Test worker][DEBUG][ReversalOrCancelStrategyFactory] Found ReversalStrategy(class com.mpos.lottery.te.gameimpl.lfn.sale.service.LfnSaleService) to cancel transaction(gameType=15,terminalId=111,transType=200,protocolVersion=1.5.0).
[2015-05-29 17:13:15,476][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199997400, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=520]
[2015-05-29 17:13:15,477][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:15,477][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=520]
[2015-05-29 17:13:15,566][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.CANCEL.200.15]: origTrans {
  id: &quot;0115052900000000000607&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890794000
  trans_type: 200
  game_id: &quot;LFN-1&quot;
  game_type: 15
  total_amount: &quot;2600&quot;
}
cancelTrans {
  id: &quot;0115052900000000000654&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890795000
  trans_type: 201
  game_id: &quot;LFN-1&quot;
  game_type: 15
  total_amount: &quot;2600&quot;
}

[2015-05-29 17:13:15,567][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:15,568][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890795435|Timestamp:20150529171315|Transaction-Type:4201|Transaction-Id:0115052900000000000654|Response-Code:200|):eb0f4a6975d7f586ce3748333eaeab5d
[2015-05-29 17:13:15,568][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=0): 
[2015-05-29 17:13:15,609][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:15,609][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:15,609][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@7c055db5) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:15,610][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:15,610][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:15,610][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnSaleCancellationIntegrationTest.testCancel_UseParentCredit_VerifyBalanceLog_OK                                      |
[2015-05-29 17:13:15,610][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:15,619][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:15,620][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:15,621][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890795618|Timestamp:20150529171315|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;2600.0&quot; PIN=&quot;!!!!&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=218436871), get digest:0fcb87331f7926a74390425fa580bb79
[2015-05-29 17:13:15,622][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:15,622][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:15,622][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171315).
[2015-05-29 17:13:15,622][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:15,622][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890795618).
[2015-05-29 17:13:15,622][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:15,622][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:15,622][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=0fcb87331f7926a74390425fa580bb79).
[2015-05-29 17:13:15,622][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:15,622][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:15,622][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:15,625][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9L2k05jXFbPjS1FsBBTLuWj4a8kJVsM72/YMzruGEM7DWPI5uQU+kvE7y74H12t4zbaRoUQTDb7n/h8zAxrh6Hn2mtyfU/CYtxKe3z/Py5RlIQZDC6AG8TrAvhb3G3SNDjlu4Vxm32uHjs7iClqnt2hDh9rhQSOHhB9K5LUL3NVo8dKwh6SCwM56BaXiK557zz5HaYz2004U1raT6OlReAP7pgHuknsbfxdYkwSI2v0wkzsQ/uHRPv01BVY1tFvgu1/1csAMYBq+O2tRLIhXeAoIJOVLJJPvPHAkozf5FsxcYBza1aivogG1+z8aPrO9uA0h0ScFgQ8LmCP5AX0mf6ruPkYWDcmUtW5ansd9eHP+N72iCfLshuhdBbTWGleRy.
[2015-05-29 17:13:15,625][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890795618|Timestamp:20150529171315|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:15,626][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;2600.0&quot; PIN=&quot;!!!!&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:15,626][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890795618|Timestamp:20150529171315|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;2600.0&quot; PIN=&quot;!!!!&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=218436871), get digest:0fcb87331f7926a74390425fa580bb79
[2015-05-29 17:13:15,626][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:15,626][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:15,626][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:15,648][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_1.5.0).
[2015-05-29 17:13:15,648][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_).
[2015-05-29 17:13:15,648][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_200_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:15,662][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance) by(number=11002,gameId=LFN-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:15,673][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:15,673][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01111745519300005956
[2015-05-29 17:13:15,686][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:15,691][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMrS1hQE1Jy8Q) as 80000
[2015-05-29 17:13:15,697][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMrS1hQE1Jy8Q, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:15,697][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:15,697][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:15,714][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMrS1hQE1Jy8Q) as 80000
[2015-05-29 17:13:15,717][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMrS1hQE1Jy8Q, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:15,718][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:15,718][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:15,726][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:15,726][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:15,735][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:15,735][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:15,743][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:15,743][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:15,750][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:15,750][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:15,757][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:15,757][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:15,763][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:15,763][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:15,770][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:15,770][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:15,780][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:15,780][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:15,788][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:15,788][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:15,798][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:15,798][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:15,806][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:15,806][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:15,815][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:15,816][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:15,822][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:15,822][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:15,830][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:15,831][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:15,837][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:15,837][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:15,844][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:15,844][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:15,851][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:15,851][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:15,858][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:15,858][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:15,865][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:15,865][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:15,872][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMrS1hQE1Jy8Q) as 80000
[2015-05-29 17:13:15,874][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMrS1hQE1Jy8Q, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:15,874][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:15,874][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:15,881][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMrS1hQE1Jy8Q) as 80000
[2015-05-29 17:13:15,884][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMrS1hQE1Jy8Q, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:15,884][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:15,884][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:15,890][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:15,890][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:15,897][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:15,897][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:15,904][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:15,904][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:15,911][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:15,911][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:15,923][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:15,923][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:15,931][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:15,931][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:15,937][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:15,938][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:15,945][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:15,945][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:15,953][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:15,953][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:15,960][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:15,960][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:15,967][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:15,967][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:15,975][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:15,975][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:15,982][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:15,983][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:15,990][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:15,990][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:15,997][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:15,997][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:16,003][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:16,004][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:16,011][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:16,011][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:16,019][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:16,019][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:16,026][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:16,026][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:16,037][Test worker][DEBUG][DefaultBalanceService] Ignore balance calculation of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=4, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0], as its credit type is USE PARENT... check its parent merchant
[2015-05-29 17:13:16,048][Test worker][DEBUG][DefaultBalanceService] Merchant before transaction: Merchant [id=111, name=M-111, saleCreditLevel=100000000, payoutCreditLevel=1000, creditType=1, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:16,048][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:16,048][Test worker][DEBUG][DefaultBalanceService] Merchant after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=4, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:16,069][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.15]: transaction {
  id: &quot;0115052900000000000655&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890795000
  trans_type: 200
  game_id: &quot;LFN-1&quot;
  game_type: 15
  total_amount: &quot;2600.0&quot;
}
multi_draw: 2
total_amount: &quot;2600.0&quot;
serial_no: &quot;y013eOifYgLRjcmw7N8vMrS1hQE1Jy8Q&quot;
game_instance {
  id: &quot;GII-112&quot;
}
entries {
  selected_number: &quot;2,7,13,24,25,36&quot;
  bet_option: 53
  total_bets: 20
  entry_amount: &quot;1200.0&quot;
  input_channel: &quot;2&quot;
}
entries {
  selected_number: &quot;5&quot;
  bet_option: 1
  total_bets: 1
  entry_amount: &quot;100.0&quot;
  input_channel: &quot;2&quot;
}

[2015-05-29 17:13:16,070][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:16,070][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:16,070][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket),mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml
[2015-05-29 17:13:16,070][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:16,071][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml).
[2015-05-29 17:13:16,071][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890795618|Timestamp:20150529171315|Transaction-Type:4200|Transaction-Id:0115052900000000000655|Response-Code:200|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300005956&quot; type=&quot;1&quot; lastDrawNo=&quot;11003&quot; barcode=&quot;15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqjYVaqiCl4pE=&quot; validationCode=&quot;400379&quot; multipleDraws=&quot;2&quot; totalBets=&quot;42&quot; totalAmount=&quot;2600.0&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot;/&gt;&lt;/Ticket&gt;):94f87e3d88d7c30d82ee10bfb6990623
[2015-05-29 17:13:16,072][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=672) succesfully.
[2015-05-29 17:13:16,072][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=672): &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300005956&quot; type=&quot;1&quot; lastDrawNo=&quot;11003&quot; barcode=&quot;15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqjYVaqiCl4pE=&quot; validationCode=&quot;400379&quot; multipleDraws=&quot;2&quot; totalBets=&quot;42&quot; totalAmount=&quot;2600.0&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:16,072][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:16,077][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:13:16,078][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.trans.domain.Transaction, mappingFile=xml-mapping/TransactionEnquiry_Req.xml).
[2015-05-29 17:13:16,079][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890796077|Timestamp:20150529171316|Transaction-Type:206|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Transaction terminalId=&quot;111&quot; traceMessageId=&quot;1432890795618&quot;/&gt;,hash=57214663), get digest:a86010ee67b29416226c6cd6f60ccf7b
[2015-05-29 17:13:16,079][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=206).
[2015-05-29 17:13:16,079][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:16,079][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171316).
[2015-05-29 17:13:16,079][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:16,079][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890796077).
[2015-05-29 17:13:16,079][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:16,079][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:16,079][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=a86010ee67b29416226c6cd6f60ccf7b).
[2015-05-29 17:13:16,079][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=-1).
[2015-05-29 17:13:16,079][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:16,079][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:16,081][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6jcIE4b0pl+ogrA4SMNVUFtCb0VnctvqFZ4g+Dv1D5Fz4ERoX4gVmzFJ1yZK27DdHzGiSG2v578fwD3zlmcjWP4=.
[2015-05-29 17:13:16,081][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890796077|Timestamp:20150529171316|Transaction-Type:206|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:16,081][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Transaction terminalId=&quot;111&quot; traceMessageId=&quot;1432890795618&quot;/&gt;
[2015-05-29 17:13:16,082][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890796077|Timestamp:20150529171316|Transaction-Type:206|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Transaction terminalId=&quot;111&quot; traceMessageId=&quot;1432890795618&quot;/&gt;,hash=57214663), get digest:a86010ee67b29416226c6cd6f60ccf7b
[2015-05-29 17:13:16,082][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:13:16,082][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/TransactionEnquiry_Req.xml
[2015-05-29 17:13:16,082][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:13:16,095][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_206_1.5.0).
[2015-05-29 17:13:16,096][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_206_).
[2015-05-29 17:13:16,096][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(-1_206_), found controller(com.mpos.lottery.te.trans.TransactionController@53ddecd8) and method(public void com.mpos.lottery.te.trans.TransactionController.cancelByTrans(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:16,105][Test worker][DEBUG][ReversalOrCancelStrategyFactory] Found ReversalStrategy(class com.mpos.lottery.te.gameimpl.lfn.sale.service.LfnSaleService) to cancel transaction(gameType=15,terminalId=111,transType=200,protocolVersion=1.5.0).
[2015-05-29 17:13:16,113][Test worker][DEBUG][DefaultBalanceService] Ignore balance calculation of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=4, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0], as its credit type is USE PARENT... check its parent merchant
[2015-05-29 17:13:16,121][Test worker][DEBUG][DefaultBalanceService] Merchant before transaction: Merchant [id=111, name=M-111, saleCreditLevel=99997400, payoutCreditLevel=1000, creditType=1, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:16,121][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:16,121][Test worker][DEBUG][DefaultBalanceService] Merchant after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=4, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:16,256][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.CANCEL.200.15]: origTrans {
  id: &quot;0115052900000000000655&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890795000
  trans_type: 200
  game_id: &quot;LFN-1&quot;
  game_type: 15
  total_amount: &quot;2600&quot;
}
cancelTrans {
  id: &quot;0115052900000000000702&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890796000
  trans_type: 206
  game_id: &quot;LFN-1&quot;
  game_type: 15
  total_amount: &quot;2600&quot;
}

[2015-05-29 17:13:16,256][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:16,257][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890796077|Timestamp:20150529171316|Transaction-Type:4206|Transaction-Id:0115052900000000000702|Response-Code:200|):2a193982f636ee6cde51ee66d079a290
[2015-05-29 17:13:16,257][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=0): 
[2015-05-29 17:13:16,294][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:16,294][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:16,294][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@10094be0) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:16,295][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:16,295][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:16,295][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnSaleCancellationIntegrationTest.testCancelByTransaction_OK                                                          |
[2015-05-29 17:13:16,295][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:16,300][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:16,301][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:16,302][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890796300|Timestamp:20150529171316|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;2600.0&quot; PIN=&quot;!!!!&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=1360101299), get digest:7065d6e1ccd00e6643281eda891c47aa
[2015-05-29 17:13:16,302][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:16,302][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:16,302][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171316).
[2015-05-29 17:13:16,302][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:16,302][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890796300).
[2015-05-29 17:13:16,302][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:16,302][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:16,302][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=7065d6e1ccd00e6643281eda891c47aa).
[2015-05-29 17:13:16,302][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:16,302][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:16,303][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:16,305][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9L2k05jXFbPjS1FsBBTLuWj4a8kJVsM72/YMzruGEM7DWPI5uQU+kvE7y74H12t4zbaRoUQTDb7n/h8zAxrh6Hn2mtyfU/CYtxKe3z/Py5RlIQZDC6AG8TrAvhb3G3SNDjlu4Vxm32uHjs7iClqnt2hDh9rhQSOHhB9K5LUL3NVo8dKwh6SCwM56BaXiK557zz5HaYz2004U1raT6OlReAP7pgHuknsbfxdYkwSI2v0wkzsQ/uHRPv01BVY1tFvgu1/1csAMYBq+O2tRLIhXeAoIJOVLJJPvPHAkozf5FsxcYBza1aivogG1+z8aPrO9uA0h0ScFgQ8LmCP5AX0mf6ruPkYWDcmUtW5ansd9eHP+N72iCfLshuhdBbTWGleRy.
[2015-05-29 17:13:16,305][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890796300|Timestamp:20150529171316|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:16,305][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;2600.0&quot; PIN=&quot;!!!!&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:16,306][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890796300|Timestamp:20150529171316|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;2600.0&quot; PIN=&quot;!!!!&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=1360101299), get digest:7065d6e1ccd00e6643281eda891c47aa
[2015-05-29 17:13:16,306][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:16,306][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:16,306][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:16,324][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_1.5.0).
[2015-05-29 17:13:16,324][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_).
[2015-05-29 17:13:16,324][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_200_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:16,334][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance) by(number=11002,gameId=LFN-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:16,340][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:16,340][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01111745519300006097
[2015-05-29 17:13:16,349][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:16,352][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMsygwILv45Sf) as 80000
[2015-05-29 17:13:16,356][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMsygwILv45Sf, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:16,356][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:16,356][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:16,369][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMsygwILv45Sf) as 80000
[2015-05-29 17:13:16,372][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMsygwILv45Sf, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:16,372][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:16,372][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:16,386][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:16,386][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:16,396][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:16,396][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:16,405][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:16,405][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:16,413][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:16,413][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:16,425][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:16,425][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:16,433][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:16,433][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:16,442][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:16,442][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:16,454][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:16,454][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:16,462][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:16,462][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:16,471][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:16,471][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:16,479][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:16,479][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:16,489][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:16,489][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:16,498][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:16,498][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:16,506][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:16,506][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:16,514][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:16,514][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:16,526][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:16,526][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:16,536][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:16,536][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:16,543][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:16,543][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:16,553][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:16,553][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:16,560][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMsygwILv45Sf) as 80000
[2015-05-29 17:13:16,563][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMsygwILv45Sf, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:16,563][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:16,563][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:16,570][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMsygwILv45Sf) as 80000
[2015-05-29 17:13:16,573][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMsygwILv45Sf, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:16,573][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:16,573][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:16,587][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:16,587][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:16,595][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:16,595][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:16,601][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:16,601][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:16,608][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:16,608][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:16,615][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:16,615][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:16,623][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:16,623][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:16,630][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:16,630][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:16,636][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:16,636][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:16,643][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:16,643][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:16,650][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:16,650][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:16,657][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:16,657][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:16,664][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:16,664][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:16,672][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:16,672][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:16,679][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:16,679][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:16,689][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:16,690][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:16,700][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:16,700][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:16,711][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:16,711][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:16,720][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:16,720][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:16,727][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:16,727][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:16,767][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:16,767][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:16,767][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199997400.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:16,790][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.15]: transaction {
  id: &quot;0115052900000000000703&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890796000
  trans_type: 200
  game_id: &quot;LFN-1&quot;
  game_type: 15
  total_amount: &quot;2600.0&quot;
}
multi_draw: 2
total_amount: &quot;2600.0&quot;
serial_no: &quot;y013eOifYgLRjcmw7N8vMsygwILv45Sf&quot;
game_instance {
  id: &quot;GII-112&quot;
}
entries {
  selected_number: &quot;2,7,13,24,25,36&quot;
  bet_option: 53
  total_bets: 20
  entry_amount: &quot;1200.0&quot;
  input_channel: &quot;2&quot;
}
entries {
  selected_number: &quot;5&quot;
  bet_option: 1
  total_bets: 1
  entry_amount: &quot;100.0&quot;
  input_channel: &quot;2&quot;
}

[2015-05-29 17:13:16,791][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:16,791][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:16,791][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket),mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml
[2015-05-29 17:13:16,791][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:16,792][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml).
[2015-05-29 17:13:16,792][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890796300|Timestamp:20150529171316|Transaction-Type:4200|Transaction-Id:0115052900000000000703|Response-Code:200|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300006097&quot; type=&quot;1&quot; lastDrawNo=&quot;11003&quot; barcode=&quot;15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqEwMYCDHuNUs=&quot; validationCode=&quot;325453&quot; multipleDraws=&quot;2&quot; totalBets=&quot;42&quot; totalAmount=&quot;2600.0&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot;/&gt;&lt;/Ticket&gt;):2a7de1eda3af0cd2db8dcf98055abbf3
[2015-05-29 17:13:16,793][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=672) succesfully.
[2015-05-29 17:13:16,793][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=672): &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300006097&quot; type=&quot;1&quot; lastDrawNo=&quot;11003&quot; barcode=&quot;15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqEwMYCDHuNUs=&quot; validationCode=&quot;325453&quot; multipleDraws=&quot;2&quot; totalBets=&quot;42&quot; totalAmount=&quot;2600.0&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:16,793][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:16,799][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:13:16,799][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.trans.domain.Transaction, mappingFile=xml-mapping/TransactionEnquiry_Req.xml).
[2015-05-29 17:13:16,799][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890796798|Timestamp:20150529171316|Transaction-Type:206|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Transaction terminalId=&quot;111&quot; traceMessageId=&quot;1432890796300&quot;/&gt;,hash=-1867001492), get digest:ad8aa49a0374bacf76be1dc1a329e820
[2015-05-29 17:13:16,800][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=206).
[2015-05-29 17:13:16,800][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:16,800][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171316).
[2015-05-29 17:13:16,800][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:16,800][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890796798).
[2015-05-29 17:13:16,800][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:16,800][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:16,800][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=ad8aa49a0374bacf76be1dc1a329e820).
[2015-05-29 17:13:16,800][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=-1).
[2015-05-29 17:13:16,800][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:16,800][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:16,802][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6jcIE4b0pl+ogrA4SMNVUFtCb0VnctvqFZ4g+Dv1D5Fz4ERoX4gVmzFJ1yZK27DdH6afYLYLa7Q6zzw/d74F5bw=.
[2015-05-29 17:13:16,802][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890796798|Timestamp:20150529171316|Transaction-Type:206|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:16,803][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Transaction terminalId=&quot;111&quot; traceMessageId=&quot;1432890796300&quot;/&gt;
[2015-05-29 17:13:16,803][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890796798|Timestamp:20150529171316|Transaction-Type:206|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Transaction terminalId=&quot;111&quot; traceMessageId=&quot;1432890796300&quot;/&gt;,hash=-1867001492), get digest:ad8aa49a0374bacf76be1dc1a329e820
[2015-05-29 17:13:16,803][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:13:16,803][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/TransactionEnquiry_Req.xml
[2015-05-29 17:13:16,803][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:13:16,821][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_206_1.5.0).
[2015-05-29 17:13:16,821][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_206_).
[2015-05-29 17:13:16,821][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(-1_206_), found controller(com.mpos.lottery.te.trans.TransactionController@53ddecd8) and method(public void com.mpos.lottery.te.trans.TransactionController.cancelByTrans(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:16,831][Test worker][DEBUG][ReversalOrCancelStrategyFactory] Found ReversalStrategy(class com.mpos.lottery.te.gameimpl.lfn.sale.service.LfnSaleService) to cancel transaction(gameType=15,terminalId=111,transType=200,protocolVersion=1.5.0).
[2015-05-29 17:13:16,851][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199997400, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=520]
[2015-05-29 17:13:16,851][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:16,851][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=520]
[2015-05-29 17:13:16,954][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.CANCEL.200.15]: origTrans {
  id: &quot;0115052900000000000703&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890796000
  trans_type: 200
  game_id: &quot;LFN-1&quot;
  game_type: 15
  total_amount: &quot;2600&quot;
}
cancelTrans {
  id: &quot;0115052900000000000750&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890796000
  trans_type: 206
  game_id: &quot;LFN-1&quot;
  game_type: 15
  total_amount: &quot;2600&quot;
}

[2015-05-29 17:13:16,954][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:16,955][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890796798|Timestamp:20150529171316|Transaction-Type:4206|Transaction-Id:0115052900000000000750|Response-Code:200|):1af7d9b07406d50325dad98a9a9db366
[2015-05-29 17:13:16,955][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=0): 
[2015-05-29 17:13:16,976][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:16,977][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:16,977][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@20d0ac06) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:16,977][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:16,977][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:16,977][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnSaleCancellationIntegrationTest.testCancel_DefiniteCredit_VerifyBalanceLog_OK                                       |
[2015-05-29 17:13:16,977][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:16,981][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:16,983][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:16,984][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890796981|Timestamp:20150529171316|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;2600.0&quot; PIN=&quot;!!!!&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=1893230996), get digest:8a7dfb48a28f8ebfc425dc9313c850b3
[2015-05-29 17:13:16,985][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:16,985][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:16,985][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171316).
[2015-05-29 17:13:16,985][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:16,985][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890796981).
[2015-05-29 17:13:16,985][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:16,985][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:16,985][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=8a7dfb48a28f8ebfc425dc9313c850b3).
[2015-05-29 17:13:16,985][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:16,985][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:16,985][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:16,987][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9L2k05jXFbPjS1FsBBTLuWj4a8kJVsM72/YMzruGEM7DWPI5uQU+kvE7y74H12t4zbaRoUQTDb7n/h8zAxrh6Hn2mtyfU/CYtxKe3z/Py5RlIQZDC6AG8TrAvhb3G3SNDjlu4Vxm32uHjs7iClqnt2hDh9rhQSOHhB9K5LUL3NVo8dKwh6SCwM56BaXiK557zz5HaYz2004U1raT6OlReAP7pgHuknsbfxdYkwSI2v0wkzsQ/uHRPv01BVY1tFvgu1/1csAMYBq+O2tRLIhXeAoIJOVLJJPvPHAkozf5FsxcYBza1aivogG1+z8aPrO9uA0h0ScFgQ8LmCP5AX0mf6ruPkYWDcmUtW5ansd9eHP+N72iCfLshuhdBbTWGleRy.
[2015-05-29 17:13:16,987][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890796981|Timestamp:20150529171316|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:16,988][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;2600.0&quot; PIN=&quot;!!!!&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:16,988][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890796981|Timestamp:20150529171316|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;2600.0&quot; PIN=&quot;!!!!&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=1893230996), get digest:8a7dfb48a28f8ebfc425dc9313c850b3
[2015-05-29 17:13:16,988][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:16,988][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:16,988][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:17,005][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_1.5.0).
[2015-05-29 17:13:17,005][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_).
[2015-05-29 17:13:17,005][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_200_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:17,014][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance) by(number=11002,gameId=LFN-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:17,019][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:17,020][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01111745519300006178
[2015-05-29 17:13:17,028][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:17,032][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMs7y/HKIcDtk) as 80000
[2015-05-29 17:13:17,039][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMs7y/HKIcDtk, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:17,039][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:17,039][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:17,049][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMs7y/HKIcDtk) as 80000
[2015-05-29 17:13:17,052][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMs7y/HKIcDtk, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:17,052][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:17,052][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:17,060][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:17,060][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:17,067][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:17,067][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:17,075][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:17,075][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:17,082][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:17,082][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:17,090][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:17,090][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:17,097][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:17,097][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:17,104][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:17,104][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:17,111][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:17,111][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:17,123][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:17,123][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:17,140][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:17,140][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:17,148][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:17,148][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:17,159][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:17,159][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:17,169][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:17,169][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:17,178][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:17,178][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:17,187][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:17,187][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:17,198][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:17,198][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:17,206][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:17,206][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:17,213][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:17,213][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:17,220][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:17,220][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:17,228][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMs7y/HKIcDtk) as 80000
[2015-05-29 17:13:17,230][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMs7y/HKIcDtk, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:17,230][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:17,231][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:17,239][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMs7y/HKIcDtk) as 80000
[2015-05-29 17:13:17,241][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMs7y/HKIcDtk, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:17,241][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:17,241][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:17,248][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:17,248][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:17,257][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:17,257][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:17,264][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:17,264][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:17,272][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:17,272][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:17,282][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:17,282][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:17,290][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:17,290][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:17,297][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:17,297][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:17,304][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:17,304][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:17,311][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:17,311][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:17,318][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:17,318][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:17,325][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:17,326][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:17,338][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:17,338][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:17,349][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:17,349][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:17,362][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:17,362][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:17,373][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:17,373][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:17,382][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:17,382][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:17,396][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:17,396][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:17,406][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:17,406][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:17,414][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:17,414][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:17,446][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:17,446][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:17,446][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199997400.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:17,466][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.15]: transaction {
  id: &quot;0115052900000000000751&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890796000
  trans_type: 200
  game_id: &quot;LFN-1&quot;
  game_type: 15
  total_amount: &quot;2600.0&quot;
}
multi_draw: 2
total_amount: &quot;2600.0&quot;
serial_no: &quot;y013eOifYgLRjcmw7N8vMs7y/HKIcDtk&quot;
game_instance {
  id: &quot;GII-112&quot;
}
entries {
  selected_number: &quot;2,7,13,24,25,36&quot;
  bet_option: 53
  total_bets: 20
  entry_amount: &quot;1200.0&quot;
  input_channel: &quot;2&quot;
}
entries {
  selected_number: &quot;5&quot;
  bet_option: 1
  total_bets: 1
  entry_amount: &quot;100.0&quot;
  input_channel: &quot;2&quot;
}

[2015-05-29 17:13:17,466][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:17,466][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:17,466][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket),mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml
[2015-05-29 17:13:17,466][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:17,467][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml).
[2015-05-29 17:13:17,467][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890796981|Timestamp:20150529171316|Transaction-Type:4200|Transaction-Id:0115052900000000000751|Response-Code:200|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300006178&quot; type=&quot;1&quot; lastDrawNo=&quot;11003&quot; barcode=&quot;15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqPe6vUSfVHjo=&quot; validationCode=&quot;384894&quot; multipleDraws=&quot;2&quot; totalBets=&quot;42&quot; totalAmount=&quot;2600.0&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot;/&gt;&lt;/Ticket&gt;):e15bc4fa766f9cc57713c2139bc352f8
[2015-05-29 17:13:17,468][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=672) succesfully.
[2015-05-29 17:13:17,468][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=672): &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300006178&quot; type=&quot;1&quot; lastDrawNo=&quot;11003&quot; barcode=&quot;15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqPe6vUSfVHjo=&quot; validationCode=&quot;384894&quot; multipleDraws=&quot;2&quot; totalBets=&quot;42&quot; totalAmount=&quot;2600.0&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:17,468][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:17,475][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:13:17,476][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.trans.domain.Transaction, mappingFile=xml-mapping/TransactionEnquiry_Req.xml).
[2015-05-29 17:13:17,476][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890797475|Timestamp:20150529171317|Transaction-Type:206|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Transaction terminalId=&quot;111&quot; traceMessageId=&quot;1432890796981&quot;/&gt;,hash=1857252755), get digest:6179888bd295eed04a4c63cb0a84452b
[2015-05-29 17:13:17,477][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=206).
[2015-05-29 17:13:17,477][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:17,477][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171317).
[2015-05-29 17:13:17,477][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:17,477][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890797475).
[2015-05-29 17:13:17,477][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:17,477][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:17,477][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=6179888bd295eed04a4c63cb0a84452b).
[2015-05-29 17:13:17,477][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=-1).
[2015-05-29 17:13:17,477][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:17,477][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:17,479][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6jcIE4b0pl+ogrA4SMNVUFtCb0VnctvqFZ4g+Dv1D5Fz4ERoX4gVmzFJ1yZK27DdH67dtfjT+JlQYT0Ff6Yaf4M=.
[2015-05-29 17:13:17,479][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890797475|Timestamp:20150529171317|Transaction-Type:206|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:17,479][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Transaction terminalId=&quot;111&quot; traceMessageId=&quot;1432890796981&quot;/&gt;
[2015-05-29 17:13:17,480][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890797475|Timestamp:20150529171317|Transaction-Type:206|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Transaction terminalId=&quot;111&quot; traceMessageId=&quot;1432890796981&quot;/&gt;,hash=1857252755), get digest:6179888bd295eed04a4c63cb0a84452b
[2015-05-29 17:13:17,480][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:13:17,480][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/TransactionEnquiry_Req.xml
[2015-05-29 17:13:17,480][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:13:17,493][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_206_1.5.0).
[2015-05-29 17:13:17,493][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_206_).
[2015-05-29 17:13:17,493][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(-1_206_), found controller(com.mpos.lottery.te.trans.TransactionController@53ddecd8) and method(public void com.mpos.lottery.te.trans.TransactionController.cancelByTrans(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:17,501][Test worker][DEBUG][ReversalOrCancelStrategyFactory] Found ReversalStrategy(class com.mpos.lottery.te.gameimpl.lfn.sale.service.LfnSaleService) to cancel transaction(gameType=15,terminalId=111,transType=200,protocolVersion=1.5.0).
[2015-05-29 17:13:17,519][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199997400, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=520]
[2015-05-29 17:13:17,520][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:17,520][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=520]
[2015-05-29 17:13:17,608][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.CANCEL.200.15]: origTrans {
  id: &quot;0115052900000000000751&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890796000
  trans_type: 200
  game_id: &quot;LFN-1&quot;
  game_type: 15
  total_amount: &quot;2600&quot;
}
cancelTrans {
  id: &quot;0115052900000000000798&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890797000
  trans_type: 206
  game_id: &quot;LFN-1&quot;
  game_type: 15
  total_amount: &quot;2600&quot;
}

[2015-05-29 17:13:17,609][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:17,609][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890797475|Timestamp:20150529171317|Transaction-Type:4206|Transaction-Id:0115052900000000000798|Response-Code:200|):3dec0da2953092e00e8c123945ff8b20
[2015-05-29 17:13:17,609][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=0): 
[2015-05-29 17:13:17,627][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:17,628][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:17,628][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@5d3031d9) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:17,628][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:17,628][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:17,628][Test worker][INFO ][BaseTransactionalIntegrationTest] | LfnSaleCancellationIntegrationTest.testCancelByTicket_Manually_OK                                                      |
[2015-05-29 17:13:17,628][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:17,629][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:17,630][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml).
[2015-05-29 17:13:17,630][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890797629|Timestamp:20150529171317|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;2600.0&quot; PIN=&quot;!!!!&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=-1580858389), get digest:5f48ccca2ba2f3d1b349a666aeaa4dfe
[2015-05-29 17:13:17,630][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=200).
[2015-05-29 17:13:17,630][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:17,630][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171317).
[2015-05-29 17:13:17,630][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:17,630][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890797629).
[2015-05-29 17:13:17,630][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:17,630][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:17,630][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=5f48ccca2ba2f3d1b349a666aeaa4dfe).
[2015-05-29 17:13:17,630][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:17,630][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:17,630][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:17,632][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6vvj1C28m6E+ybhcq2GHfncNCEmxnE1Ou0qcmJ+qutg9L2k05jXFbPjS1FsBBTLuWj4a8kJVsM72/YMzruGEM7DWPI5uQU+kvE7y74H12t4zbaRoUQTDb7n/h8zAxrh6Hn2mtyfU/CYtxKe3z/Py5RlIQZDC6AG8TrAvhb3G3SNDjlu4Vxm32uHjs7iClqnt2hDh9rhQSOHhB9K5LUL3NVo8dKwh6SCwM56BaXiK557zz5HaYz2004U1raT6OlReAP7pgHuknsbfxdYkwSI2v0wkzsQ/uHRPv01BVY1tFvgu1/1csAMYBq+O2tRLIhXeAoIJOVLJJPvPHAkozf5FsxcYBza1aivogG1+z8aPrO9uA0h0ScFgQ8LmCP5AX0mf6ruPkYWDcmUtW5ansd9eHP+N72iCfLshuhdBbTWGleRy.
[2015-05-29 17:13:17,632][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890797629|Timestamp:20150529171317|Transaction-Type:200|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:17,632][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;2600.0&quot; PIN=&quot;!!!!&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:17,633][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890797629|Timestamp:20150529171317|Transaction-Type:200|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket multipleDraws=&quot;2&quot; totalAmount=&quot;2600.0&quot; PIN=&quot;!!!!&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot; countOfQPNumber=&quot;0&quot;/&gt;&lt;/Ticket&gt;,hash=-1580858389), get digest:5f48ccca2ba2f3d1b349a666aeaa4dfe
[2015-05-29 17:13:17,633][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:17,633][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/SellTicket_Req.xml
[2015-05-29 17:13:17,633][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Req.xml) by key(15.transtype.200).
[2015-05-29 17:13:17,650][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_1.5.0).
[2015-05-29 17:13:17,650][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_200_).
[2015-05-29 17:13:17,650][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_200_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.sell(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:17,659][Test worker][DEBUG][BaseJpaDao] Query future game instance(class com.mpos.lottery.te.gameimpl.lfn.game.LfnGameInstance) by(number=11002,gameId=LFN-1, multipleDraws=2, state=1||2):1
[2015-05-29 17:13:17,665][Test worker][INFO ][AbstractGameInstanceService] No channel game instance time definiton found, ignore it.
[2015-05-29 17:13:17,665][Test worker][DEBUG][UUIDServiceImpl] Assemble a new ticket serial number:01111745519300006274
[2015-05-29 17:13:17,673][Test worker][DEBUG][DefaultTicketValidator] THe max allowed multi-draw of operation parameter is 10, merchant limit to 3, the smaller 3 will be used.
[2015-05-29 17:13:17,675][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMsAgiRUcbejq) as 80000
[2015-05-29 17:13:17,678][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMsAgiRUcbejq, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:17,679][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:17,679][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:17,686][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMsAgiRUcbejq) as 80000
[2015-05-29 17:13:17,688][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMsAgiRUcbejq, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:17,689][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:17,689][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:17,695][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:17,695][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:17,702][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:17,702][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:17,709][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:17,709][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:17,715][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:17,716][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:17,722][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:17,722][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:17,728][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:17,728][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:17,735][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:17,735][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:17,742][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:17,742][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:17,749][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:17,749][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:17,755][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:17,755][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:17,761][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:17,761][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:17,767][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:17,767][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:17,774][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:17,774][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:17,781][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:17,781][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:17,788][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:17,788][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:17,795][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:17,795][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:17,801][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:17,801][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:17,808][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:17,808][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:17,815][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:17,815][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:17,821][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMsAgiRUcbejq) as 80000
[2015-05-29 17:13:17,824][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMsAgiRUcbejq, selectNumber=5, betOption=1, totalBets=1, entryAmount=100.0]) is ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:17,824][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=50, prizelLevelType=1, bettingNumber=null]
[2015-05-29 17:13:17,824][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(5, amount=100.0) is 50
[2015-05-29 17:13:17,830][Test worker][DEBUG][AbstractRiskControlService] Determine the final risk control limit of ticket(y013eOifYgLRjcmw7N8vMsAgiRUcbejq) as 80000
[2015-05-29 17:13:17,832][Test worker][DEBUG][LfnRiskControlService] THe odds for given entry(BaseEntry [ticketSerialNo=y013eOifYgLRjcmw7N8vMsAgiRUcbejq, selectNumber=2,7,13,24,25,36, betOption=53, totalBets=20, entryAmount=1200.0]) is ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:17,832][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=null]
[2015-05-29 17:13:17,832][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,13, amount=60.00) is 30
[2015-05-29 17:13:17,839][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,13]
[2015-05-29 17:13:17,839][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,24, amount=60.00) is 30
[2015-05-29 17:13:17,845][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,24]
[2015-05-29 17:13:17,845][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,25, amount=60.00) is 30
[2015-05-29 17:13:17,851][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,25]
[2015-05-29 17:13:17,851][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,7,36, amount=60.00) is 30
[2015-05-29 17:13:17,858][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,7,36]
[2015-05-29 17:13:17,858][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,24, amount=60.00) is 30
[2015-05-29 17:13:17,864][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,24]
[2015-05-29 17:13:17,864][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,25, amount=60.00) is 30
[2015-05-29 17:13:17,871][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,25]
[2015-05-29 17:13:17,871][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,13,36, amount=60.00) is 30
[2015-05-29 17:13:17,878][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,13,36]
[2015-05-29 17:13:17,878][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,25, amount=60.00) is 30
[2015-05-29 17:13:17,884][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,25]
[2015-05-29 17:13:17,884][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,24,36, amount=60.00) is 30
[2015-05-29 17:13:17,894][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,24,36]
[2015-05-29 17:13:17,894][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(2,25,36, amount=60.00) is 30
[2015-05-29 17:13:17,901][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=2,25,36]
[2015-05-29 17:13:17,901][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,24, amount=60.00) is 30
[2015-05-29 17:13:17,908][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,24]
[2015-05-29 17:13:17,908][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,25, amount=60.00) is 30
[2015-05-29 17:13:17,915][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,25]
[2015-05-29 17:13:17,915][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,13,36, amount=60.00) is 30
[2015-05-29 17:13:17,922][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,13,36]
[2015-05-29 17:13:17,922][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,25, amount=60.00) is 30
[2015-05-29 17:13:17,928][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,25]
[2015-05-29 17:13:17,928][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,24,36, amount=60.00) is 30
[2015-05-29 17:13:17,942][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,24,36]
[2015-05-29 17:13:17,942][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(7,25,36, amount=60.00) is 30
[2015-05-29 17:13:17,950][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=7,25,36]
[2015-05-29 17:13:17,950][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,25, amount=60.00) is 30
[2015-05-29 17:13:17,958][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,25]
[2015-05-29 17:13:17,958][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,24,36, amount=60.00) is 30
[2015-05-29 17:13:17,964][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,24,36]
[2015-05-29 17:13:17,964][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(13,25,36, amount=60.00) is 30
[2015-05-29 17:13:17,971][Test worker][DEBUG][AbstractRiskControlService] Prepare to generate risk control log of ChanceOdds [odds=30, prizelLevelType=3, bettingNumber=13,25,36]
[2015-05-29 17:13:17,971][Test worker][DEBUG][AbstractRiskControlService] Determine the odds of betting number(24,25,36, amount=60.00) is 30
[2015-05-29 17:13:17,988][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:17,989][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:17,989][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199997400.0, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0]
[2015-05-29 17:13:18,005][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.200.15]: transaction {
  id: &quot;0115052900000000000799&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890797000
  trans_type: 200
  game_id: &quot;LFN-1&quot;
  game_type: 15
  total_amount: &quot;2600.0&quot;
}
multi_draw: 2
total_amount: &quot;2600.0&quot;
serial_no: &quot;y013eOifYgLRjcmw7N8vMsAgiRUcbejq&quot;
game_instance {
  id: &quot;GII-112&quot;
}
entries {
  selected_number: &quot;2,7,13,24,25,36&quot;
  bet_option: 53
  total_bets: 20
  entry_amount: &quot;1200.0&quot;
  input_channel: &quot;2&quot;
}
entries {
  selected_number: &quot;5&quot;
  bet_option: 1
  total_bets: 1
  entry_amount: &quot;100.0&quot;
  input_channel: &quot;2&quot;
}

[2015-05-29 17:13:18,005][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:18,006][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:18,006][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket),mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml
[2015-05-29 17:13:18,006][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:18,006][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/SellTicket_Res.xml).
[2015-05-29 17:13:18,007][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890797629|Timestamp:20150529171317|Transaction-Type:4200|Transaction-Id:0115052900000000000799|Response-Code:200|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300006274&quot; type=&quot;1&quot; lastDrawNo=&quot;11003&quot; barcode=&quot;15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqp3jkMGU9io4=&quot; validationCode=&quot;379301&quot; multipleDraws=&quot;2&quot; totalBets=&quot;42&quot; totalAmount=&quot;2600.0&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot;/&gt;&lt;/Ticket&gt;):f194fc6014df78bdb7d9d52a01f171d4
[2015-05-29 17:13:18,007][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=672) succesfully.
[2015-05-29 17:13:18,007][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=672): &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300006274&quot; type=&quot;1&quot; lastDrawNo=&quot;11003&quot; barcode=&quot;15cK/u9hwZY2Rogq4k24Oeg4G3HSlAl9EbjLdf+UJJlt9Se2CWmp8xavGhw4lusfIqp3jkMGU9io4=&quot; validationCode=&quot;379301&quot; multipleDraws=&quot;2&quot; totalBets=&quot;42&quot; totalAmount=&quot;2600.0&quot;&gt;&lt;GameDraw number=&quot;11002&quot; gameId=&quot;LFN-1&quot;/&gt;&lt;Entry selectedNumber=&quot;2,7,13,24,25,36&quot; betOption=&quot;53&quot; inputChannel=&quot;2&quot; entryAmount=&quot;1200.0&quot;/&gt;&lt;Entry selectedNumber=&quot;5&quot; betOption=&quot;1&quot; inputChannel=&quot;2&quot; entryAmount=&quot;100.0&quot;/&gt;&lt;/Ticket&gt;
[2015-05-29 17:13:18,008][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/SellTicket_Res.xml) by key(15.transtype.4200).
[2015-05-29 17:13:18,015][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.201).
[2015-05-29 17:13:18,015][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.gameimpl.lfn.sale.LfnTicket, mappingFile=xml-mapping/game/lfn/CancelTicket_Req.xml).
[2015-05-29 17:13:18,016][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890798015|Timestamp:20150529171318|Transaction-Type:201|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300006274&quot; isMannul=&quot;1&quot;/&gt;,hash=-1538966692), get digest:0037261234459af4df80b268d8f04f51
[2015-05-29 17:13:18,016][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=201).
[2015-05-29 17:13:18,016][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:18,016][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171318).
[2015-05-29 17:13:18,016][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:18,016][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890798015).
[2015-05-29 17:13:18,016][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:18,016][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:18,016][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=0037261234459af4df80b268d8f04f51).
[2015-05-29 17:13:18,016][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=15).
[2015-05-29 17:13:18,016][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:18,016][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:18,018][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6ttFDFcpmi1MamgAomcAmY77ZmH0pucSJt0uEHFSyYt5oRLN0x/EmapR1K6Ovqtf1LcI+7VrlMRo.
[2015-05-29 17:13:18,018][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890798015|Timestamp:20150529171318|Transaction-Type:201|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:18,018][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300006274&quot; isMannul=&quot;1&quot;/&gt;
[2015-05-29 17:13:18,018][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890798015|Timestamp:20150529171318|Transaction-Type:201|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Ticket serialNo=&quot;01111745519300006274&quot; isMannul=&quot;1&quot;/&gt;,hash=-1538966692), get digest:0037261234459af4df80b268d8f04f51
[2015-05-29 17:13:18,018][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.201).
[2015-05-29 17:13:18,018][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/game/lfn/CancelTicket_Req.xml
[2015-05-29 17:13:18,018][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/game/lfn/CancelTicket_Req.xml) by key(15.transtype.201).
[2015-05-29 17:13:18,035][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_201_1.5.0).
[2015-05-29 17:13:18,036][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(15_201_).
[2015-05-29 17:13:18,036][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(15_201_), found controller(com.mpos.lottery.te.gameimpl.lfn.LfnController@444e8ac1) and method(public void com.mpos.lottery.te.gameimpl.lfn.LfnController.cancelByTicket(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:18,043][Test worker][DEBUG][ReversalOrCancelStrategyFactory] Found ReversalStrategy(class com.mpos.lottery.te.gameimpl.lfn.sale.service.LfnSaleService) to cancel transaction(gameType=15,terminalId=111,transType=200,protocolVersion=1.5.0).
[2015-05-29 17:13:18,057][Test worker][DEBUG][DefaultBalanceService] Operator before transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199997400, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=520]
[2015-05-29 17:13:18,057][Test worker][DEBUG][DefaultBalanceService] Found balance strategy:com.mpos.lottery.te.merchant.service.balance.SaleBalanceStrategy@e1f8aba
[2015-05-29 17:13:18,057][Test worker][DEBUG][DefaultBalanceService] Operator after transaction -  Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=520]
[2015-05-29 17:13:18,130][Test worker][DEBUG][CommonFacadeService] Prepare to publish message to exchange[TE.200] with routing key[TE.CANCEL.200.15]: origTrans {
  id: &quot;0115052900000000000799&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890797000
  trans_type: 200
  game_id: &quot;LFN-1&quot;
  game_type: 15
  total_amount: &quot;2600&quot;
}
cancelTrans {
  id: &quot;0115052900000000000846&quot;
  dev_id: &quot;111&quot;
  operator_id: &quot;OPERATOR-111&quot;
  merchant_id: &quot;111&quot;
  create_time: 1432890798000
  trans_type: 210
  game_id: &quot;LFN-1&quot;
  game_type: 15
  total_amount: &quot;2600&quot;
}

[2015-05-29 17:13:18,130][Test worker][DEBUG][CommonFacadeService] Publish message successfully
[2015-05-29 17:13:18,130][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890798015|Timestamp:20150529171318|Transaction-Type:4201|Transaction-Id:0115052900000000000846|Response-Code:200|):b46a4f8712912fb2f8db8658f9721f2d
[2015-05-29 17:13:18,130][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=0): 
</pre>
</span>
</div>
</div>
<div id="footer">
<p>Generated by 
<a href="http://www.gradle.org">Gradle 2.2.1</a> at 2015-5-29 17:14:47</p>
</div>
</div>
</body>
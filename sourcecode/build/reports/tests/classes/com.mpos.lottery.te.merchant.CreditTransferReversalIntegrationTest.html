<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=edge"/>
<title>Test results - Class com.mpos.lottery.te.merchant.CreditTransferReversalIntegrationTest</title>
<link href="../css/base-style.css" rel="stylesheet" type="text/css"/>
<link href="../css/style.css" rel="stylesheet" type="text/css"/>
<script src="../js/report.js" type="text/javascript"></script>
</head>
<body>
<div id="content">
<h1>Class com.mpos.lottery.te.merchant.CreditTransferReversalIntegrationTest</h1>
<div class="breadcrumbs">
<a href="../index.html">all</a> &gt; 
<a href="../packages/com.mpos.lottery.te.merchant.html">com.mpos.lottery.te.merchant</a> &gt; CreditTransferReversalIntegrationTest</div>
<div id="summary">
<table>
<tr>
<td>
<div class="summaryGroup">
<table>
<tr>
<td>
<div class="infoBox" id="tests">
<div class="counter">4</div>
<p>tests</p>
</div>
</td>
<td>
<div class="infoBox" id="failures">
<div class="counter">0</div>
<p>failures</p>
</div>
</td>
<td>
<div class="infoBox" id="ignored">
<div class="counter">0</div>
<p>ignored</p>
</div>
</td>
<td>
<div class="infoBox" id="duration">
<div class="counter">0.838s</div>
<p>duration</p>
</div>
</td>
</tr>
</table>
</div>
</td>
<td>
<div class="infoBox success" id="successRate">
<div class="percent">100%</div>
<p>successful</p>
</div>
</td>
</tr>
</table>
</div>
<div id="tabs">
<ul class="tabLinks">
<li>
<a href="#tab0">Tests</a>
</li>
<li>
<a href="#tab1">Standard output</a>
</li>
</ul>
<div id="tab0" class="tab">
<h2>Tests</h2>
<table>
<thead>
<tr>
<th>Test</th>
<th>Duration</th>
<th>Result</th>
</tr>
</thead>
<tr>
<td class="success">testTransferPayoutCredit_Operator</td>
<td>0.195s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testTransferPayoutCredit_Operator_UseParent</td>
<td>0.219s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testTransferSaleCredit_Operator</td>
<td>0.207s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">testTransferSaleCredit_Operator_UseParent</td>
<td>0.217s</td>
<td class="success">passed</td>
</tr>
</table>
</div>
<div id="tab1" class="tab">
<h2>Standard output</h2>
<span class="code">
<pre>[2015-05-29 17:13:51,978][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:51,978][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:51,978][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@26fb058f) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:51,979][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:51,979][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:51,979][Test worker][INFO ][BaseTransactionalIntegrationTest] | CreditTransferReversalIntegrationTest.testTransferSaleCredit_Operator                                                  |
[2015-05-29 17:13:51,979][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:51,992][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Req.xml) by key(transtype.116).
[2015-05-29 17:13:51,993][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.merchant.web.CreditTransferDto, mappingFile=xml-mapping/CreditTransfer_Req.xml).
[2015-05-29 17:13:51,993][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890831992|Timestamp:20150529171351|Transaction-Type:116|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Credit fromOperatorLoginName=&quot;OPERATOR-LOGIN&quot; toOperatorLoginName=&quot;OPERATOR-LOGIN-2&quot; creditType=&quot;1&quot; amount=&quot;500&quot;/&gt;,hash=1826293698), get digest:42e77b46627f375c8259ed2df45f2fc6
[2015-05-29 17:13:51,993][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=116).
[2015-05-29 17:13:51,994][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:51,994][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171351).
[2015-05-29 17:13:51,994][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:51,994][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890831992).
[2015-05-29 17:13:51,994][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:51,994][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:51,994][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=42e77b46627f375c8259ed2df45f2fc6).
[2015-05-29 17:13:51,994][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=-1).
[2015-05-29 17:13:51,994][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:51,994][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:51,997][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6jI0L4oIzAEMqe8dW26na21aa7l/DnYGq8bZRRkB06JgU5/TnyrZTOdC6oRNKAEruaE9CNHiEKOUi68bC2ifMqYBvdT5GJTz2D1nD1zh192sAlBYcIWAsPPERGNlmKgbrl+Gn2aAxgnNt95rYs7lGgeHrsfqAQxd0w==.
[2015-05-29 17:13:51,997][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890831992|Timestamp:20150529171351|Transaction-Type:116|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:51,998][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Credit fromOperatorLoginName=&quot;OPERATOR-LOGIN&quot; toOperatorLoginName=&quot;OPERATOR-LOGIN-2&quot; creditType=&quot;1&quot; amount=&quot;500&quot;/&gt;
[2015-05-29 17:13:51,998][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890831992|Timestamp:20150529171351|Transaction-Type:116|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Credit fromOperatorLoginName=&quot;OPERATOR-LOGIN&quot; toOperatorLoginName=&quot;OPERATOR-LOGIN-2&quot; creditType=&quot;1&quot; amount=&quot;500&quot;/&gt;,hash=1826293698), get digest:42e77b46627f375c8259ed2df45f2fc6
[2015-05-29 17:13:51,998][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Req.xml) by key(transtype.116).
[2015-05-29 17:13:51,998][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/CreditTransfer_Req.xml
[2015-05-29 17:13:51,998][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Req.xml) by key(transtype.116).
[2015-05-29 17:13:52,018][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_116_1.5.0).
[2015-05-29 17:13:52,018][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_116_).
[2015-05-29 17:13:52,018][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(-1_116_), found controller(com.mpos.lottery.te.merchant.MerchantController@720798ee) and method(public void com.mpos.lottery.te.merchant.MerchantController.transferCredit(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:52,043][Test worker][DEBUG][DefaultCreditService] The current credit level(before transaction) of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0] is saleCreditLevel:200000000,payoutCreditLevel:1000
[2015-05-29 17:13:52,043][Test worker][DEBUG][DefaultCreditService] The new sale credit level of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199999500, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0] is 199999500
[2015-05-29 17:13:52,046][Test worker][DEBUG][DefaultCreditService] The current credit level(before transaction) of Operator [id=OPERATOR-112, loginName=OPERATOR-LOGIN-2, creditType=1, saleCreditLevel=2000, payoutCreditLevel=2000, cashoutBalance=0, commisionBalance=0] is saleCreditLevel:2000,payoutCreditLevel:2000
[2015-05-29 17:13:52,046][Test worker][DEBUG][DefaultCreditService] The new sale credit level of Operator [id=OPERATOR-112, loginName=OPERATOR-LOGIN-2, creditType=1, saleCreditLevel=2500, payoutCreditLevel=2000, cashoutBalance=0, commisionBalance=0] is 2500
[2015-05-29 17:13:52,065][Test worker][DEBUG][CommonFacadeService] No need to publish AMQP message of transaction(TRANSFER_CREDIT)
[2015-05-29 17:13:52,065][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Res.xml) by key(transtype.4116).
[2015-05-29 17:13:52,065][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.merchant.web.CreditTransferDto),mappingFile=xml-mapping/CreditTransfer_Res.xml
[2015-05-29 17:13:52,065][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Res.xml) by key(transtype.4116).
[2015-05-29 17:13:52,066][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.merchant.web.CreditTransferDto, mappingFile=xml-mapping/CreditTransfer_Res.xml).
[2015-05-29 17:13:52,066][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890831992|Timestamp:20150529171351|Transaction-Type:4116|Transaction-Id:0115052900000000002326|Response-Code:200|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Credit creditType=&quot;1&quot; amount=&quot;500&quot; creditBalanceOfFromOperator=&quot;199999500&quot; creditBalanceOfToOperator=&quot;2500&quot;/&gt;):19c3dfd39165a09965a21a55f365da50
[2015-05-29 17:13:52,066][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=204) succesfully.
[2015-05-29 17:13:52,067][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=204): &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Credit creditType=&quot;1&quot; amount=&quot;500&quot; creditBalanceOfFromOperator=&quot;199999500&quot; creditBalanceOfToOperator=&quot;2500&quot;/&gt;
[2015-05-29 17:13:52,067][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Res.xml) by key(transtype.4116).
[2015-05-29 17:13:52,069][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:13:52,070][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.trans.domain.Transaction, mappingFile=xml-mapping/TransactionEnquiry_Req.xml).
[2015-05-29 17:13:52,070][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832069|Timestamp:20150529171352|Transaction-Type:206|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Transaction terminalId=&quot;111&quot; traceMessageId=&quot;1432890831992&quot;/&gt;,hash=-280123475), get digest:ad2ca387d522c0a631497b33bbce0b4c
[2015-05-29 17:13:52,070][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=206).
[2015-05-29 17:13:52,070][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:52,070][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171352).
[2015-05-29 17:13:52,070][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:52,070][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890832069).
[2015-05-29 17:13:52,070][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:52,070][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:52,070][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=ad2ca387d522c0a631497b33bbce0b4c).
[2015-05-29 17:13:52,070][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=-1).
[2015-05-29 17:13:52,070][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:52,070][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:52,073][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6jcIE4b0pl+ogrA4SMNVUFtCb0VnctvqFZ4g+Dv1D5Fz4ERoX4gVmzFJ1yZK27DdH6fnlDSzm9kJctoIKGM5RhA=.
[2015-05-29 17:13:52,073][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832069|Timestamp:20150529171352|Transaction-Type:206|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:52,073][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Transaction terminalId=&quot;111&quot; traceMessageId=&quot;1432890831992&quot;/&gt;
[2015-05-29 17:13:52,073][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832069|Timestamp:20150529171352|Transaction-Type:206|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Transaction terminalId=&quot;111&quot; traceMessageId=&quot;1432890831992&quot;/&gt;,hash=-280123475), get digest:ad2ca387d522c0a631497b33bbce0b4c
[2015-05-29 17:13:52,074][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:13:52,074][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/TransactionEnquiry_Req.xml
[2015-05-29 17:13:52,074][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:13:52,091][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_206_1.5.0).
[2015-05-29 17:13:52,091][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_206_).
[2015-05-29 17:13:52,091][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(-1_206_), found controller(com.mpos.lottery.te.trans.TransactionController@53ddecd8) and method(public void com.mpos.lottery.te.trans.TransactionController.cancelByTrans(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:52,099][Test worker][DEBUG][ReversalOrCancelStrategyFactory] Found ReversalStrategy(class com.mpos.lottery.te.merchant.service.impl.DefaultCreditService) to cancel transaction(gameType=-1,terminalId=111,transType=116,protocolVersion=1.5.0).
[2015-05-29 17:13:52,128][Test worker][DEBUG][DefaultCreditService] The current credit level(before transaction) of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=199999500, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0] is saleCreditLevel:199999500,payoutCreditLevel:1000
[2015-05-29 17:13:52,128][Test worker][DEBUG][DefaultCreditService] The new sale credit level of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0] is 200000000
[2015-05-29 17:13:52,134][Test worker][DEBUG][DefaultCreditService] The current credit level(before transaction) of Operator [id=OPERATOR-112, loginName=OPERATOR-LOGIN-2, creditType=1, saleCreditLevel=2500, payoutCreditLevel=2000, cashoutBalance=0, commisionBalance=0] is saleCreditLevel:2500,payoutCreditLevel:2000
[2015-05-29 17:13:52,134][Test worker][DEBUG][DefaultCreditService] The new sale credit level of Operator [id=OPERATOR-112, loginName=OPERATOR-LOGIN-2, creditType=1, saleCreditLevel=2000, payoutCreditLevel=2000, cashoutBalance=0, commisionBalance=0] is 2000
[2015-05-29 17:13:52,149][Test worker][DEBUG][TransactionServiceImpl] No need to publish cancellation for target transaction(type=116,id=0115052900000000002326).
[2015-05-29 17:13:52,163][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832069|Timestamp:20150529171352|Transaction-Type:4206|Transaction-Id:0115052900000000002328|Response-Code:200|):2bb4c678d61ff1f780fc6464bf8cf69d
[2015-05-29 17:13:52,163][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=0): 
[2015-05-29 17:13:52,182][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:52,182][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:52,182][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@33fc9e9c) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:52,183][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:52,183][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:52,183][Test worker][INFO ][BaseTransactionalIntegrationTest] | CreditTransferReversalIntegrationTest.testTransferPayoutCredit_Operator                                                |
[2015-05-29 17:13:52,183][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:52,193][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Req.xml) by key(transtype.116).
[2015-05-29 17:13:52,194][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.merchant.web.CreditTransferDto, mappingFile=xml-mapping/CreditTransfer_Req.xml).
[2015-05-29 17:13:52,194][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832193|Timestamp:20150529171352|Transaction-Type:116|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Credit fromOperatorLoginName=&quot;OPERATOR-LOGIN&quot; toOperatorLoginName=&quot;OPERATOR-LOGIN-2&quot; creditType=&quot;2&quot; amount=&quot;500&quot;/&gt;,hash=815806970), get digest:c67716bc64ce2d3b86340d7a98a3fc43
[2015-05-29 17:13:52,194][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=116).
[2015-05-29 17:13:52,194][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:52,194][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171352).
[2015-05-29 17:13:52,194][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:52,194][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890832193).
[2015-05-29 17:13:52,194][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:52,194][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:52,194][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=c67716bc64ce2d3b86340d7a98a3fc43).
[2015-05-29 17:13:52,194][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=-1).
[2015-05-29 17:13:52,195][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:52,195][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:52,196][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6jI0L4oIzAEMqe8dW26na21aa7l/DnYGq8bZRRkB06JgU5/TnyrZTOdC6oRNKAEruaE9CNHiEKOUi68bC2ifMqYBvdT5GJTz2D1nD1zh192sAlBYcIWAsPPERGNlmKgbrpg3TIB59e3Nw3iZGggse3On7wcdABSriw==.
[2015-05-29 17:13:52,196][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832193|Timestamp:20150529171352|Transaction-Type:116|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:52,197][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Credit fromOperatorLoginName=&quot;OPERATOR-LOGIN&quot; toOperatorLoginName=&quot;OPERATOR-LOGIN-2&quot; creditType=&quot;2&quot; amount=&quot;500&quot;/&gt;
[2015-05-29 17:13:52,197][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832193|Timestamp:20150529171352|Transaction-Type:116|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Credit fromOperatorLoginName=&quot;OPERATOR-LOGIN&quot; toOperatorLoginName=&quot;OPERATOR-LOGIN-2&quot; creditType=&quot;2&quot; amount=&quot;500&quot;/&gt;,hash=815806970), get digest:c67716bc64ce2d3b86340d7a98a3fc43
[2015-05-29 17:13:52,197][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Req.xml) by key(transtype.116).
[2015-05-29 17:13:52,197][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/CreditTransfer_Req.xml
[2015-05-29 17:13:52,197][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Req.xml) by key(transtype.116).
[2015-05-29 17:13:52,211][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_116_1.5.0).
[2015-05-29 17:13:52,211][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_116_).
[2015-05-29 17:13:52,211][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(-1_116_), found controller(com.mpos.lottery.te.merchant.MerchantController@720798ee) and method(public void com.mpos.lottery.te.merchant.MerchantController.transferCredit(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:52,240][Test worker][DEBUG][DefaultCreditService] The current credit level(before transaction) of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0] is saleCreditLevel:200000000,payoutCreditLevel:1000
[2015-05-29 17:13:52,240][Test worker][DEBUG][DefaultCreditService] The new payout credit level of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=500, cashoutBalance=0, commisionBalance=0] is 500
[2015-05-29 17:13:52,243][Test worker][DEBUG][DefaultCreditService] The current credit level(before transaction) of Operator [id=OPERATOR-112, loginName=OPERATOR-LOGIN-2, creditType=1, saleCreditLevel=2000, payoutCreditLevel=2000, cashoutBalance=0, commisionBalance=0] is saleCreditLevel:2000,payoutCreditLevel:2000
[2015-05-29 17:13:52,243][Test worker][DEBUG][DefaultCreditService] The new payout credit level of Operator [id=OPERATOR-112, loginName=OPERATOR-LOGIN-2, creditType=1, saleCreditLevel=2000, payoutCreditLevel=2500, cashoutBalance=0, commisionBalance=0] is 2500
[2015-05-29 17:13:52,262][Test worker][DEBUG][CommonFacadeService] No need to publish AMQP message of transaction(TRANSFER_CREDIT)
[2015-05-29 17:13:52,262][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Res.xml) by key(transtype.4116).
[2015-05-29 17:13:52,262][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.merchant.web.CreditTransferDto),mappingFile=xml-mapping/CreditTransfer_Res.xml
[2015-05-29 17:13:52,262][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Res.xml) by key(transtype.4116).
[2015-05-29 17:13:52,264][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.merchant.web.CreditTransferDto, mappingFile=xml-mapping/CreditTransfer_Res.xml).
[2015-05-29 17:13:52,264][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832193|Timestamp:20150529171352|Transaction-Type:4116|Transaction-Id:0115052900000000002329|Response-Code:200|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Credit creditType=&quot;2&quot; amount=&quot;500&quot; creditBalanceOfFromOperator=&quot;500&quot; creditBalanceOfToOperator=&quot;2500&quot;/&gt;):fcee2787281e1ff2a2204a5fc4e49b9b
[2015-05-29 17:13:52,264][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=192) succesfully.
[2015-05-29 17:13:52,265][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=192): &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Credit creditType=&quot;2&quot; amount=&quot;500&quot; creditBalanceOfFromOperator=&quot;500&quot; creditBalanceOfToOperator=&quot;2500&quot;/&gt;
[2015-05-29 17:13:52,265][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Res.xml) by key(transtype.4116).
[2015-05-29 17:13:52,267][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:13:52,267][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.trans.domain.Transaction, mappingFile=xml-mapping/TransactionEnquiry_Req.xml).
[2015-05-29 17:13:52,268][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832267|Timestamp:20150529171352|Transaction-Type:206|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Transaction terminalId=&quot;111&quot; traceMessageId=&quot;1432890832193&quot;/&gt;,hash=-1442096427), get digest:c5d7101c0ea8ef570a42310dec18f2db
[2015-05-29 17:13:52,268][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=206).
[2015-05-29 17:13:52,268][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:52,268][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171352).
[2015-05-29 17:13:52,268][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:52,268][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890832267).
[2015-05-29 17:13:52,268][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:52,268][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:52,268][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=c5d7101c0ea8ef570a42310dec18f2db).
[2015-05-29 17:13:52,268][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=-1).
[2015-05-29 17:13:52,268][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:52,268][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:52,271][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6jcIE4b0pl+ogrA4SMNVUFtCb0VnctvqFZ4g+Dv1D5Fz4ERoX4gVmzFJ1yZK27DdH4SnK1T362X7Xl3AvZiEbPA=.
[2015-05-29 17:13:52,271][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832267|Timestamp:20150529171352|Transaction-Type:206|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:52,272][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Transaction terminalId=&quot;111&quot; traceMessageId=&quot;1432890832193&quot;/&gt;
[2015-05-29 17:13:52,272][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832267|Timestamp:20150529171352|Transaction-Type:206|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Transaction terminalId=&quot;111&quot; traceMessageId=&quot;1432890832193&quot;/&gt;,hash=-1442096427), get digest:c5d7101c0ea8ef570a42310dec18f2db
[2015-05-29 17:13:52,272][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:13:52,272][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/TransactionEnquiry_Req.xml
[2015-05-29 17:13:52,272][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:13:52,294][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_206_1.5.0).
[2015-05-29 17:13:52,294][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_206_).
[2015-05-29 17:13:52,294][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(-1_206_), found controller(com.mpos.lottery.te.trans.TransactionController@53ddecd8) and method(public void com.mpos.lottery.te.trans.TransactionController.cancelByTrans(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:52,304][Test worker][DEBUG][ReversalOrCancelStrategyFactory] Found ReversalStrategy(class com.mpos.lottery.te.merchant.service.impl.DefaultCreditService) to cancel transaction(gameType=-1,terminalId=111,transType=116,protocolVersion=1.5.0).
[2015-05-29 17:13:52,334][Test worker][DEBUG][DefaultCreditService] The current credit level(before transaction) of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=500, cashoutBalance=0, commisionBalance=0] is saleCreditLevel:200000000,payoutCreditLevel:500
[2015-05-29 17:13:52,334][Test worker][DEBUG][DefaultCreditService] The new payout credit level of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=1, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0] is 1000
[2015-05-29 17:13:52,339][Test worker][DEBUG][DefaultCreditService] The current credit level(before transaction) of Operator [id=OPERATOR-112, loginName=OPERATOR-LOGIN-2, creditType=1, saleCreditLevel=2000, payoutCreditLevel=2500, cashoutBalance=0, commisionBalance=0] is saleCreditLevel:2000,payoutCreditLevel:2500
[2015-05-29 17:13:52,339][Test worker][DEBUG][DefaultCreditService] The new payout credit level of Operator [id=OPERATOR-112, loginName=OPERATOR-LOGIN-2, creditType=1, saleCreditLevel=2000, payoutCreditLevel=2000, cashoutBalance=0, commisionBalance=0] is 2000
[2015-05-29 17:13:52,351][Test worker][DEBUG][TransactionServiceImpl] No need to publish cancellation for target transaction(type=116,id=0115052900000000002329).
[2015-05-29 17:13:52,364][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832267|Timestamp:20150529171352|Transaction-Type:4206|Transaction-Id:0115052900000000002331|Response-Code:200|):c79d996f6c0d87ef7c91d58eb1996d30
[2015-05-29 17:13:52,364][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=0): 
[2015-05-29 17:13:52,376][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:52,376][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:52,376][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@2d597c21) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:52,377][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:52,377][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:52,377][Test worker][INFO ][BaseTransactionalIntegrationTest] | CreditTransferReversalIntegrationTest.testTransferPayoutCredit_Operator_UseParent                                      |
[2015-05-29 17:13:52,377][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:52,392][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Req.xml) by key(transtype.116).
[2015-05-29 17:13:52,393][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.merchant.web.CreditTransferDto, mappingFile=xml-mapping/CreditTransfer_Req.xml).
[2015-05-29 17:13:52,393][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832392|Timestamp:20150529171352|Transaction-Type:116|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Credit fromOperatorLoginName=&quot;OPERATOR-LOGIN&quot; toOperatorLoginName=&quot;OPERATOR-LOGIN-2&quot; creditType=&quot;2&quot; amount=&quot;500&quot;/&gt;,hash=-469412741), get digest:c12f83741e16c5549d8196ebe2bef83c
[2015-05-29 17:13:52,394][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=116).
[2015-05-29 17:13:52,394][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:52,394][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171352).
[2015-05-29 17:13:52,394][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:52,394][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890832392).
[2015-05-29 17:13:52,394][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:52,394][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:52,394][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=c12f83741e16c5549d8196ebe2bef83c).
[2015-05-29 17:13:52,394][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=-1).
[2015-05-29 17:13:52,394][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:52,394][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:52,397][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6jI0L4oIzAEMqe8dW26na21aa7l/DnYGq8bZRRkB06JgU5/TnyrZTOdC6oRNKAEruaE9CNHiEKOUi68bC2ifMqYBvdT5GJTz2D1nD1zh192sAlBYcIWAsPPERGNlmKgbrpg3TIB59e3Nw3iZGggse3On7wcdABSriw==.
[2015-05-29 17:13:52,397][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832392|Timestamp:20150529171352|Transaction-Type:116|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:52,397][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Credit fromOperatorLoginName=&quot;OPERATOR-LOGIN&quot; toOperatorLoginName=&quot;OPERATOR-LOGIN-2&quot; creditType=&quot;2&quot; amount=&quot;500&quot;/&gt;
[2015-05-29 17:13:52,398][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832392|Timestamp:20150529171352|Transaction-Type:116|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Credit fromOperatorLoginName=&quot;OPERATOR-LOGIN&quot; toOperatorLoginName=&quot;OPERATOR-LOGIN-2&quot; creditType=&quot;2&quot; amount=&quot;500&quot;/&gt;,hash=-469412741), get digest:c12f83741e16c5549d8196ebe2bef83c
[2015-05-29 17:13:52,398][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Req.xml) by key(transtype.116).
[2015-05-29 17:13:52,398][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/CreditTransfer_Req.xml
[2015-05-29 17:13:52,398][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Req.xml) by key(transtype.116).
[2015-05-29 17:13:52,417][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_116_1.5.0).
[2015-05-29 17:13:52,417][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_116_).
[2015-05-29 17:13:52,417][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(-1_116_), found controller(com.mpos.lottery.te.merchant.MerchantController@720798ee) and method(public void com.mpos.lottery.te.merchant.MerchantController.transferCredit(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:52,441][Test worker][DEBUG][DefaultCreditService] Ignore credit level calculation, as the credit type of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=4, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0] is USE PARENT... check its parent merchant
[2015-05-29 17:13:52,446][Test worker][DEBUG][DefaultCreditService] The current credit level(before transaction) of Merchant [id=111, name=M-111, saleCreditLevel=100000000, payoutCreditLevel=1000, creditType=1, cashoutBalance=0, commisionBalance=0] is saleCreditLevel:100000000,payoutCreditLevel:1000
[2015-05-29 17:13:52,446][Test worker][DEBUG][DefaultCreditService] The new payout credit level of merchantMerchant [id=111, name=M-111, saleCreditLevel=100000000, payoutCreditLevel=500, creditType=1, cashoutBalance=0, commisionBalance=0] is 500
[2015-05-29 17:13:52,446][Test worker][DEBUG][DefaultCreditService] Ignore credit level calculation, as the credit type of Operator [id=OPERATOR-112, loginName=OPERATOR-LOGIN-2, creditType=4, saleCreditLevel=2000, payoutCreditLevel=2000, cashoutBalance=0, commisionBalance=0] is USE PARENT... check its parent merchant
[2015-05-29 17:13:52,455][Test worker][DEBUG][DefaultCreditService] The current credit level(before transaction) of Merchant [id=112, name=M-112, saleCreditLevel=110000000, payoutCreditLevel=1000, creditType=1, cashoutBalance=0, commisionBalance=0] is saleCreditLevel:110000000,payoutCreditLevel:1000
[2015-05-29 17:13:52,455][Test worker][DEBUG][DefaultCreditService] The new payout credit level of merchantMerchant [id=112, name=M-112, saleCreditLevel=110000000, payoutCreditLevel=1500, creditType=1, cashoutBalance=0, commisionBalance=0] is 1500
[2015-05-29 17:13:52,474][Test worker][DEBUG][CommonFacadeService] No need to publish AMQP message of transaction(TRANSFER_CREDIT)
[2015-05-29 17:13:52,474][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Res.xml) by key(transtype.4116).
[2015-05-29 17:13:52,474][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.merchant.web.CreditTransferDto),mappingFile=xml-mapping/CreditTransfer_Res.xml
[2015-05-29 17:13:52,474][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Res.xml) by key(transtype.4116).
[2015-05-29 17:13:52,475][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.merchant.web.CreditTransferDto, mappingFile=xml-mapping/CreditTransfer_Res.xml).
[2015-05-29 17:13:52,475][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832392|Timestamp:20150529171352|Transaction-Type:4116|Transaction-Id:0115052900000000002332|Response-Code:200|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Credit creditType=&quot;2&quot; amount=&quot;500&quot; creditBalanceOfFromOperator=&quot;500&quot; creditBalanceOfToOperator=&quot;1500&quot;/&gt;):828d69329df72230b71b1593690c3462
[2015-05-29 17:13:52,476][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=192) succesfully.
[2015-05-29 17:13:52,476][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=192): &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Credit creditType=&quot;2&quot; amount=&quot;500&quot; creditBalanceOfFromOperator=&quot;500&quot; creditBalanceOfToOperator=&quot;1500&quot;/&gt;
[2015-05-29 17:13:52,476][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Res.xml) by key(transtype.4116).
[2015-05-29 17:13:52,478][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:13:52,478][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.trans.domain.Transaction, mappingFile=xml-mapping/TransactionEnquiry_Req.xml).
[2015-05-29 17:13:52,479][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832478|Timestamp:20150529171352|Transaction-Type:206|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Transaction terminalId=&quot;111&quot; traceMessageId=&quot;1432890832392&quot;/&gt;,hash=529465554), get digest:84e75ff8f9df13e10a876d0b01f33b9f
[2015-05-29 17:13:52,479][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=206).
[2015-05-29 17:13:52,479][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:52,479][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171352).
[2015-05-29 17:13:52,479][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:52,479][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890832478).
[2015-05-29 17:13:52,479][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:52,479][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:52,479][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=84e75ff8f9df13e10a876d0b01f33b9f).
[2015-05-29 17:13:52,479][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=-1).
[2015-05-29 17:13:52,479][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:52,479][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:52,481][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6jcIE4b0pl+ogrA4SMNVUFtCb0VnctvqFZ4g+Dv1D5Fz4ERoX4gVmzFJ1yZK27DdHzDu/bPmSoIzb5gqMtcmZOQ=.
[2015-05-29 17:13:52,481][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832478|Timestamp:20150529171352|Transaction-Type:206|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:52,481][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Transaction terminalId=&quot;111&quot; traceMessageId=&quot;1432890832392&quot;/&gt;
[2015-05-29 17:13:52,481][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832478|Timestamp:20150529171352|Transaction-Type:206|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Transaction terminalId=&quot;111&quot; traceMessageId=&quot;1432890832392&quot;/&gt;,hash=529465554), get digest:84e75ff8f9df13e10a876d0b01f33b9f
[2015-05-29 17:13:52,481][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:13:52,481][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/TransactionEnquiry_Req.xml
[2015-05-29 17:13:52,481][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:13:52,501][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_206_1.5.0).
[2015-05-29 17:13:52,501][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_206_).
[2015-05-29 17:13:52,501][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(-1_206_), found controller(com.mpos.lottery.te.trans.TransactionController@53ddecd8) and method(public void com.mpos.lottery.te.trans.TransactionController.cancelByTrans(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:52,511][Test worker][DEBUG][ReversalOrCancelStrategyFactory] Found ReversalStrategy(class com.mpos.lottery.te.merchant.service.impl.DefaultCreditService) to cancel transaction(gameType=-1,terminalId=111,transType=116,protocolVersion=1.5.0).
[2015-05-29 17:13:52,541][Test worker][DEBUG][DefaultCreditService] Ignore credit level calculation, as the credit type of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=4, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0] is USE PARENT... check its parent merchant
[2015-05-29 17:13:52,547][Test worker][DEBUG][DefaultCreditService] The current credit level(before transaction) of Merchant [id=111, name=M-111, saleCreditLevel=100000000, payoutCreditLevel=500, creditType=1, cashoutBalance=0, commisionBalance=0] is saleCreditLevel:100000000,payoutCreditLevel:500
[2015-05-29 17:13:52,547][Test worker][DEBUG][DefaultCreditService] The new payout credit level of merchantMerchant [id=111, name=M-111, saleCreditLevel=100000000, payoutCreditLevel=1000, creditType=1, cashoutBalance=0, commisionBalance=0] is 1000
[2015-05-29 17:13:52,547][Test worker][DEBUG][DefaultCreditService] Ignore credit level calculation, as the credit type of Operator [id=OPERATOR-112, loginName=OPERATOR-LOGIN-2, creditType=4, saleCreditLevel=2000, payoutCreditLevel=2000, cashoutBalance=0, commisionBalance=0] is USE PARENT... check its parent merchant
[2015-05-29 17:13:52,556][Test worker][DEBUG][DefaultCreditService] The current credit level(before transaction) of Merchant [id=112, name=M-112, saleCreditLevel=110000000, payoutCreditLevel=1500, creditType=1, cashoutBalance=0, commisionBalance=0] is saleCreditLevel:110000000,payoutCreditLevel:1500
[2015-05-29 17:13:52,556][Test worker][DEBUG][DefaultCreditService] The new payout credit level of merchantMerchant [id=112, name=M-112, saleCreditLevel=110000000, payoutCreditLevel=1000, creditType=1, cashoutBalance=0, commisionBalance=0] is 1000
[2015-05-29 17:13:52,570][Test worker][DEBUG][TransactionServiceImpl] No need to publish cancellation for target transaction(type=116,id=0115052900000000002332).
[2015-05-29 17:13:52,584][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832478|Timestamp:20150529171352|Transaction-Type:4206|Transaction-Id:0115052900000000002334|Response-Code:200|):e46a6c9e88131d7f537f7b84643152ee
[2015-05-29 17:13:52,584][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=0): 
[2015-05-29 17:13:52,597][Test worker][DEBUG][TEPortServlet] Startup job scheduer(org.quartz.impl.StdScheduler@4d1e5820) successfully.
[2015-05-29 17:13:52,597][Test worker][WARN ][TEPortServlet] can NOT find META file:F:\project\M.Lottery\TE\TRUNK_TE\sourcecode\build\classes\main\META-INF\MANIFEST.MF
[2015-05-29 17:13:52,597][Test worker][DEBUG][TEPortServlet] Register MBean(com.mpos.lottery.te.common.jmx.TransactionTimeout@6a78a53e) with name(com.mpos.lottery.te:type=TransactionTimeoutMBean) successfully.
[2015-05-29 17:13:52,598][Test worker][DEBUG][BaseTransactionalIntegrationTest] Retrieve a ApplicationContext(org.springframework.web.context.support.GenericWebApplicationContext@34f645a8: startup date [Fri May 29 17:12:38 CST 2015]; root of context hierarchy).
[2015-05-29 17:13:52,598][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:52,598][Test worker][INFO ][BaseTransactionalIntegrationTest] | CreditTransferReversalIntegrationTest.testTransferSaleCredit_Operator_UseParent                                        |
[2015-05-29 17:13:52,598][Test worker][INFO ][BaseTransactionalIntegrationTest] +------------------------------------------------------------------------------------------------------------------------+
[2015-05-29 17:13:52,608][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Req.xml) by key(transtype.116).
[2015-05-29 17:13:52,609][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.merchant.web.CreditTransferDto, mappingFile=xml-mapping/CreditTransfer_Req.xml).
[2015-05-29 17:13:52,609][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832608|Timestamp:20150529171352|Transaction-Type:116|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Credit fromOperatorLoginName=&quot;OPERATOR-LOGIN&quot; toOperatorLoginName=&quot;OPERATOR-LOGIN-2&quot; creditType=&quot;1&quot; amount=&quot;500&quot;/&gt;,hash=1837250220), get digest:d128b20c63e44e838d8a2523e85b9baa
[2015-05-29 17:13:52,610][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=116).
[2015-05-29 17:13:52,610][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:52,610][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171352).
[2015-05-29 17:13:52,610][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:52,610][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890832608).
[2015-05-29 17:13:52,610][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:52,610][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:52,610][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=d128b20c63e44e838d8a2523e85b9baa).
[2015-05-29 17:13:52,610][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=-1).
[2015-05-29 17:13:52,610][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:52,610][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:52,612][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6jI0L4oIzAEMqe8dW26na21aa7l/DnYGq8bZRRkB06JgU5/TnyrZTOdC6oRNKAEruaE9CNHiEKOUi68bC2ifMqYBvdT5GJTz2D1nD1zh192sAlBYcIWAsPPERGNlmKgbrl+Gn2aAxgnNt95rYs7lGgeHrsfqAQxd0w==.
[2015-05-29 17:13:52,612][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832608|Timestamp:20150529171352|Transaction-Type:116|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:52,613][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Credit fromOperatorLoginName=&quot;OPERATOR-LOGIN&quot; toOperatorLoginName=&quot;OPERATOR-LOGIN-2&quot; creditType=&quot;1&quot; amount=&quot;500&quot;/&gt;
[2015-05-29 17:13:52,613][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832608|Timestamp:20150529171352|Transaction-Type:116|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Credit fromOperatorLoginName=&quot;OPERATOR-LOGIN&quot; toOperatorLoginName=&quot;OPERATOR-LOGIN-2&quot; creditType=&quot;1&quot; amount=&quot;500&quot;/&gt;,hash=1837250220), get digest:d128b20c63e44e838d8a2523e85b9baa
[2015-05-29 17:13:52,613][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Req.xml) by key(transtype.116).
[2015-05-29 17:13:52,613][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/CreditTransfer_Req.xml
[2015-05-29 17:13:52,613][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Req.xml) by key(transtype.116).
[2015-05-29 17:13:52,627][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_116_1.5.0).
[2015-05-29 17:13:52,627][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_116_).
[2015-05-29 17:13:52,627][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(-1_116_), found controller(com.mpos.lottery.te.merchant.MerchantController@720798ee) and method(public void com.mpos.lottery.te.merchant.MerchantController.transferCredit(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:52,651][Test worker][DEBUG][DefaultCreditService] Ignore credit level calculation, as the credit type of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=4, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0] is USE PARENT... check its parent merchant
[2015-05-29 17:13:52,657][Test worker][DEBUG][DefaultCreditService] The current credit level(before transaction) of Merchant [id=111, name=M-111, saleCreditLevel=100000000, payoutCreditLevel=1000, creditType=1, cashoutBalance=0, commisionBalance=0] is saleCreditLevel:100000000,payoutCreditLevel:1000
[2015-05-29 17:13:52,657][Test worker][DEBUG][DefaultCreditService] The new sale credit level of merchantMerchant [id=111, name=M-111, saleCreditLevel=99999500, payoutCreditLevel=1000, creditType=1, cashoutBalance=0, commisionBalance=0] is 99999500
[2015-05-29 17:13:52,658][Test worker][DEBUG][DefaultCreditService] Ignore credit level calculation, as the credit type of Operator [id=OPERATOR-112, loginName=OPERATOR-LOGIN-2, creditType=4, saleCreditLevel=2000, payoutCreditLevel=2000, cashoutBalance=0, commisionBalance=0] is USE PARENT... check its parent merchant
[2015-05-29 17:13:52,667][Test worker][DEBUG][DefaultCreditService] The current credit level(before transaction) of Merchant [id=112, name=M-112, saleCreditLevel=110000000, payoutCreditLevel=1000, creditType=1, cashoutBalance=0, commisionBalance=0] is saleCreditLevel:110000000,payoutCreditLevel:1000
[2015-05-29 17:13:52,667][Test worker][DEBUG][DefaultCreditService] The new sale credit level of merchantMerchant [id=112, name=M-112, saleCreditLevel=110000500, payoutCreditLevel=1000, creditType=1, cashoutBalance=0, commisionBalance=0] is 110000500
[2015-05-29 17:13:52,689][Test worker][DEBUG][CommonFacadeService] No need to publish AMQP message of transaction(TRANSFER_CREDIT)
[2015-05-29 17:13:52,689][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Res.xml) by key(transtype.4116).
[2015-05-29 17:13:52,689][Test worker][DEBUG][ProtocolSerializer] Start to serialize model(class com.mpos.lottery.te.merchant.web.CreditTransferDto),mappingFile=xml-mapping/CreditTransfer_Res.xml
[2015-05-29 17:13:52,689][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Res.xml) by key(transtype.4116).
[2015-05-29 17:13:52,690][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.merchant.web.CreditTransferDto, mappingFile=xml-mapping/CreditTransfer_Res.xml).
[2015-05-29 17:13:52,690][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832608|Timestamp:20150529171352|Transaction-Type:4116|Transaction-Id:0115052900000000002335|Response-Code:200|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Credit creditType=&quot;1&quot; amount=&quot;500&quot; creditBalanceOfFromOperator=&quot;99999500&quot; creditBalanceOfToOperator=&quot;110000500&quot;/&gt;):2fc9227e0b74dca6c630afbc8ad268b8
[2015-05-29 17:13:52,690][Test worker][DEBUG][TEPortServlet] Write response to client(host1=localhost,sizeOfPack=216) succesfully.
[2015-05-29 17:13:52,691][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=216): &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Credit creditType=&quot;1&quot; amount=&quot;500&quot; creditBalanceOfFromOperator=&quot;99999500&quot; creditBalanceOfToOperator=&quot;110000500&quot;/&gt;
[2015-05-29 17:13:52,691][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/CreditTransfer_Res.xml) by key(transtype.4116).
[2015-05-29 17:13:52,693][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:13:52,693][Test worker][DEBUG][CastorHelper] Finish marshaling input(typeclass com.mpos.lottery.te.trans.domain.Transaction, mappingFile=xml-mapping/TransactionEnquiry_Req.xml).
[2015-05-29 17:13:52,694][Test worker][DEBUG][BaseServletIntegrationTest] Do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832693|Timestamp:20150529171352|Transaction-Type:206|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Transaction terminalId=&quot;111&quot; traceMessageId=&quot;1432890832608&quot;/&gt;,hash=-164135483), get digest:e0e9d8ebc695b12895d3fca42982f59e
[2015-05-29 17:13:52,694][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Transaction-Type, value=206).
[2015-05-29 17:13:52,694][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Protocal-Version, value=1.5).
[2015-05-29 17:13:52,694][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Timestamp, value=20150529171352).
[2015-05-29 17:13:52,694][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPE-Id, value=GPE-111).
[2015-05-29 17:13:52,694][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trace-Message-Id, value=1432890832693).
[2015-05-29 17:13:52,694][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Operator-Id, value=OPERATOR-111).
[2015-05-29 17:13:52,694][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Terminal-Id, value=111).
[2015-05-29 17:13:52,694][Test worker][DEBUG][TEPortServlet] Got request header(name=X-MAC, value=e0e9d8ebc695b12895d3fca42982f59e).
[2015-05-29 17:13:52,694][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Game-Type-Id, value=-1).
[2015-05-29 17:13:52,694][Test worker][DEBUG][TEPortServlet] Got request header(name=X-Trans-BatchNumber, value=20150529).
[2015-05-29 17:13:52,694][Test worker][DEBUG][TEPortServlet] Got request header(name=X-GPS-Location, value=40.714353,-74.005973).
[2015-05-29 17:13:52,697][Test worker][DEBUG][TEPortServlet] Got request from localhost, and the message body is:pq3FqO8HCcAnaobA+xpVnADmrnwj1vrK59BGhqvtskYFWTsa2cbe6jcIE4b0pl+ogrA4SMNVUFtCb0VnctvqFZ4g+Dv1D5Fz4ERoX4gVmzFJ1yZK27DdHxAFt2qVyFGBTMAfSbhj3lw=.
[2015-05-29 17:13:52,697][Test worker][DEBUG][ProtocolSerializer] Start to deserialize request context(Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832693|Timestamp:20150529171352|Transaction-Type:206|Transaction-Id:|Response-Code:|).
[2015-05-29 17:13:52,697][Test worker][DEBUG][ProtocolSerializer] Finish decrypting cipher into original xml:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Transaction terminalId=&quot;111&quot; traceMessageId=&quot;1432890832608&quot;/&gt;
[2015-05-29 17:13:52,697][Test worker][DEBUG][ProtocolSerializer] Start to do MAC(key=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF) on (Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832693|Timestamp:20150529171352|Transaction-Type:206|Transaction-Id:|Response-Code:|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Transaction terminalId=&quot;111&quot; traceMessageId=&quot;1432890832608&quot;/&gt;,hash=-164135483), get digest:e0e9d8ebc695b12895d3fca42982f59e
[2015-05-29 17:13:52,698][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:13:52,698][Test worker][DEBUG][ProtocolSerializer] Start to deserialize model: model=null,mappingFile=xml-mapping/TransactionEnquiry_Req.xml
[2015-05-29 17:13:52,698][Test worker][DEBUG][MLotteryContext] find mapping file definition(xml-mapping/TransactionEnquiry_Req.xml) by key(transtype.206).
[2015-05-29 17:13:52,718][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_206_1.5.0).
[2015-05-29 17:13:52,718][Test worker][DEBUG][RoutineRegistry] Try to lookup handler by routine key(-1_206_).
[2015-05-29 17:13:52,718][Test worker][DEBUG][RoutineRegistry] Lookup controller by key(-1_206_), found controller(com.mpos.lottery.te.trans.TransactionController@53ddecd8) and method(public void com.mpos.lottery.te.trans.TransactionController.cancelByTrans(com.mpos.lottery.te.port.Context,com.mpos.lottery.te.port.Context) throws com.mpos.lottery.te.config.exception.ApplicationException).
[2015-05-29 17:13:52,728][Test worker][DEBUG][ReversalOrCancelStrategyFactory] Found ReversalStrategy(class com.mpos.lottery.te.merchant.service.impl.DefaultCreditService) to cancel transaction(gameType=-1,terminalId=111,transType=116,protocolVersion=1.5.0).
[2015-05-29 17:13:52,760][Test worker][DEBUG][DefaultCreditService] Ignore credit level calculation, as the credit type of Operator [id=OPERATOR-111, loginName=OPERATOR-LOGIN, creditType=4, saleCreditLevel=200000000, payoutCreditLevel=1000, cashoutBalance=0, commisionBalance=0] is USE PARENT... check its parent merchant
[2015-05-29 17:13:52,766][Test worker][DEBUG][DefaultCreditService] The current credit level(before transaction) of Merchant [id=111, name=M-111, saleCreditLevel=99999500, payoutCreditLevel=1000, creditType=1, cashoutBalance=0, commisionBalance=0] is saleCreditLevel:99999500,payoutCreditLevel:1000
[2015-05-29 17:13:52,766][Test worker][DEBUG][DefaultCreditService] The new sale credit level of merchantMerchant [id=111, name=M-111, saleCreditLevel=100000000, payoutCreditLevel=1000, creditType=1, cashoutBalance=0, commisionBalance=0] is 100000000
[2015-05-29 17:13:52,767][Test worker][DEBUG][DefaultCreditService] Ignore credit level calculation, as the credit type of Operator [id=OPERATOR-112, loginName=OPERATOR-LOGIN-2, creditType=4, saleCreditLevel=2000, payoutCreditLevel=2000, cashoutBalance=0, commisionBalance=0] is USE PARENT... check its parent merchant
[2015-05-29 17:13:52,776][Test worker][DEBUG][DefaultCreditService] The current credit level(before transaction) of Merchant [id=112, name=M-112, saleCreditLevel=110000500, payoutCreditLevel=1000, creditType=1, cashoutBalance=0, commisionBalance=0] is saleCreditLevel:110000500,payoutCreditLevel:1000
[2015-05-29 17:13:52,776][Test worker][DEBUG][DefaultCreditService] The new sale credit level of merchantMerchant [id=112, name=M-112, saleCreditLevel=110000000, payoutCreditLevel=1000, creditType=1, cashoutBalance=0, commisionBalance=0] is 110000000
[2015-05-29 17:13:52,790][Test worker][DEBUG][TransactionServiceImpl] No need to publish cancellation for target transaction(type=116,id=0115052900000000002335).
[2015-05-29 17:13:52,802][Test worker][DEBUG][ProtocolSerializer] Finish mac(macKey=P2Bbo6+bSSR9O2Qc89f3b4oHTyE1V2gF,macString=Protocal-Version:1.5|GPE_Id:GPE-111|Terminal-Id:111|Operator-Id:OPERATOR-111|Trans-BatchNumber:20150529|TractMsg-Id:1432890832693|Timestamp:20150529171352|Transaction-Type:4206|Transaction-Id:0115052900000000002337|Response-Code:200|):b7de0a6414b7da1d4b168204bdc7bcf8
[2015-05-29 17:13:52,802][Test worker][DEBUG][BaseServletIntegrationTest] Got response(code=200,length=0): 
</pre>
</span>
</div>
</div>
<div id="footer">
<p>Generated by 
<a href="http://www.gradle.org">Gradle 2.2.1</a> at 2015-5-29 17:14:48</p>
</div>
</div>
</body>
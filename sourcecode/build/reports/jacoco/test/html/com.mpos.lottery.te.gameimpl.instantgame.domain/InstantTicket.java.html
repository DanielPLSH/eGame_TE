<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>InstantTicket.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">sourcecode</a> &gt; <a href="index.html" class="el_package">com.mpos.lottery.te.gameimpl.instantgame.domain</a> &gt; <span class="el_source">InstantTicket.java</span></div><h1>InstantTicket.java</h1><pre class="source lang-java linenums">package com.mpos.lottery.te.gameimpl.instantgame.domain;

import com.mpos.lottery.te.gamespec.sale.BaseTicket;
import com.mpos.lottery.te.trans.domain.Transaction;

import org.apache.commons.lang.builder.ToStringBuilder;

import java.math.BigDecimal;
import java.util.Date;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.FetchType;
import javax.persistence.Id;
import javax.persistence.JoinColumn;
import javax.persistence.ManyToOne;
import javax.persistence.Table;
import javax.persistence.Temporal;
import javax.persistence.TemporalType;
import javax.persistence.Transient;

@Entity
@Table(name = &quot;INSTANT_TICKET&quot;)
<span class="fc" id="L24">public class InstantTicket {</span>
    public static final int STATUS_INACTIVE = 1;
    public static final int STATUS_SOLD = 2; // sold to distributor.
    public static final int STATUS_ACTIVE = 3;
    public static final int STATUS_VALIDATED = 5;
    public static final int STATUS_PROCESSING = 6;// for confirm batch validation

    public static final int PHYSICAL_STATUS_DAMAGED = -1;
    public static final int PHYSICAL_STATUS_INSTOCK = 0;
    public static final int PHYSICAL_STATUS_STOCKOUT = 1; // stock out by sales
    public static final int PHYSICAL_STATUS_RETURN = 2; // returned by sales
    public static final int PHYSICAL_STATUS_CASHOUT = 3; // cash out by sales

    @Id
    @Column(name = &quot;ID&quot;)
    private String id;

    @ManyToOne(fetch = FetchType.EAGER)
    @JoinColumn(name = &quot;IG_GAME_INSTANCE_ID&quot;, nullable = false)
    private InstantGameDraw gameDraw;

    // Due to different game instance may be assign same book number, here
    // 'GGGBBBBBB' will be
    // stored to 'BOOK_NUMBER' column
    @Column(name = &quot;BOOK_NUMBER&quot;)
    private String bookNumber;

    // The data format of serialNO should be 'GGGBBBBBBTTT,'
    @Column(name = &quot;TICKET_SERIAL&quot;)
    private String serialNo;

    @Transient
    private String rawSerialNo;

    @Column(name = &quot;TICKET_MAC&quot;)
    private String ticketMAC;

    // XOR1 and XOR2 are for EGAME
    @Column(name = &quot;TICKET_XOR1&quot;)
    private String ticketXOR1;

    @Column(name = &quot;TICKET_XOR2&quot;)
    private String ticketXOR2;

    // the 'VIRN' uploaded by client will be set to this field.
    @Column(name = &quot;TICKET_XOR3&quot;)
    private String ticketXOR3;

    @Column(name = &quot;REFERENCE_INDEX&quot;)
    private Integer prizeLevelIndex;

    @Column(name = &quot;SOLD_TIME&quot;)
    @Temporal(TemporalType.TIMESTAMP)
    private Date soldTime;

    @Column(name = &quot;IS_SOLD_TO_CUSTOMER&quot;)
    private boolean isSoldToCustomer;

    @Column(name = &quot;STATUS&quot;)
    private int status; // refer to static final STATUS_XXX

    @Column(name = &quot;IS_IN_BLACKLIST&quot;)
    private boolean isInBlacklist;

    @Column(name = &quot;IS_SUSPEND_ACTIVATION&quot;)
    private boolean suspendActivation;

    @Column(name = &quot;IS_SUSPEND_PAYOUT&quot;)
    private boolean suspendValidation;

    @Column(name = &quot;PRIZE_LEVEL&quot;, nullable = true)
    private Integer prizeLevel;

    // refer to PHYSICAL_STATUS_XXX
    @Column(name = &quot;PHYSICAL_STATUS&quot;)
    private int physicalStatus;

    // If the associated validation transaction has been settled, if true, this
    // ticket
    // can be move to history by archiving process...NOT USE currently.
    @Column(name = &quot;IS_VALIDATION_SETTLED&quot;)
    private boolean validationSettled;

    // a MD5 of XOR string, hex string
    @Column(name = &quot;XOR_MD5&quot;)
    private String xorMD5;

    @Column(name = &quot;PRIZE_AMOUNT&quot;)
    private BigDecimal prizeAmount; // before tax

    @Column(name = &quot;TAX_AMOUNT&quot;)
    private BigDecimal taxAmount;

    @Column(name = &quot;OPERATOR_ID&quot;)
    private String operatorId;

    @Column(name = &quot;DEV_ID&quot;)
    private String devId;

    @Column(name = &quot;MERCHANT_ID&quot;)
    private String merchantId;

    @Column(name = &quot;SALE_TRANSACTION_ID&quot;)
    private String saleTransId;

    @Transient
    private int inputChannel;

    // only for cliet response, the face amount of ticket.
    @Transient
    private BigDecimal totalAmount;

    @Transient
    private int errorCode;

    @Transient
    private Transaction transaction;

    public String getId() {
<span class="fc" id="L143">        return id;</span>
    }

    public void setId(String id) {
<span class="fc" id="L147">        this.id = id;</span>
<span class="fc" id="L148">    }</span>

    public String getBookNumber() {
<span class="fc" id="L151">        return bookNumber;</span>
    }

    public void setBookNumber(String packetSerialNo) {
<span class="fc" id="L155">        this.bookNumber = packetSerialNo;</span>
<span class="fc" id="L156">    }</span>

    public String getSerialNo() {
<span class="fc" id="L159">        return serialNo;</span>
    }

    public void setSerialNo(String serialNo) {
<span class="fc" id="L163">        this.serialNo = serialNo;</span>
<span class="fc" id="L164">    }</span>

    public String getTicketMAC() {
<span class="fc" id="L167">        return ticketMAC;</span>
    }

    public void setTicketMAC(String ticketMAC) {
<span class="fc" id="L171">        this.ticketMAC = ticketMAC;</span>
<span class="fc" id="L172">    }</span>

    public String getTicketXOR1() {
<span class="fc" id="L175">        return ticketXOR1;</span>
    }

    public void setTicketXOR1(String ticketXOR1) {
<span class="fc" id="L179">        this.ticketXOR1 = ticketXOR1;</span>
<span class="fc" id="L180">    }</span>

    public String getTicketXOR3() {
<span class="fc" id="L183">        return ticketXOR3;</span>
    }

    public void setTicketXOR3(String ticketXOR3) {
<span class="fc" id="L187">        this.ticketXOR3 = ticketXOR3;</span>
<span class="fc" id="L188">    }</span>

    public Integer getPrizeLevelIndex() {
<span class="fc" id="L191">        return prizeLevelIndex;</span>
    }

    public void setPrizeLevelIndex(Integer prizeLevelIndex) {
<span class="nc" id="L195">        this.prizeLevelIndex = prizeLevelIndex;</span>
<span class="nc" id="L196">    }</span>

    public Date getSoldTime() {
<span class="fc" id="L199">        return soldTime;</span>
    }

    public void setSoldTime(Date soldTime) {
<span class="fc" id="L203">        this.soldTime = soldTime;</span>
<span class="fc" id="L204">    }</span>

    public Transaction getTransaction() {
<span class="fc" id="L207">        return transaction;</span>
    }

    public void setTransaction(Transaction transaction) {
<span class="fc" id="L211">        this.transaction = transaction;</span>
<span class="fc" id="L212">    }</span>

    public InstantGameDraw getGameDraw() {
<span class="fc" id="L215">        return gameDraw;</span>
    }

    public void setGameDraw(InstantGameDraw gameDraw) {
<span class="fc" id="L219">        this.gameDraw = gameDraw;</span>
<span class="fc" id="L220">    }</span>

    public int getStatus() {
<span class="fc" id="L223">        return status;</span>
    }

    public void setStatus(int status) {
<span class="fc" id="L227">        this.status = status;</span>
<span class="fc" id="L228">    }</span>

    public boolean isInBlacklist() {
<span class="fc" id="L231">        return isInBlacklist;</span>
    }

    public void setInBlacklist(boolean isInBlacklist) {
<span class="nc" id="L235">        this.isInBlacklist = isInBlacklist;</span>
<span class="nc" id="L236">    }</span>

    public boolean isSoldToCustomer() {
<span class="nc" id="L239">        return isSoldToCustomer;</span>
    }

    public void setSoldToCustomer(boolean isSoldToCustomer) {
<span class="nc" id="L243">        this.isSoldToCustomer = isSoldToCustomer;</span>
<span class="nc" id="L244">    }</span>

    public String getTicketXOR2() {
<span class="fc" id="L247">        return ticketXOR2;</span>
    }

    public void setTicketXOR2(String ticketXOR2) {
<span class="nc" id="L251">        this.ticketXOR2 = ticketXOR2;</span>
<span class="nc" id="L252">    }</span>

    public boolean isSuspendActivation() {
<span class="nc" id="L255">        return suspendActivation;</span>
    }

    public void setSuspendActivation(boolean suspendActivation) {
<span class="nc" id="L259">        this.suspendActivation = suspendActivation;</span>
<span class="nc" id="L260">    }</span>

    public boolean isSuspendValidation() {
<span class="nc" id="L263">        return suspendValidation;</span>
    }

    public void setSuspendValidation(boolean suspendValidation) {
<span class="nc" id="L267">        this.suspendValidation = suspendValidation;</span>
<span class="nc" id="L268">    }</span>

    public Integer getPrizeLevel() {
<span class="nc" id="L271">        return prizeLevel;</span>
    }

    public void setPrizeLevel(Integer prizeLevel) {
<span class="fc" id="L275">        this.prizeLevel = prizeLevel;</span>
<span class="fc" id="L276">    }</span>

    public BigDecimal getTotalAmount() {
<span class="fc" id="L279">        return totalAmount;</span>
    }

    public void setTotalAmount(BigDecimal totalAmount) {
<span class="fc" id="L283">        this.totalAmount = totalAmount;</span>
<span class="fc" id="L284">    }</span>

    public boolean isValidationSettled() {
<span class="nc" id="L287">        return validationSettled;</span>
    }

    public void setValidationSettled(boolean validationSettled) {
<span class="nc" id="L291">        this.validationSettled = validationSettled;</span>
<span class="nc" id="L292">    }</span>

    public String getXorMD5() {
<span class="fc" id="L295">        return xorMD5;</span>
    }

    public void setXorMD5(String xorMD5) {
<span class="nc" id="L299">        this.xorMD5 = xorMD5;</span>
<span class="nc" id="L300">    }</span>

    public int getPhysicalStatus() {
<span class="fc" id="L303">        return physicalStatus;</span>
    }

    public void setPhysicalStatus(int physicalStatus) {
<span class="nc" id="L307">        this.physicalStatus = physicalStatus;</span>
<span class="nc" id="L308">    }</span>

    public BigDecimal getPrizeAmount() {
<span class="nc" id="L311">        return prizeAmount;</span>
    }

    public void setPrizeAmount(BigDecimal prizeAmount) {
<span class="fc" id="L315">        this.prizeAmount = prizeAmount;</span>
<span class="fc" id="L316">    }</span>

    public BigDecimal getTaxAmount() {
<span class="nc" id="L319">        return taxAmount;</span>
    }

    public void setTaxAmount(BigDecimal taxAmount) {
<span class="fc" id="L323">        this.taxAmount = taxAmount;</span>
<span class="fc" id="L324">    }</span>

    public int getInputChannel() {
<span class="nc" id="L327">        return inputChannel;</span>
    }

    public void setInputChannel(int inputChannel) {
<span class="nc" id="L331">        this.inputChannel = inputChannel;</span>
<span class="nc" id="L332">    }</span>

    public int getErrorCode() {
<span class="fc" id="L335">        return errorCode;</span>
    }

    public void setErrorCode(int errorCode) {
<span class="fc" id="L339">        this.errorCode = errorCode;</span>
<span class="fc" id="L340">    }</span>

    public String getOperatorId() {
<span class="fc" id="L343">        return operatorId;</span>
    }

    public void setOperatorId(String operatorId) {
<span class="fc" id="L347">        this.operatorId = operatorId;</span>
<span class="fc" id="L348">    }</span>

    public String getDevId() {
<span class="nc" id="L351">        return devId;</span>
    }

    public void setDevId(String devId) {
<span class="fc" id="L355">        this.devId = devId;</span>
<span class="fc" id="L356">    }</span>

    public String getMerchantId() {
<span class="nc" id="L359">        return merchantId;</span>
    }

    public void setMerchantId(String merchantId) {
<span class="fc" id="L363">        this.merchantId = merchantId;</span>
<span class="fc" id="L364">    }</span>

    public String getSaleTransId() {
<span class="nc" id="L367">        return saleTransId;</span>
    }

    public void setSaleTransId(String saleTransId) {
<span class="fc" id="L371">        this.saleTransId = saleTransId;</span>
<span class="fc" id="L372">    }</span>

    public String toString() {
<span class="nc" id="L375">        return ToStringBuilder.reflectionToString(this);</span>
    }

    public String getRawSerialNo() {
<span class="pc bpc" id="L379" title="1 of 2 branches missed.">        return rawSerialNo == null ? this.serialNo : this.rawSerialNo;</span>
    }

    public void setRawSerialNo(String rawSerialNo) {
<span class="fc" id="L383">        this.setRawSerialNo(true, rawSerialNo);</span>
<span class="fc" id="L384">    }</span>

    public void setRawSerialNo(boolean needToUpdateSerialNo, String rawSerialNo) {
<span class="fc" id="L387">        this.rawSerialNo = rawSerialNo;</span>
<span class="fc bfc" id="L388" title="All 2 branches covered.">        if (needToUpdateSerialNo) {</span>
<span class="fc" id="L389">            this.setSerialNo(BaseTicket.encryptSerialNo(rawSerialNo));</span>
        }
<span class="fc" id="L391">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.2.201302030002</span></div></body></html>
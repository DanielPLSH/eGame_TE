<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>SimpleToolkit.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">sourcecode</a> &gt; <a href="index.html" class="el_package">com.mpos.lottery.te.common.util</a> &gt; <span class="el_source">SimpleToolkit.java</span></div><h1>SimpleToolkit.java</h1><pre class="source lang-java linenums">package com.mpos.lottery.te.common.util;

import com.mpos.lottery.te.config.MLotteryContext;
import com.mpos.lottery.te.config.exception.SystemException;

import org.springframework.util.Assert;

import java.math.BigDecimal;
import java.security.MessageDigest;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Calendar;
import java.util.Date;
import java.util.List;
import java.util.Random;
import java.util.UUID;

<span class="pc bpc" id="L19" title="1 of 2 branches missed.">public class SimpleToolkit {</span>

    /**
     * Get the root cause of a exception.
     */
    public static Throwable getRootCause(Throwable throwable) {
<span class="nc" id="L25">        Throwable cause = throwable.getCause();</span>
<span class="nc bnc" id="L26" title="All 2 branches missed.">        if (cause == null) {</span>
<span class="nc" id="L27">            return throwable;</span>
        } else {
<span class="nc" id="L29">            return getRootCause(cause);</span>
        }
    }

    /**
     * Check whether a int array contain duplicated values.
     */
    public static boolean containRepeatedly(int[] intarray) {
<span class="fc bfc" id="L37" title="All 2 branches covered.">        for (int i = 0; i &lt; intarray.length; i++) {</span>
<span class="fc bfc" id="L38" title="All 2 branches covered.">            for (int j = i + 1; j &lt; intarray.length; j++) {</span>
<span class="pc bpc" id="L39" title="1 of 2 branches missed.">                if (intarray[i] == intarray[j]) {</span>
<span class="nc" id="L40">                    return true;</span>
                }
            }
        }
<span class="fc" id="L44">        return false;</span>
    }

    /**
     * Whether the 2 time are in same day.
     */
    public static boolean isSameDay(Date beginTime, Date endTime) {
<span class="nc" id="L51">        Assert.notNull(beginTime);</span>
<span class="nc" id="L52">        Assert.notNull(endTime);</span>
<span class="nc bnc" id="L53" title="All 2 branches missed.">        if (formatDate(beginTime).equalsIgnoreCase(formatDate(endTime))) {</span>
<span class="nc" id="L54">            return true;</span>
        }
<span class="nc" id="L56">        return false;</span>
    }

    /**
     * If a selected number is started with '0', remove it. For example if selected number is '01,20,10,09', will be
     * formatted to '1,20,10,9'.
     */
    public static String formatNumericString(String input, String delimeter) {
<span class="fc" id="L64">        int[] intArray = string2IntArray(input, delimeter, false);</span>
<span class="fc" id="L65">        StringBuffer formattedSelectedNumber = new StringBuffer(&quot;&quot;);</span>
<span class="fc bfc" id="L66" title="All 2 branches covered.">        for (int i = 0; i &lt; intArray.length; i++) {</span>
<span class="fc bfc" id="L67" title="All 2 branches covered.">            if (i != 0) {</span>
<span class="fc" id="L68">                formattedSelectedNumber.append(delimeter);</span>
            }
<span class="fc" id="L70">            formattedSelectedNumber.append(intArray[i]);</span>
        }
<span class="fc" id="L72">        return formattedSelectedNumber.toString();</span>
    }

    /**
     * Convert a number string into number array. for example, convert a string '09,02,23,19' into [2,9,19,23] if needs
     * to sorting, otherwise [9,2,23,19]
     */
    public static int[] string2IntArray(String numberPart, String numberDelemeter, boolean sortArray) {
<span class="pc bpc" id="L80" title="1 of 2 branches missed.">        if (numberPart == null) {</span>
<span class="nc" id="L81">            return null;</span>
        }
<span class="fc" id="L83">        String[] strNumbers = numberPart.split(numberDelemeter);</span>
<span class="fc" id="L84">        int[] numbers = new int[strNumbers.length];</span>
<span class="fc bfc" id="L85" title="All 2 branches covered.">        for (int i = 0; i &lt; numbers.length; i++) {</span>
<span class="fc" id="L86">            numbers[i] = Integer.parseInt(strNumbers[i]);</span>
        }
<span class="fc bfc" id="L88" title="All 2 branches covered.">        if (sortArray) {</span>
            // Sorts the specified array of integers into ascending numerical
            // order.
<span class="fc" id="L91">            Arrays.sort(numbers);</span>
        }
<span class="fc" id="L93">        return numbers;</span>
    }

    /**
     * Math divide.
     */
    public static BigDecimal mathDivide(BigDecimal denominator, BigDecimal numerator) {
<span class="pc bpc" id="L100" title="2 of 4 branches missed.">        if (denominator == null || numerator == null) {</span>
<span class="nc" id="L101">            throw new IllegalArgumentException(&quot;niether denominator nor numerator can be null&quot;);</span>
        }
<span class="fc" id="L103">        return denominator.divide(numerator, 2, BigDecimal.ROUND_HALF_UP);</span>
    }

    public static BigDecimal mathDivide(BigDecimal denominator, BigDecimal numerator, int precision) {
<span class="nc bnc" id="L107" title="All 4 branches missed.">        if (denominator == null || numerator == null) {</span>
<span class="nc" id="L108">            throw new IllegalArgumentException(&quot;niether denominator nor numerator can be null&quot;);</span>
        }
<span class="nc" id="L110">        return denominator.divide(numerator, precision, BigDecimal.ROUND_HALF_UP);</span>
    }

    /**
     * Math multiple.
     */
    public static BigDecimal mathMultiple(BigDecimal m1, BigDecimal m2) {
<span class="pc bpc" id="L117" title="2 of 4 branches missed.">        if (m1 == null || m2 == null) {</span>
<span class="nc" id="L118">            throw new IllegalArgumentException(&quot;niether denominator nor numerator can be null&quot;);</span>
        }
<span class="fc" id="L120">        BigDecimal value = m1.multiply(m2);</span>
<span class="fc" id="L121">        return value.setScale(2, BigDecimal.ROUND_HALF_UP);</span>
    }

    public static BigDecimal mathMultiple(BigDecimal m1, BigDecimal m2, int percision) {
<span class="pc bpc" id="L125" title="2 of 4 branches missed.">        if (m1 == null || m2 == null) {</span>
<span class="nc" id="L126">            throw new IllegalArgumentException(&quot;niether denominator nor numerator can be null&quot;);</span>
        }
<span class="fc" id="L128">        BigDecimal value = m1.multiply(m2);</span>
<span class="fc" id="L129">        return value.setScale(percision, BigDecimal.ROUND_HALF_UP);</span>
    }

    /**
     * For example, the input is '12', padding char is '0' and expected length is 10, then the output will be
     * '0000000012'.
     */
    public static String fillLeft(int expectedLength, char paddingChar, String src) {
<span class="fc" id="L137">        StringBuffer buffer = new StringBuffer();</span>
<span class="fc bfc" id="L138" title="All 2 branches covered.">        for (int i = 0; i &lt; expectedLength; i++) {</span>
<span class="fc" id="L139">            buffer.append(paddingChar);</span>
        }
<span class="fc" id="L141">        return buffer.append(src).toString().substring(src.length());</span>
    }

    /**
     * calcualte the date which is &lt;code&gt;days&lt;/code&gt; past since &lt;code&gt;startDay&lt;/code&gt;.
     */
    public static Date dayAfter(Date startDay, int days) {
<span class="fc" id="L148">        Calendar cal = Calendar.getInstance();</span>
<span class="fc" id="L149">        cal.setTime(startDay);</span>
<span class="fc" id="L150">        cal.add(Calendar.DAY_OF_YEAR, days);</span>
<span class="fc" id="L151">        return cal.getTime();</span>
    }

    public static String formatDate(Date date) {
<span class="fc" id="L155">        return formatDate(date, &quot;yyyyMMddHHmmss&quot;);</span>
    }

    /**
     * Format a date by given date format.
     */
    public static String formatDate(Date date, String pattern) {
<span class="pc bpc" id="L162" title="2 of 4 branches missed.">        assert date != null : &quot;Argument 'date' can NOT be null.&quot;;</span>
<span class="pc bpc" id="L163" title="2 of 4 branches missed.">        assert pattern != null : &quot;Argument 'pattern' can NOT be null.&quot;;</span>
<span class="fc" id="L164">        SimpleDateFormat sdf = new SimpleDateFormat(pattern);</span>
<span class="fc" id="L165">        return sdf.format(date);</span>
    }

    /**
     * Build a date instance from given date string.
     */
    public static Date parseDate(String input, String pattern) {
<span class="pc bpc" id="L172" title="2 of 4 branches missed.">        assert input != null : &quot;Argument 'input' can NOT be null.&quot;;</span>
<span class="pc bpc" id="L173" title="2 of 4 branches missed.">        assert pattern != null : &quot;Argument 'pattern' can NOT be null.&quot;;</span>
<span class="fc" id="L174">        SimpleDateFormat sdf = new SimpleDateFormat(pattern);</span>
        try {
<span class="fc" id="L176">            return sdf.parse(input);</span>
<span class="nc" id="L177">        } catch (Exception e) {</span>
<span class="nc" id="L178">            throw new IllegalArgumentException(e);</span>
        }
    }

    /**
     * Get random 32 uuid string, all '-' will be removed.
     */
    public static String simpleUUID() {
<span class="fc" id="L186">        UUID uuid = UUID.randomUUID();</span>
<span class="fc" id="L187">        return uuid.toString().replace(&quot;-&quot;, &quot;&quot;);</span>
    }

    /**
     * Generate MD5 digest.
     */
    public static String md5(String input) {
        try {
<span class="fc" id="L195">            MessageDigest md5 = MessageDigest.getInstance(&quot;MD5&quot;);</span>
<span class="fc" id="L196">            String encoding = MLotteryContext.getInstance().getDefaultEncoding();</span>
<span class="fc" id="L197">            byte[] outputs = md5.digest(input.getBytes(encoding));</span>
<span class="fc" id="L198">            return HexCoder.bufferToHex(outputs);</span>
<span class="nc" id="L199">        } catch (Exception e) {</span>
<span class="nc" id="L200">            throw new SystemException(e);</span>
        }
    }

    /**
     * calculate the time between twoe dates.
     * 
     * @return millseconds.
     */
    public static long compare(Date d1, Date d2) {
<span class="fc" id="L210">        return d1.getTime() - d2.getTime();</span>
    }

    /**
     * Translate a string into long list.
     * 
     * @param input
     *            A string composed of digital and delimiter, for example '2,12,23'.
     * @param delimiter
     *            The delimiter which used to separate digits.
     */
    public static List&lt;Long&gt; splitToLong(String input, String delimiter) {
<span class="fc" id="L222">        String[] slices = input.split(delimiter);</span>
<span class="fc" id="L223">        List result = new ArrayList();</span>
<span class="fc bfc" id="L224" title="All 2 branches covered.">        for (int i = 0; i &lt; slices.length; i++) {</span>
<span class="fc bfc" id="L225" title="All 2 branches covered.">            if (!&quot;&quot;.equals(slices[i])) {</span>
<span class="fc" id="L226">                result.add(Long.parseLong(slices[i]));</span>
            }
        }
<span class="fc" id="L229">        return result;</span>
    }

    /**
     * Try {@link org.apache.commons.lang.StringUtils#split(String, char)}
     */
    public static List&lt;String&gt; split(String source, String delim) {
<span class="nc" id="L236">        List&lt;String&gt; segList = new ArrayList&lt;String&gt;();</span>
<span class="nc" id="L237">        int start = 0;</span>
<span class="nc" id="L238">        int delimIdx = source.indexOf(delim);</span>
<span class="nc bnc" id="L239" title="All 2 branches missed.">        while (delimIdx != -1) {</span>
<span class="nc" id="L240">            segList.add(source.substring(start, delimIdx));</span>
<span class="nc" id="L241">            start = delimIdx + delim.length();</span>
<span class="nc" id="L242">            delimIdx = source.indexOf(delim, start);</span>
        }
<span class="nc" id="L244">        segList.add(source.substring(start, source.length()));</span>
<span class="nc" id="L245">        return segList;</span>
    }

    public static int generatePin(int min, int max) {
<span class="fc" id="L249">        Random generator = new Random();</span>
<span class="fc" id="L250">        return (max - min - 1) + generator.nextInt(min);</span>
    }

    /**
     * Generate a 32-length uuid based on UUID.
     */
    public static String uuid() {
<span class="nc" id="L257">        String uuid = UUID.randomUUID().toString();</span>
<span class="nc" id="L258">        return uuid.replace(&quot;-&quot;, &quot;&quot;);</span>
    }

    /**
     * Join a array into string.
     */
    public static String join(List&lt;?&gt; list, String join) {
<span class="fc" id="L265">        StringBuffer buffer = new StringBuffer();</span>
<span class="fc bfc" id="L266" title="All 2 branches covered.">        for (int i = 0; i &lt; list.size(); i++) {</span>
<span class="fc" id="L267">            buffer.append(list.get(i));</span>
<span class="fc bfc" id="L268" title="All 2 branches covered.">            if (i != (list.size() - 1)) {</span>
<span class="fc" id="L269">                buffer.append(join);</span>
            }
        }
<span class="fc" id="L272">        return buffer.toString();</span>
    }

    /**
     * Join the numbers by supplied joining char.
     * 
     * @param numbers
     *            The source numbers.
     * @param indexOfBegin
     *            The index on begin element, it starts with 0.
     * @param count
     *            How many elements will be joined.
     * @param joinChar
     *            The joining char.
     * @return a string generated from supplied numbers, such as '2,4,3'
     */
    public static String join(int[] numbers, int indexOfBegin, int count, String joinChar) {
<span class="pc bpc" id="L289" title="1 of 2 branches missed.">        Assert.state(indexOfBegin &gt;= 0, &quot;index of being can't be less than 0&quot;);</span>
<span class="pc bpc" id="L290" title="1 of 2 branches missed.">        Assert.state(count &gt; 0, &quot;count must be greater than 0&quot;);</span>
<span class="pc bpc" id="L291" title="1 of 2 branches missed.">        if (numbers.length - indexOfBegin &lt; count) {</span>
<span class="nc" id="L292">            throw new IndexOutOfBoundsException(&quot;indexOfBegin:&quot; + indexOfBegin + &quot;,sizeOfArray:&quot; + numbers.length</span>
                    + &quot;, required count:&quot; + count);
        }
<span class="fc" id="L295">        int indexOfCount = 0;</span>
<span class="fc" id="L296">        StringBuffer buffer = new StringBuffer(&quot;&quot;);</span>
<span class="pc bpc" id="L297" title="1 of 2 branches missed.">        for (int i = indexOfBegin; i &lt; numbers.length; i++) {</span>
<span class="fc" id="L298">            buffer.append(numbers[i]);</span>
<span class="fc bfc" id="L299" title="All 2 branches covered.">            if (indexOfCount &lt; count - 1) {</span>
<span class="fc" id="L300">                buffer.append(joinChar);</span>
            }
<span class="fc bfc" id="L302" title="All 2 branches covered.">            if (indexOfCount == count - 1) {</span>
<span class="fc" id="L303">                break;</span>
            }
<span class="fc" id="L305">            indexOfCount++;</span>
        }
<span class="fc" id="L307">        return buffer.toString();</span>
    }

    // test
    public static void main(String[] args) {
<span class="nc" id="L312">        System.out.println(0 - 32.03);</span>
<span class="nc" id="L313">        System.out.println(new BigDecimal(String.valueOf((0 - 32.03))));</span>
<span class="nc" id="L314">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.2.201302030002</span></div></body></html>
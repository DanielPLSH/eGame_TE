<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>PrizeDto.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">sourcecode</a> &gt; <a href="index.html" class="el_package">com.mpos.lottery.te.gamespec.prize.web</a> &gt; <span class="el_source">PrizeDto.java</span></div><h1>PrizeDto.java</h1><pre class="source lang-java linenums">package com.mpos.lottery.te.gamespec.prize.web;

import com.mpos.lottery.te.gamespec.game.BaseOperationParameter;
import com.mpos.lottery.te.gamespec.game.Game;
import com.mpos.lottery.te.gamespec.sale.BaseTicket;

import java.math.BigDecimal;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.LinkedList;
import java.util.List;

public class PrizeDto implements java.io.Serializable {
    private static final long serialVersionUID = -5323741083713431721L;
    /**
     * If payout mode is refund, the sum of future game instances should be returned to customer.
     */
<span class="fc" id="L18">    private BigDecimal returnAmount = new BigDecimal(&quot;0&quot;);</span>
    /**
     * The prize amount(before tax).
     */
<span class="fc" id="L22">    private BigDecimal prizeAmount = new BigDecimal(&quot;0&quot;);</span>
    /**
     * The tax amount of prize.
     */
<span class="fc" id="L26">    private BigDecimal taxAmount = new BigDecimal(&quot;0&quot;);</span>
    /**
     * actualAmount := prizeAmount + returnAmount - taxAmount
     */
<span class="fc" id="L30">    private BigDecimal actualAmount = new BigDecimal(&quot;0&quot;);</span>
    // lucky prize amount
<span class="fc" id="L32">    private BigDecimal luckyPrizeAmount = new BigDecimal(&quot;0&quot;);</span>
    /**
     * Refer to {@link com.mpos.lottery.te.gamespec.game.BaseOperationParameter#PAYOUTMODE_REFUND}
     */
<span class="fc" id="L36">    private int payoutMode = BaseOperationParameter.PAYOUTMODE_PRINTNEWTICKET;</span>
    /**
     * The newly generated tickets which will be persisted to database and used to generate new-print-ticket.
     */
<span class="fc" id="L40">    private List&lt;BaseTicket&gt; generatedTickets = new LinkedList&lt;BaseTicket&gt;();</span>
    /**
     * For a multple-draw ticket, for example 3 draws, and the 1st game instance is payout started, 2nd is active , 3rd
     * is new...here ticket associates with 1st game instance will be categorized into 'paidTickets', while tickets
     * associate with 2nd and 3rd game instance will be categorized into futureTickes, for system may generate new
     * tickets for them('generatedTickets).
     */
<span class="fc" id="L47">    private List&lt;BaseTicket&gt; paidTickets = new LinkedList&lt;BaseTicket&gt;();</span>
<span class="fc" id="L48">    private List&lt;BaseTicket&gt; futureTickets = new LinkedList&lt;BaseTicket&gt;();</span>

    /**
     * The physical ticket which represents the client's request.
     */
    private BaseTicket winningTicket;

    /**
     * The physical ticket which represents the new printed physical ticket.
     */
    private BaseTicket newPrintTicket;
    /**
     * Only one PrizeItemDto associate with a single game instance.
     */
<span class="fc" id="L62">    private List&lt;PrizeItemDto&gt; prizeItems = new LinkedList&lt;PrizeItemDto&gt;();</span>
    /**
     * The game information of winning ticket.
     */
    private Game game;
    // whether need to verify payout PIN
    private boolean verifyPIN;

<span class="fc" id="L70">    public PrizeDto() {</span>
<span class="fc" id="L71">    }</span>

    /**
     * Look {@code PrizeItem} by key of game instance. .
     * 
     * @param keyOfGameInstance
     *            THe key of game instance is generated from 'GameId+drawNo'
     * @return a PrizeItem with given game instance key.
     */
    public PrizeItemDto lookupPrizeItem(String keyOfGameInstance) {
<span class="fc bfc" id="L81" title="All 2 branches covered.">        for (PrizeItemDto prizeItem : this.prizeItems) {</span>
<span class="fc bfc" id="L82" title="All 2 branches covered.">            if (keyOfGameInstance.equals(prizeItem.getGameInstance().getKey())) {</span>
<span class="fc" id="L83">                return prizeItem;</span>
            }
<span class="fc" id="L85">        }</span>
<span class="fc" id="L86">        return null;</span>
    }

    public Integer[] getWinnedPrizeLevels() {
<span class="nc" id="L90">        List&lt;Integer&gt; uniquePrizeLevels = new ArrayList&lt;Integer&gt;();</span>
<span class="nc bnc" id="L91" title="All 2 branches missed.">        for (PrizeItemDto prizeItem : this.getPrizeItems()) {</span>
<span class="nc bnc" id="L92" title="All 2 branches missed.">            for (PrizeLevelItemDto w : prizeItem.getPrizeLevelItems()) {</span>
<span class="nc" id="L93">                Integer prizeLevel = Integer.parseInt(w.getPrizeLevel());</span>
<span class="nc bnc" id="L94" title="All 2 branches missed.">                if (!uniquePrizeLevels.contains(prizeLevel)) {</span>
<span class="nc" id="L95">                    uniquePrizeLevels.add(prizeLevel);</span>
                }
<span class="nc" id="L97">            }</span>
<span class="nc" id="L98">        }</span>
<span class="nc" id="L99">        Integer[] i = new Integer[uniquePrizeLevels.size()];</span>
<span class="nc" id="L100">        uniquePrizeLevels.toArray(i);</span>
<span class="nc" id="L101">        return i;</span>
    }

    public void addPrizeItem(PrizeItemDto prizeItem) {
<span class="fc" id="L105">        this.prizeItems.add(prizeItem);</span>
<span class="fc" id="L106">    }</span>

    public Iterator&lt;PrizeItemDto&gt; iterator() {
<span class="nc" id="L109">        return this.prizeItems.iterator();</span>
    }

    public BigDecimal getReturnAmount() {
<span class="fc" id="L113">        return returnAmount;</span>
    }

    public void setReturnAmount(BigDecimal returnAmount) {
<span class="fc" id="L117">        this.returnAmount = returnAmount;</span>
<span class="fc" id="L118">    }</span>

    public BigDecimal getPrizeAmount() {
<span class="fc" id="L121">        return prizeAmount;</span>
    }

    public void setPrizeAmount(BigDecimal prizeAmount) {
<span class="fc" id="L125">        this.prizeAmount = prizeAmount;</span>
<span class="fc" id="L126">    }</span>

    public BigDecimal getTaxAmount() {
<span class="fc" id="L129">        return taxAmount;</span>
    }

    public void setTaxAmount(BigDecimal taxAmount) {
<span class="fc" id="L133">        this.taxAmount = taxAmount;</span>
<span class="fc" id="L134">    }</span>

    public BigDecimal getActualAmount() {
<span class="fc" id="L137">        return actualAmount;</span>
    }

    public void setActualAmount(BigDecimal actualAmount) {
<span class="fc" id="L141">        this.actualAmount = actualAmount;</span>
<span class="fc" id="L142">    }</span>

    public int getPayoutMode() {
<span class="fc" id="L145">        return payoutMode;</span>
    }

    public void setPayoutMode(int payoutMode) {
<span class="fc" id="L149">        this.payoutMode = payoutMode;</span>
<span class="fc" id="L150">    }</span>

    public List&lt;BaseTicket&gt; getGeneratedTickets() {
<span class="fc" id="L153">        return generatedTickets;</span>
    }

    public void setGeneratedTickets(List&lt;BaseTicket&gt; generatedTickets) {
<span class="nc" id="L157">        this.generatedTickets = generatedTickets;</span>
<span class="nc" id="L158">    }</span>

    public BaseTicket getWinningTicket() {
<span class="fc" id="L161">        return winningTicket;</span>
    }

    public void setWinningTicket(BaseTicket winningTicket) {
<span class="fc" id="L165">        this.winningTicket = winningTicket;</span>
<span class="fc" id="L166">    }</span>

    public List&lt;BaseTicket&gt; getPaidTickets() {
<span class="fc" id="L169">        return paidTickets;</span>
    }

    public void setPaidTickets(List&lt;BaseTicket&gt; paidTickets) {
<span class="nc" id="L173">        this.paidTickets = paidTickets;</span>
<span class="nc" id="L174">    }</span>

    public List&lt;BaseTicket&gt; getFutureTickets() {
<span class="fc" id="L177">        return futureTickets;</span>
    }

    public void setFutureTickets(List&lt;BaseTicket&gt; futureTickets) {
<span class="nc" id="L181">        this.futureTickets = futureTickets;</span>
<span class="nc" id="L182">    }</span>

    public Game getGame() {
<span class="nc" id="L185">        return game;</span>
    }

    public void setGame(Game game) {
<span class="nc" id="L189">        this.game = game;</span>
<span class="nc" id="L190">    }</span>

    public boolean isVerifyPIN() {
<span class="fc" id="L193">        return verifyPIN;</span>
    }

    public void setVerifyPIN(boolean verifyPin) {
<span class="fc" id="L197">        this.verifyPIN = verifyPin;</span>
<span class="fc" id="L198">    }</span>

    public List&lt;PrizeItemDto&gt; getPrizeItems() {
<span class="fc" id="L201">        return prizeItems;</span>
    }

    public void setPrizeItems(List&lt;PrizeItemDto&gt; prizeItems) {
<span class="nc" id="L205">        this.prizeItems = prizeItems;</span>
<span class="nc" id="L206">    }</span>

    public BigDecimal getLuckyPrizeAmount() {
<span class="fc" id="L209">        return luckyPrizeAmount;</span>
    }

    public void setLuckyPrizeAmount(BigDecimal luckyPrizeAmount) {
<span class="fc" id="L213">        this.luckyPrizeAmount = luckyPrizeAmount;</span>
<span class="fc" id="L214">    }</span>

    public BaseTicket getNewPrintTicket() {
<span class="fc" id="L217">        return newPrintTicket;</span>
    }

    public void setNewPrintTicket(BaseTicket newPrintTicket) {
<span class="fc" id="L221">        this.newPrintTicket = newPrintTicket;</span>
<span class="fc" id="L222">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.2.201302030002</span></div></body></html>